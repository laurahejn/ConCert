<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<link href="toc.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
      <span id="toggle-toc">Contents</span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="https://github.com/AU-COBRA/ConCert" target="_balnk">Project Page</a>
      <a href="index.html">Index</a>
      <a href="toc.html">Table of contents</a>
    </span>
</div>
  <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="js-toc" class="toc" data-toc="h1,h2,h3,h4" data-toc-container="doc" data-toc-offset="-40">
      <div id="js-toc-header" class="toc-header">Contents:</div>
    </div>
    <div id="main">
<h1 class="libtitle">Library ConCert.Examples.FA1_2.FA1_2</h1>

<div class="code">
</div>

<div class="doc">
<a id="lab43"></a><h1 class="section">FA1.2 token contract</h1>
 A basic FA1.2 implementation inspired by the Dexter2 liquidity token FA1.2
    token implementation but with minting and burning removed. 
</div>
<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Utils.Extras.html#"><span class="id" title="library">Extras</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Utils.RecordUpdate.html#"><span class="id" title="library">RecordUpdate</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Blockchain.html#"><span class="id" title="library">Blockchain</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Containers.html#"><span class="id" title="library">Containers</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Monad.html#"><span class="id" title="library">Monad</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.ResultMonad.html#"><span class="id" title="library">ResultMonad</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Serializable.html#"><span class="id" title="library">Serializable</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.ContractCommon.html#"><span class="id" title="library">ContractCommon</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.ZArith_base.html#"><span class="id" title="library">ZArith_base</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#"><span class="id" title="library">List</span></a>. <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ListNotations"><span class="id" title="module">ListNotations</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="non_zero_amount" class="idref" href="#non_zero_amount"><span class="id" title="definition">non_zero_amount</span></a> (<a id="amt:1" class="idref" href="#amt:1"><span class="id" title="binder">amt</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> := (0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#f1746f02f141d025b1e53605943919bf"><span class="id" title="notation">&lt;?</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#amt:1"><span class="id" title="variable">amt</span></a>)%<span class="id" title="var">Z</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab44"></a><h1 class="section">Contract types</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <a id="FA12Types" class="idref" href="#FA12Types"><span class="id" title="section">FA12Types</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<a id="BaseTypes:2" class="idref" href="#BaseTypes:2"><span class="id" title="binder">BaseTypes</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainBase"><span class="id" title="class">ChainBase</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">N_scope</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Set</span> <span class="id" title="var">Nonrecursive</span> <span class="id" title="var">Elimination</span> <span class="id" title="var">Schemes</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Dummy&nbsp;implementation&nbsp;of&nbsp;callbacks.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <a id="callback" class="idref" href="#callback"><span class="id" title="record">callback</span></a> := {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="return_addr" class="idref" href="#return_addr"><span class="id" title="projection">return_addr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="callback_addr" class="idref" href="#callback_addr"><span class="id" title="definition">callback_addr</span></a> (<a id="c:5" class="idref" href="#c:5"><span class="id" title="binder">c</span></a> : <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#callback"><span class="id" title="record">callback</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#c:5"><span class="id" title="variable">c</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#return_addr"><span class="id" title="projection">return_addr</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Coercion</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#callback_addr"><span class="id" title="definition">callback_addr</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#callback_addr"><span class="id" title="definition">:</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#callback_addr"><span class="id" title="definition">callback</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#callback_addr"><span class="id" title="definition">&gt;-&gt;</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#callback_addr"><span class="id" title="definition">Address</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <a id="transfer_param" class="idref" href="#transfer_param"><span class="id" title="record">transfer_param</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">build_transfer_param</span> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="from" class="idref" href="#from"><span class="id" title="projection">from</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="to" class="idref" href="#to"><span class="id" title="projection">to</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="value" class="idref" href="#value"><span class="id" title="projection">value</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a><br/>
&nbsp;&nbsp;}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <a id="approve_param" class="idref" href="#approve_param"><span class="id" title="record">approve_param</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">build_approve_param</span> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="spender" class="idref" href="#spender"><span class="id" title="projection">spender</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="value_" class="idref" href="#value_"><span class="id" title="projection">value_</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a><br/>
&nbsp;&nbsp;}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <a id="getAllowance_param" class="idref" href="#getAllowance_param"><span class="id" title="record">getAllowance_param</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">build_getAllowance_param</span> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="request" class="idref" href="#request"><span class="id" title="projection">request</span></a> : (<a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="allowance_callback" class="idref" href="#allowance_callback"><span class="id" title="projection">allowance_callback</span></a> : <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#callback"><span class="id" title="record">callback</span></a><br/>
&nbsp;&nbsp;}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <a id="getBalance_param" class="idref" href="#getBalance_param"><span class="id" title="record">getBalance_param</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">build_getBalance_param</span> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="owner_" class="idref" href="#owner_"><span class="id" title="projection">owner_</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="balance_callback" class="idref" href="#balance_callback"><span class="id" title="projection">balance_callback</span></a> : <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#callback"><span class="id" title="record">callback</span></a><br/>
&nbsp;&nbsp;}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <a id="getTotalSupply_param" class="idref" href="#getTotalSupply_param"><span class="id" title="record">getTotalSupply_param</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">build_getTotalSupply_param</span> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="request_" class="idref" href="#request_"><span class="id" title="projection">request_</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#unit"><span class="id" title="inductive">unit</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="supply_callback" class="idref" href="#supply_callback"><span class="id" title="projection">supply_callback</span></a> : <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#callback"><span class="id" title="record">callback</span></a><br/>
&nbsp;&nbsp;}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <a id="State" class="idref" href="#State"><span class="id" title="record">State</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">build_state</span> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="tokens" class="idref" href="#tokens"><span class="id" title="projection">tokens</span></a> : <a class="idref" href="ConCert.Execution.Containers.html#FMap"><span class="id" title="abbreviation">FMap</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="allowances" class="idref" href="#allowances"><span class="id" title="projection">allowances</span></a> : <a class="idref" href="ConCert.Execution.Containers.html#FMap"><span class="id" title="abbreviation">FMap</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="total_supply" class="idref" href="#total_supply"><span class="id" title="projection">total_supply</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a><br/>
&nbsp;&nbsp;}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <a id="Setup" class="idref" href="#Setup"><span class="id" title="record">Setup</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">build_setup</span> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="lqt_provider" class="idref" href="#lqt_provider"><span class="id" title="projection">lqt_provider</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="initial_pool" class="idref" href="#initial_pool"><span class="id" title="projection">initial_pool</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a><br/>
&nbsp;&nbsp;}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="Error" class="idref" href="#Error"><span class="id" title="definition">Error</span></a> : <span class="id" title="keyword">Type</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="default_error" class="idref" href="#default_error"><span class="id" title="definition">default_error</span></a> : <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#Error"><span class="id" title="definition">Error</span></a> := 1%<span class="id" title="var">nat</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Any&nbsp;contract&nbsp;that&nbsp;wants&nbsp;to&nbsp;receive&nbsp;callback&nbsp;messages&nbsp;from&nbsp;the&nbsp;FA1.2&nbsp;liquidity&nbsp;contract<br/>
&nbsp;&nbsp;&nbsp;&nbsp;should&nbsp;have&nbsp;this&nbsp;type&nbsp;as&nbsp;its&nbsp;Msg&nbsp;type.&nbsp;The&nbsp;contract&nbsp;may&nbsp;have&nbsp;other&nbsp;endpoints,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;as&nbsp;composed&nbsp;in&nbsp;the&nbsp;'other_msg'&nbsp;constructor.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Inductive</span> <a id="FA12ReceiverMsg" class="idref" href="#FA12ReceiverMsg"><span class="id" title="inductive">FA12ReceiverMsg</span></a> {<a id="Msg':29" class="idref" href="#Msg':29"><span class="id" title="binder">Msg'</span></a> : <span class="id" title="keyword">Type</span>} :=<br/>
&nbsp;&nbsp;| <a id="receive_allowance" class="idref" href="#receive_allowance"><span class="id" title="constructor">receive_allowance</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12ReceiverMsg:30"><span class="id" title="inductive">FA12ReceiverMsg</span></a><br/>
&nbsp;&nbsp;| <a id="receive_balance_of" class="idref" href="#receive_balance_of"><span class="id" title="constructor">receive_balance_of</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12ReceiverMsg:30"><span class="id" title="inductive">FA12ReceiverMsg</span></a><br/>
&nbsp;&nbsp;| <a id="receive_total_supply" class="idref" href="#receive_total_supply"><span class="id" title="constructor">receive_total_supply</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12ReceiverMsg:30"><span class="id" title="inductive">FA12ReceiverMsg</span></a><br/>
&nbsp;&nbsp;| <a id="other_msg" class="idref" href="#other_msg"><span class="id" title="constructor">other_msg</span></a> : <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#Msg':29"><span class="id" title="variable">Msg'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12ReceiverMsg:30"><span class="id" title="inductive">FA12ReceiverMsg</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FA1.2&nbsp;Endpoints.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Inductive</span> <a id="Msg" class="idref" href="#Msg"><span class="id" title="inductive">Msg</span></a> :=<br/>
&nbsp;&nbsp;| <a id="transfer" class="idref" href="#transfer"><span class="id" title="constructor">transfer</span></a> : <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#transfer_param"><span class="id" title="record">transfer_param</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#Msg:32"><span class="id" title="inductive">Msg</span></a><br/>
&nbsp;&nbsp;| <a id="approve" class="idref" href="#approve"><span class="id" title="constructor">approve</span></a> : <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#approve_param"><span class="id" title="record">approve_param</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#Msg:32"><span class="id" title="inductive">Msg</span></a><br/>
&nbsp;&nbsp;| <a id="getAllowance" class="idref" href="#getAllowance"><span class="id" title="constructor">getAllowance</span></a> : <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#getAllowance_param"><span class="id" title="record">getAllowance_param</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#Msg:32"><span class="id" title="inductive">Msg</span></a><br/>
&nbsp;&nbsp;| <a id="getBalance" class="idref" href="#getBalance"><span class="id" title="constructor">getBalance</span></a> : <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#getBalance_param"><span class="id" title="record">getBalance_param</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#Msg:32"><span class="id" title="inductive">Msg</span></a><br/>
&nbsp;&nbsp;| <a id="getTotalSupply" class="idref" href="#getTotalSupply"><span class="id" title="constructor">getTotalSupply</span></a> : <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#getTotalSupply_param"><span class="id" title="record">getTotalSupply_param</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#Msg:32"><span class="id" title="inductive">Msg</span></a>.<br/>

<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Types"><span class="id" title="section">FA12Types</span></a>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="keyword">Type</span> <a id="FA12Serializable" class="idref" href="#FA12Serializable"><span class="id" title="module">FA12Serializable</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Section</span> <a id="FA12Serializable.FA12Serializable" class="idref" href="#FA12Serializable.FA12Serializable"><span class="id" title="section">FA12Serializable</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:34" class="idref" href="#H:34"><span class="id" title="binder">ChainBase</span></a>}.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a id="FA12Serializable.callback_serializable" class="idref" href="#FA12Serializable.callback_serializable"><span class="id" title="axiom">callback_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#callback"><span class="id" title="record">callback</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a id="FA12Serializable.transfer_param_serializable" class="idref" href="#FA12Serializable.transfer_param_serializable"><span class="id" title="axiom">transfer_param_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#transfer_param"><span class="id" title="record">transfer_param</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a id="FA12Serializable.approve_param_serializable" class="idref" href="#FA12Serializable.approve_param_serializable"><span class="id" title="axiom">approve_param_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#approve_param"><span class="id" title="record">approve_param</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a id="FA12Serializable.getAllowance_param_serializable" class="idref" href="#FA12Serializable.getAllowance_param_serializable"><span class="id" title="axiom">getAllowance_param_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#getAllowance_param"><span class="id" title="record">getAllowance_param</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a id="FA12Serializable.getBalance_param_serializable" class="idref" href="#FA12Serializable.getBalance_param_serializable"><span class="id" title="axiom">getBalance_param_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#getBalance_param"><span class="id" title="record">getBalance_param</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a id="FA12Serializable.getTotalSupply_param_serializable" class="idref" href="#FA12Serializable.getTotalSupply_param_serializable"><span class="id" title="axiom">getTotalSupply_param_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#getTotalSupply_param"><span class="id" title="record">getTotalSupply_param</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a id="FA12Serializable.FA12ReceiverMsg_serializable" class="idref" href="#FA12Serializable.FA12ReceiverMsg_serializable"><span class="id" title="axiom">FA12ReceiverMsg_serializable</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<a id="Msg:41" class="idref" href="#Msg:41"><span class="id" title="binder">Msg</span></a> : <span class="id" title="keyword">Type</span>} `{<a id="H0:42" class="idref" href="#H0:42"><span class="id" title="binder">Serializable</span></a> <a id="H0:42" class="idref" href="#H0:42"><span class="id" title="binder">Msg</span></a>}, <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> (@<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12ReceiverMsg"><span class="id" title="inductive">FA12ReceiverMsg</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#Msg:41"><span class="id" title="variable">Msg</span></a>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a id="FA12Serializable.msg_serializable" class="idref" href="#FA12Serializable.msg_serializable"><span class="id" title="axiom">msg_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#Msg"><span class="id" title="inductive">Msg</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a id="FA12Serializable.state_serializable" class="idref" href="#FA12Serializable.state_serializable"><span class="id" title="axiom">state_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#State"><span class="id" title="record">State</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a id="FA12Serializable.setup_serializable" class="idref" href="#FA12Serializable.setup_serializable"><span class="id" title="axiom">setup_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#Setup"><span class="id" title="record">Setup</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Serializable.FA12Serializable"><span class="id" title="section">FA12Serializable</span></a>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Serializable"><span class="id" title="module">FA12Serializable</span></a>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <a id="FA12SInstances" class="idref" href="#FA12SInstances"><span class="id" title="module">FA12SInstances</span></a> &lt;: <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Serializable"><span class="id" title="module">FA12Serializable</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Section</span> <a id="FA12SInstances.Serialization" class="idref" href="#FA12SInstances.Serialization"><span class="id" title="section">Serialization</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:47" class="idref" href="#H:47"><span class="id" title="binder">ChainBase</span></a>}.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Instance</span> <a id="FA12SInstances.callback_serializable" class="idref" href="#FA12SInstances.callback_serializable"><span class="id" title="instance">callback_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#callback"><span class="id" title="record">callback</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Derive</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Serializable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#callback_rect"><span class="id" title="definition">callback_rect</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&lt;</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#Build_callback"><span class="id" title="constructor">Build_callback</span></a><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&gt;</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Instance</span> <a id="FA12SInstances.transfer_param_serializable" class="idref" href="#FA12SInstances.transfer_param_serializable"><span class="id" title="instance">transfer_param_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#transfer_param"><span class="id" title="record">transfer_param</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Derive</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Serializable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#transfer_param_rect"><span class="id" title="definition">transfer_param_rect</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&lt;</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#build_transfer_param"><span class="id" title="constructor">build_transfer_param</span></a><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&gt;</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Instance</span> <a id="FA12SInstances.approve_param_serializable" class="idref" href="#FA12SInstances.approve_param_serializable"><span class="id" title="instance">approve_param_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#approve_param"><span class="id" title="record">approve_param</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Derive</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Serializable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#approve_param_rect"><span class="id" title="definition">approve_param_rect</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&lt;</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#build_approve_param"><span class="id" title="constructor">build_approve_param</span></a><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&gt;</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Instance</span> <a id="FA12SInstances.getAllowance_param_serializable" class="idref" href="#FA12SInstances.getAllowance_param_serializable"><span class="id" title="instance">getAllowance_param_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#getAllowance_param"><span class="id" title="record">getAllowance_param</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Derive</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Serializable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#getAllowance_param_rect"><span class="id" title="definition">getAllowance_param_rect</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&lt;</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#build_getAllowance_param"><span class="id" title="constructor">build_getAllowance_param</span></a><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&gt;</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Instance</span> <a id="FA12SInstances.getBalance_param_serializable" class="idref" href="#FA12SInstances.getBalance_param_serializable"><span class="id" title="instance">getBalance_param_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#getBalance_param"><span class="id" title="record">getBalance_param</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Derive</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Serializable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#getBalance_param_rect"><span class="id" title="definition">getBalance_param_rect</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&lt;</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#build_getBalance_param"><span class="id" title="constructor">build_getBalance_param</span></a><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&gt;</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Instance</span> <a id="FA12SInstances.getTotalSupply_param_serializable" class="idref" href="#FA12SInstances.getTotalSupply_param_serializable"><span class="id" title="instance">getTotalSupply_param_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#getTotalSupply_param"><span class="id" title="record">getTotalSupply_param</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Derive</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Serializable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#getTotalSupply_param_rect"><span class="id" title="definition">getTotalSupply_param_rect</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&lt;</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#build_getTotalSupply_param"><span class="id" title="constructor">build_getTotalSupply_param</span></a><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&gt;</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Instance</span> <a id="FA12SInstances.FA12ReceiverMsg_serializable" class="idref" href="#FA12SInstances.FA12ReceiverMsg_serializable"><span class="id" title="instance">FA12ReceiverMsg_serializable</span></a> {<a id="Msg:48" class="idref" href="#Msg:48"><span class="id" title="binder">Msg</span></a> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H0:49" class="idref" href="#H0:49"><span class="id" title="binder">Serializable</span></a> <a id="H0:49" class="idref" href="#H0:49"><span class="id" title="binder">Msg</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> (@<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12ReceiverMsg"><span class="id" title="inductive">FA12ReceiverMsg</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#Msg:48"><span class="id" title="variable">Msg</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Derive</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Serializable</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">(</span></a>@<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12ReceiverMsg_rect"><span class="id" title="definition">FA12ReceiverMsg_rect</span></a> <span class="id" title="var">Msg</span><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">)</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&lt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">(</span></a>@<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#receive_allowance"><span class="id" title="constructor">receive_allowance</span></a> <span class="id" title="var">Msg</span><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">(</span></a>@<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#receive_balance_of"><span class="id" title="constructor">receive_balance_of</span></a> <span class="id" title="var">Msg</span><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">(</span></a>@<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#receive_total_supply"><span class="id" title="constructor">receive_total_supply</span></a> <span class="id" title="var">Msg</span><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">(</span></a>@<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#other_msg"><span class="id" title="constructor">other_msg</span></a> <span class="id" title="var">Msg</span><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">)&gt;</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Instance</span> <a id="FA12SInstances.msg_serializable" class="idref" href="#FA12SInstances.msg_serializable"><span class="id" title="instance">msg_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#Msg"><span class="id" title="inductive">Msg</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Derive</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Serializable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#Msg_rect"><span class="id" title="definition">Msg_rect</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&lt;</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#transfer"><span class="id" title="constructor">transfer</span></a><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#approve"><span class="id" title="constructor">approve</span></a><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#getAllowance"><span class="id" title="constructor">getAllowance</span></a><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#getBalance"><span class="id" title="constructor">getBalance</span></a><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#getTotalSupply"><span class="id" title="constructor">getTotalSupply</span></a><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&gt;</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Instance</span> <a id="FA12SInstances.state_serializable" class="idref" href="#FA12SInstances.state_serializable"><span class="id" title="instance">state_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#State"><span class="id" title="record">State</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Derive</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Serializable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#State_rect"><span class="id" title="definition">State_rect</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&lt;</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#build_state"><span class="id" title="constructor">build_state</span></a><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&gt;</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Instance</span> <a id="FA12SInstances.setup_serializable" class="idref" href="#FA12SInstances.setup_serializable"><span class="id" title="instance">setup_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#Setup"><span class="id" title="record">Setup</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Derive</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Serializable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#Setup_rect"><span class="id" title="definition">Setup_rect</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&lt;</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#build_setup"><span class="id" title="constructor">build_setup</span></a><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&gt;</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12SInstances.Serialization"><span class="id" title="section">Serialization</span></a>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12SInstances"><span class="id" title="module">FA12SInstances</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab45"></a><h1 class="section">Contract functions</h1>

</div>
<div class="code">
<span class="id" title="keyword">Module</span> <a id="FA12" class="idref" href="#FA12"><span class="id" title="module">FA12</span></a> (<span class="id" title="var">SI</span> : <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Serializable"><span class="id" title="module">FA12Serializable</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#SI"><span class="id" title="module">SI</span></a>.<br/>

<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Section</span> <a id="FA12.FA12Defs" class="idref" href="#FA12.FA12Defs"><span class="id" title="section">FA12Defs</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="BaseTypes:50" class="idref" href="#BaseTypes:50"><span class="id" title="binder">BaseTypes</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainBase"><span class="id" title="class">ChainBase</span></a>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">N_scope</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="FA12.find_allowance" class="idref" href="#FA12.find_allowance"><span class="id" title="definition">find_allowance</span></a> (<a id="k:51" class="idref" href="#k:51"><span class="id" title="binder">k</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="m:52" class="idref" href="#m:52"><span class="id" title="binder">m</span></a> : <a class="idref" href="ConCert.Execution.Containers.html#FMap"><span class="id" title="abbreviation">FMap</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#k:51"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#m:52"><span class="id" title="variable">m</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="FA12.update_allowance" class="idref" href="#FA12.update_allowance"><span class="id" title="definition">update_allowance</span></a> (<a id="k:53" class="idref" href="#k:53"><span class="id" title="binder">k</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="val:54" class="idref" href="#val:54"><span class="id" title="binder">val</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="m:55" class="idref" href="#m:55"><span class="id" title="binder">m</span></a> : <a class="idref" href="ConCert.Execution.Containers.html#FMap"><span class="id" title="abbreviation">FMap</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Containers.html#FMap.update"><span class="id" title="definition">FMap.update</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#k:53"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#val:54"><span class="id" title="variable">val</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#m:55"><span class="id" title="variable">m</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="FA12.empty_allowance" class="idref" href="#FA12.empty_allowance"><span class="id" title="definition">empty_allowance</span></a> : <a class="idref" href="ConCert.Execution.Containers.html#FMap"><span class="id" title="abbreviation">FMap</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Containers.html#FMap.empty"><span class="id" title="abbreviation">FMap.empty</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab46"></a><h2 class="section">Transfer</h2>
 Transfers <span class="inlinecode"><a class="idref" href="ConCert.Examples.FA2.FA2Interface.html#amount"><span class="id" title="projection">amount</span></a></span> tokens, if <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a></span> has enough tokens to transfer
        and <span class="inlinecode"><a class="idref" href="ConCert.Examples.Crowdfunding.CrowdfundingDataExt.html#sender"><span class="id" title="definition">sender</span></a></span> is allowed to send that much on behalf of <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a></span> 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="FA12.try_transfer" class="idref" href="#FA12.try_transfer"><span class="id" title="definition">try_transfer</span></a> (<a id="sender:56" class="idref" href="#sender:56"><span class="id" title="binder">sender</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="param:57" class="idref" href="#param:57"><span class="id" title="binder">param</span></a> : <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#transfer_param"><span class="id" title="record">transfer_param</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="state:58" class="idref" href="#state:58"><span class="id" title="binder">state</span></a> : <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#State"><span class="id" title="record">State</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="ConCert.Execution.ResultMonad.html#result"><span class="id" title="inductive">result</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#State"><span class="id" title="record">State</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#Error"><span class="id" title="definition">Error</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="allowances_:59" class="idref" href="#allowances_:59"><span class="id" title="binder">allowances_</span></a> := <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#state:58"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowances"><span class="id" title="projection">allowances</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="tokens_:60" class="idref" href="#tokens_:60"><span class="id" title="binder">tokens_</span></a> := <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#state:58"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#tokens"><span class="id" title="projection">tokens</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monad.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">do</span></a> <a id="allowances_:63" class="idref" href="#allowances_:63"><span class="id" title="binder">allowances_</span></a> <a class="idref" href="ConCert.Execution.Monad.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">&lt;-</span></a> <span class="comment">(*&nbsp;Update&nbsp;allowances&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monad.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">(</span></a><span class="id" title="keyword">if</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#sender:56"><span class="id" title="variable">sender</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#param:57"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#from"><span class="id" title="projection">from</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowances_:59"><span class="id" title="variable">allowances_</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="allowance_key:61" class="idref" href="#allowance_key:61"><span class="id" title="binder">allowance_key</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#param:57"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#from"><span class="id" title="projection">from</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#sender:56"><span class="id" title="variable">sender</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="authorized_value:62" class="idref" href="#authorized_value:62"><span class="id" title="binder">authorized_value</span></a> := <a class="idref" href="ConCert.Utils.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12.find_allowance"><span class="id" title="definition">find_allowance</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowance_key:61"><span class="id" title="variable">allowance_key</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowances_:59"><span class="id" title="variable">allowances_</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monad.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">do</span></a> <span class="id" title="var">_</span> <a class="idref" href="ConCert.Execution.Monad.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Execution.ContractCommon.html#throwIf"><span class="id" title="definition">throwIf</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#authorized_value:62"><span class="id" title="variable">authorized_value</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#b39870dee55afcd85c6b795fb34de165"><span class="id" title="notation">&lt;?</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#param:57"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#value"><span class="id" title="projection">value</span></a>)) <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#default_error"><span class="id" title="definition">default_error</span></a><a class="idref" href="ConCert.Execution.Monad.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">;</span></a> <span class="comment">(*&nbsp;NotEnoughAllowance&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12.update_allowance"><span class="id" title="definition">update_allowance</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowance_key:61"><span class="id" title="variable">allowance_key</span></a> (<a class="idref" href="ConCert.Execution.ContractCommon.html#maybe"><span class="id" title="definition">maybe</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#authorized_value:62"><span class="id" title="variable">authorized_value</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#param:57"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#value"><span class="id" title="projection">value</span></a>))) <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowances_:59"><span class="id" title="variable">allowances_</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monad.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">)</span></a> <a class="idref" href="ConCert.Execution.Monad.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monad.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">do</span></a> <a id="tokens_:65" class="idref" href="#tokens_:65"><span class="id" title="binder">tokens_</span></a> <a class="idref" href="ConCert.Execution.Monad.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">&lt;-</span></a> <span class="comment">(*&nbsp;Update&nbsp;from&nbsp;balance&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monad.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">(</span></a><span class="id" title="keyword">let</span> <a id="from_balance:64" class="idref" href="#from_balance:64"><span class="id" title="binder">from_balance</span></a> := <a class="idref" href="ConCert.Utils.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.ContractCommon.html#AddressMap.find"><span class="id" title="definition">AddressMap.find</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#param:57"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#from"><span class="id" title="projection">from</span></a>) <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#tokens_:60"><span class="id" title="variable">tokens_</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monad.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">do</span></a> <span class="id" title="var">_</span> <a class="idref" href="ConCert.Execution.Monad.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Execution.ContractCommon.html#throwIf"><span class="id" title="definition">throwIf</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#from_balance:64"><span class="id" title="variable">from_balance</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#b39870dee55afcd85c6b795fb34de165"><span class="id" title="notation">&lt;?</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#param:57"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#value"><span class="id" title="projection">value</span></a>)) <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#default_error"><span class="id" title="definition">default_error</span></a><a class="idref" href="ConCert.Execution.Monad.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">;</span></a> <span class="comment">(*&nbsp;NotEnoughBalance&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> (<a class="idref" href="ConCert.Execution.ContractCommon.html#AddressMap.update"><span class="id" title="definition">AddressMap.update</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#param:57"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#from"><span class="id" title="projection">from</span></a>) (<a class="idref" href="ConCert.Execution.ContractCommon.html#maybe"><span class="id" title="definition">maybe</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#from_balance:64"><span class="id" title="variable">from_balance</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#param:57"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#value"><span class="id" title="projection">value</span></a>))) <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#tokens_:60"><span class="id" title="variable">tokens_</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monad.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">)</span></a> <a class="idref" href="ConCert.Execution.Monad.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="tokens_:67" class="idref" href="#tokens_:67"><span class="id" title="binder">tokens_</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="to_balance:66" class="idref" href="#to_balance:66"><span class="id" title="binder">to_balance</span></a> := <a class="idref" href="ConCert.Utils.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.ContractCommon.html#AddressMap.find"><span class="id" title="definition">AddressMap.find</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#param:57"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#to"><span class="id" title="projection">to</span></a>) <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#tokens_:65"><span class="id" title="variable">tokens_</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.ContractCommon.html#AddressMap.update"><span class="id" title="definition">AddressMap.update</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#param:57"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#to"><span class="id" title="projection">to</span></a>) (<a class="idref" href="ConCert.Execution.ContractCommon.html#maybe"><span class="id" title="definition">maybe</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#to_balance:66"><span class="id" title="variable">to_balance</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#param:57"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#value"><span class="id" title="projection">value</span></a>))) <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#tokens_:65"><span class="id" title="variable">tokens_</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#state:58"><span class="id" title="variable">state</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">&lt;|</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">:=</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#tokens_:67"><span class="id" title="variable">tokens_</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">|&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">&lt;|</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">:=</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowances_:63"><span class="id" title="variable">allowances_</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">|&gt;</span></a>).<br/>

<br/>
</div>

<div class="doc">
<a id="lab47"></a><h2 class="section">Approve</h2>
 The caller approves the <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#spender"><span class="id" title="projection">spender</span></a></span> to transfer up to <span class="inlinecode"><a class="idref" href="ConCert.Examples.FA2.FA2Interface.html#amount"><span class="id" title="projection">amount</span></a></span> tokens on behalf of the <span class="inlinecode"><a class="idref" href="ConCert.Examples.Crowdfunding.CrowdfundingDataExt.html#sender"><span class="id" title="definition">sender</span></a></span> 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="FA12.try_approve" class="idref" href="#FA12.try_approve"><span class="id" title="definition">try_approve</span></a> (<a id="sender:68" class="idref" href="#sender:68"><span class="id" title="binder">sender</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="param:69" class="idref" href="#param:69"><span class="id" title="binder">param</span></a> : <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#approve_param"><span class="id" title="record">approve_param</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="state:70" class="idref" href="#state:70"><span class="id" title="binder">state</span></a> : <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#State"><span class="id" title="record">State</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="ConCert.Execution.ResultMonad.html#result"><span class="id" title="inductive">result</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#State"><span class="id" title="record">State</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#Error"><span class="id" title="definition">Error</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="allowances_:71" class="idref" href="#allowances_:71"><span class="id" title="binder">allowances_</span></a> := <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#state:70"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowances"><span class="id" title="projection">allowances</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="allowance_key:72" class="idref" href="#allowance_key:72"><span class="id" title="binder">allowance_key</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#sender:68"><span class="id" title="variable">sender</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#param:69"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#spender"><span class="id" title="projection">spender</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="previous_value:73" class="idref" href="#previous_value:73"><span class="id" title="binder">previous_value</span></a> := <a class="idref" href="ConCert.Utils.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12.find_allowance"><span class="id" title="definition">find_allowance</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowance_key:72"><span class="id" title="variable">allowance_key</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowances_:71"><span class="id" title="variable">allowances_</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monad.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">do</span></a> <span class="id" title="var">_</span> <a class="idref" href="ConCert.Execution.Monad.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Execution.ContractCommon.html#throwIf"><span class="id" title="definition">throwIf</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#andb"><span class="id" title="definition">andb</span></a> (0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#b39870dee55afcd85c6b795fb34de165"><span class="id" title="notation">&lt;?</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#previous_value:73"><span class="id" title="variable">previous_value</span></a>) (0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#b39870dee55afcd85c6b795fb34de165"><span class="id" title="notation">&lt;?</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#param:69"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#value_"><span class="id" title="projection">value_</span></a>))) <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#default_error"><span class="id" title="definition">default_error</span></a><a class="idref" href="ConCert.Execution.Monad.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">;</span></a> <span class="comment">(*&nbsp;UnsafeAllowanceChange&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="allowances_:74" class="idref" href="#allowances_:74"><span class="id" title="binder">allowances_</span></a> := <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12.update_allowance"><span class="id" title="definition">update_allowance</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowance_key:72"><span class="id" title="variable">allowance_key</span></a> (<a class="idref" href="ConCert.Execution.ContractCommon.html#maybe"><span class="id" title="definition">maybe</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#param:69"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#value_"><span class="id" title="projection">value_</span></a>)) <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowances_:71"><span class="id" title="variable">allowances_</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#state:70"><span class="id" title="variable">state</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">&lt;|</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">:=</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowances_:74"><span class="id" title="variable">allowances_</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">|&gt;</span></a>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="FA12.mk_callback" class="idref" href="#FA12.mk_callback"><span class="id" title="definition">mk_callback</span></a> (<a id="to_addr:75" class="idref" href="#to_addr:75"><span class="id" title="binder">to_addr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="msg:76" class="idref" href="#msg:76"><span class="id" title="binder">msg</span></a> : @<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12ReceiverMsg"><span class="id" title="inductive">FA12ReceiverMsg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#unit"><span class="id" title="inductive">unit</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#to_addr:75"><span class="id" title="variable">to_addr</span></a> 0 (<a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#msg:76"><span class="id" title="variable">msg</span></a>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="FA12.receive_allowance_" class="idref" href="#FA12.receive_allowance_"><span class="id" title="definition">receive_allowance_</span></a> <a id="n:77" class="idref" href="#n:77"><span class="id" title="binder">n</span></a> := @<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#receive_allowance"><span class="id" title="constructor">receive_allowance</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#unit"><span class="id" title="inductive">unit</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#n:77"><span class="id" title="variable">n</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="FA12.receive_balance_of_" class="idref" href="#FA12.receive_balance_of_"><span class="id" title="definition">receive_balance_of_</span></a> <a id="n:78" class="idref" href="#n:78"><span class="id" title="binder">n</span></a> := @<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#receive_balance_of"><span class="id" title="constructor">receive_balance_of</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#unit"><span class="id" title="inductive">unit</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#n:78"><span class="id" title="variable">n</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="FA12.receive_total_supply_" class="idref" href="#FA12.receive_total_supply_"><span class="id" title="definition">receive_total_supply_</span></a> <a id="n:79" class="idref" href="#n:79"><span class="id" title="binder">n</span></a> := @<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#receive_total_supply"><span class="id" title="constructor">receive_total_supply</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#unit"><span class="id" title="inductive">unit</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#n:79"><span class="id" title="variable">n</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab48"></a><h2 class="section">Get allowance</h2>
 Get the quantity that <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a></span> <span class="inlinecode"><a class="idref" href="ConCert.Examples.FA2.FA2Interface.html#request"><span class="id" title="projection">request</span></a></span> is allowed to spend on behalf of <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a></span> <span class="inlinecode"><a class="idref" href="ConCert.Examples.FA2.FA2Interface.html#request"><span class="id" title="projection">request</span></a></span> 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="FA12.try_get_allowance" class="idref" href="#FA12.try_get_allowance"><span class="id" title="definition">try_get_allowance</span></a> (<a id="sender:80" class="idref" href="#sender:80"><span class="id" title="binder">sender</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="param:81" class="idref" href="#param:81"><span class="id" title="binder">param</span></a> : <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#getAllowance_param"><span class="id" title="record">getAllowance_param</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="state:82" class="idref" href="#state:82"><span class="id" title="binder">state</span></a> : <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#State"><span class="id" title="record">State</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="value:83" class="idref" href="#value:83"><span class="id" title="binder">value</span></a> := <a class="idref" href="ConCert.Utils.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12.find_allowance"><span class="id" title="definition">find_allowance</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#param:81"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#request"><span class="id" title="projection">request</span></a>) <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#state:82"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowances"><span class="id" title="projection">allowances</span></a>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12.mk_callback"><span class="id" title="definition">mk_callback</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#param:81"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowance_callback"><span class="id" title="projection">allowance_callback</span></a>) (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12.receive_allowance_"><span class="id" title="definition">receive_allowance_</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#value:83"><span class="id" title="variable">value</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab49"></a><h2 class="section">Get balance</h2>
 Get the quantity of tokens belonging to <span class="inlinecode"><a class="idref" href="ConCert.Embedding.Examples.AcornExamples.html#ForPeresentation.owner"><span class="id" title="definition">owner</span></a></span> 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="FA12.try_get_balance" class="idref" href="#FA12.try_get_balance"><span class="id" title="definition">try_get_balance</span></a> (<a id="sender:84" class="idref" href="#sender:84"><span class="id" title="binder">sender</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="param:85" class="idref" href="#param:85"><span class="id" title="binder">param</span></a> : <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#getBalance_param"><span class="id" title="record">getBalance_param</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="state:86" class="idref" href="#state:86"><span class="id" title="binder">state</span></a> : <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#State"><span class="id" title="record">State</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="value:87" class="idref" href="#value:87"><span class="id" title="binder">value</span></a> := <a class="idref" href="ConCert.Utils.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.ContractCommon.html#AddressMap.find"><span class="id" title="definition">AddressMap.find</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#param:85"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#owner_"><span class="id" title="projection">owner_</span></a>) <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#state:86"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#tokens"><span class="id" title="projection">tokens</span></a>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12.mk_callback"><span class="id" title="definition">mk_callback</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#param:85"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#balance_callback"><span class="id" title="projection">balance_callback</span></a>) (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12.receive_balance_of_"><span class="id" title="definition">receive_balance_of_</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#value:87"><span class="id" title="variable">value</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab50"></a><h2 class="section">Get total supply</h2>
 Get the total supply of tokens 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="FA12.try_get_total_supply" class="idref" href="#FA12.try_get_total_supply"><span class="id" title="definition">try_get_total_supply</span></a> (<a id="sender:88" class="idref" href="#sender:88"><span class="id" title="binder">sender</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="param:89" class="idref" href="#param:89"><span class="id" title="binder">param</span></a> : <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#getTotalSupply_param"><span class="id" title="record">getTotalSupply_param</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="state:90" class="idref" href="#state:90"><span class="id" title="binder">state</span></a> : <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#State"><span class="id" title="record">State</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="value:91" class="idref" href="#value:91"><span class="id" title="binder">value</span></a> := <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#state:90"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#total_supply"><span class="id" title="projection">total_supply</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12.mk_callback"><span class="id" title="definition">mk_callback</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#param:89"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#supply_callback"><span class="id" title="projection">supply_callback</span></a>) (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12.receive_total_supply_"><span class="id" title="definition">receive_total_supply_</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#value:91"><span class="id" title="variable">value</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab51"></a><h2 class="section">Init</h2>
 Initalize contract storage 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="FA12.init" class="idref" href="#FA12.init"><span class="id" title="definition">init</span></a> (<a id="chain:92" class="idref" href="#chain:92"><span class="id" title="binder">chain</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="ctx:93" class="idref" href="#ctx:93"><span class="id" title="binder">ctx</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallContext"><span class="id" title="record">ContractCallContext</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="setup:94" class="idref" href="#setup:94"><span class="id" title="binder">setup</span></a> : <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#Setup"><span class="id" title="record">Setup</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="ConCert.Execution.ResultMonad.html#result"><span class="id" title="inductive">result</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#State"><span class="id" title="record">State</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#Error"><span class="id" title="definition">Error</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monad.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">do</span></a> <span class="id" title="var">_</span> <a class="idref" href="ConCert.Execution.Monad.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Execution.ContractCommon.html#throwIf"><span class="id" title="definition">throwIf</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#non_zero_amount"><span class="id" title="definition">non_zero_amount</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#ctx:93"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a>)) <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#default_error"><span class="id" title="definition">default_error</span></a><a class="idref" href="ConCert.Execution.Monad.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">;</span></a> <span class="comment">(*&nbsp;DontSendTez&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> {|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#tokens"><span class="id" title="projection">tokens</span></a> := <a class="idref" href="ConCert.Execution.ContractCommon.html#AddressMap.add"><span class="id" title="definition">AddressMap.add</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#setup:94"><span class="id" title="variable">setup</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#lqt_provider"><span class="id" title="projection">lqt_provider</span></a>) <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#setup:94"><span class="id" title="variable">setup</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#initial_pool"><span class="id" title="projection">initial_pool</span></a>) <a class="idref" href="ConCert.Execution.ContractCommon.html#AddressMap.empty"><span class="id" title="definition">AddressMap.empty</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowances"><span class="id" title="projection">allowances</span></a> := <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12.empty_allowance"><span class="id" title="definition">empty_allowance</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#total_supply"><span class="id" title="projection">total_supply</span></a> := <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#setup:94"><span class="id" title="variable">setup</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#initial_pool"><span class="id" title="projection">initial_pool</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|}.<br/>

<br/>
</div>

<div class="doc">
<a id="lab52"></a><h2 class="section">Receive</h2>
 Contract main entrypoint 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">Z_scope</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="FA12.receive" class="idref" href="#FA12.receive"><span class="id" title="definition">receive</span></a> (<a id="chain:95" class="idref" href="#chain:95"><span class="id" title="binder">chain</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="ctx:96" class="idref" href="#ctx:96"><span class="id" title="binder">ctx</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallContext"><span class="id" title="record">ContractCallContext</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="state:97" class="idref" href="#state:97"><span class="id" title="binder">state</span></a> : <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#State"><span class="id" title="record">State</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="maybe_msg:98" class="idref" href="#maybe_msg:98"><span class="id" title="binder">maybe_msg</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#Msg"><span class="id" title="inductive">Msg</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="ConCert.Execution.ResultMonad.html#result"><span class="id" title="inductive">result</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#State"><span class="id" title="record">State</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>) <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#Error"><span class="id" title="definition">Error</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="sender:99" class="idref" href="#sender:99"><span class="id" title="binder">sender</span></a> := <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#ctx:96"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="without_statechange:101" class="idref" href="#without_statechange:101"><span class="id" title="binder">without_statechange</span></a> <a id="acts:100" class="idref" href="#acts:100"><span class="id" title="binder">acts</span></a> := <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#state:97"><span class="id" title="variable">state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#acts:100"><span class="id" title="variable">acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monad.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">do</span></a> <span class="id" title="var">_</span> <a class="idref" href="ConCert.Execution.Monad.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Execution.ContractCommon.html#throwIf"><span class="id" title="definition">throwIf</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#non_zero_amount"><span class="id" title="definition">non_zero_amount</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#ctx:96"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a>)) <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#default_error"><span class="id" title="definition">default_error</span></a><a class="idref" href="ConCert.Execution.Monad.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">;</span></a> <span class="comment">(*&nbsp;DontSendTez&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#maybe_msg:98"><span class="id" title="variable">maybe_msg</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#transfer"><span class="id" title="constructor">transfer</span></a> <span class="id" title="var">param</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.ContractCommon.html#without_actions"><span class="id" title="definition">without_actions</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12.try_transfer"><span class="id" title="definition">try_transfer</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#sender:99"><span class="id" title="variable">sender</span></a> <span class="id" title="var">param</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#state:97"><span class="id" title="variable">state</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#approve"><span class="id" title="constructor">approve</span></a> <span class="id" title="var">param</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.ContractCommon.html#without_actions"><span class="id" title="definition">without_actions</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12.try_approve"><span class="id" title="definition">try_approve</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#sender:99"><span class="id" title="variable">sender</span></a> <span class="id" title="var">param</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#state:97"><span class="id" title="variable">state</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#getAllowance"><span class="id" title="constructor">getAllowance</span></a> <span class="id" title="var">param</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#without_statechange:101"><span class="id" title="variable">without_statechange</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12.try_get_allowance"><span class="id" title="definition">try_get_allowance</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#sender:99"><span class="id" title="variable">sender</span></a> <span class="id" title="var">param</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#state:97"><span class="id" title="variable">state</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#getBalance"><span class="id" title="constructor">getBalance</span></a> <span class="id" title="var">param</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#without_statechange:101"><span class="id" title="variable">without_statechange</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12.try_get_balance"><span class="id" title="definition">try_get_balance</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#sender:99"><span class="id" title="variable">sender</span></a> <span class="id" title="var">param</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#state:97"><span class="id" title="variable">state</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#getTotalSupply"><span class="id" title="constructor">getTotalSupply</span></a> <span class="id" title="var">param</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#without_statechange:101"><span class="id" title="variable">without_statechange</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12.try_get_total_supply"><span class="id" title="definition">try_get_total_supply</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#sender:99"><span class="id" title="variable">sender</span></a> <span class="id" title="var">param</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#state:97"><span class="id" title="variable">state</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Transfer&nbsp;actions&nbsp;to&nbsp;this&nbsp;contract&nbsp;are&nbsp;not&nbsp;allowed&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="ConCert.Execution.ResultMonad.html#Err"><span class="id" title="constructor">Err</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#default_error"><span class="id" title="definition">default_error</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">Z_scope</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="FA12.contract" class="idref" href="#FA12.contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Contract"><span class="id" title="record">Contract</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#Setup"><span class="id" title="record">Setup</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#Msg"><span class="id" title="inductive">Msg</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#State"><span class="id" title="record">State</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#Error"><span class="id" title="definition">Error</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_contract"><span class="id" title="constructor">build_contract</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12.init"><span class="id" title="definition">init</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12.receive"><span class="id" title="definition">receive</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12.FA12Defs"><span class="id" title="section">FA12Defs</span></a>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12"><span class="id" title="module">FA12</span></a>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <a id="FA12Instance" class="idref" href="#FA12Instance"><span class="id" title="module">FA12Instance</span></a> := <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12"><span class="id" title="module">FA12</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12SInstances"><span class="id" title="module">FA12SInstances</span></a>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="https://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a> and <a href="https://github.com/jgallen23/toc">TOC</a>
</div>
</div>
<script>
  const elements = document.getElementsByClassName("libtitle");
  while(elements.length > 0){
        elements[0].parentNode.removeChild(elements[0]);
  }
  if (window.location.pathname.endsWith("/toc.html")) {
      const jstocDiv = document.getElementById("js-toc");
      jstocDiv.classList.remove("toc");
      jstocDiv.classList.add("jstoc-hidden");
      const jstocHeaderDiv = document.getElementById("js-toc-header");
      jstocHeaderDiv.classList.add("jstoc-hidden");
      const mainDiv = document.getElementById("main");
      mainDiv.classList.add("jstoc-hidden-main");
      const toggleDiv = document.getElementById("toggle-toc");
      toggleDiv.classList.add("jstoc-hidden");
  }
  console.log(window.location.pathname);
</script>
<script type="text/javascript" src="toc.js"></script>
</body>

</html>
