<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<link href="toc.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
      <span id="toggle-toc">Contents</span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="https://github.com/AU-COBRA/ConCert" target="_balnk">Project Page</a>
      <a href="index.html">Index</a>
      <a href="toc.html">Table of contents</a>
    </span>
</div>
  <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="js-toc" class="toc" data-toc="h1,h2,h3,h4" data-toc-container="doc" data-toc-offset="-40">
      <div id="js-toc-header" class="toc-header">Contents:</div>
    </div>
    <div id="main">
<h1 class="libtitle">Library ConCert.Examples.Congress.CongressCorrect</h1>

<div class="code">
<span class="comment">(*&nbsp;In&nbsp;this&nbsp;file&nbsp;we&nbsp;implement&nbsp;a&nbsp;Congress&nbsp;and&nbsp;prove&nbsp;it&nbsp;correct&nbsp;up&nbsp;to&nbsp;a<br/>
specification.&nbsp;The&nbsp;Congress&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;DAO&nbsp;in<br/>
which&nbsp;members&nbsp;vote&nbsp;on&nbsp;proposals.&nbsp;We&nbsp;implement&nbsp;the&nbsp;contract&nbsp;in&nbsp;Gallina<br/>
and&nbsp;then&nbsp;show&nbsp;that&nbsp;it&nbsp;does&nbsp;not&nbsp;send&nbsp;out&nbsp;more&nbsp;transactions&nbsp;than<br/>
expected&nbsp;from&nbsp;the&nbsp;number&nbsp;of&nbsp;created&nbsp;proposals.&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.micromega.Psatz.html#"><span class="id" title="library">Psatz</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#"><span class="id" title="library">List</span></a>. <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ListNotations"><span class="id" title="module">ListNotations</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Blockchain.html#"><span class="id" title="library">Blockchain</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Containers.html#"><span class="id" title="library">Containers</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.ResultMonad.html#"><span class="id" title="library">ResultMonad</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.ContractCommon.html#"><span class="id" title="library">ContractCommon</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Examples.Congress</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Examples.Congress.Congress.html#"><span class="id" title="library">Congress</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Utils.Automation.html#"><span class="id" title="library">Automation</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Utils.Extras.html#"><span class="id" title="library">Extras</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Utils.RecordUpdate.html#"><span class="id" title="library">RecordUpdate</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="Theories" class="idref" href="#Theories"><span class="id" title="section">Theories</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<a id="BaseTypes:1" class="idref" href="#BaseTypes:1"><span class="id" title="binder">BaseTypes</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainBase"><span class="id" title="class">ChainBase</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">nat</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;The&nbsp;rules&nbsp;stored&nbsp;in&nbsp;the&nbsp;blockchain's&nbsp;state&nbsp;are&nbsp;always&nbsp;valid&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="rules_valid" class="idref" href="#rules_valid"><span class="id" title="lemma">rules_valid</span></a> <a id="bstate:2" class="idref" href="#bstate:2"><span class="id" title="binder">bstate</span></a> <a id="caddr:3" class="idref" href="#caddr:3"><span class="id" title="binder">caddr</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#bstate:2"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#bstate:2"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#caddr:3"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.Congress.Congress.html#contract"><span class="id" title="definition">Congress.contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="cstate:4" class="idref" href="#cstate:4"><span class="id" title="binder">cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#bstate:2"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#caddr:3"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#cstate:4"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Congress.Congress.html#validate_rules"><span class="id" title="definition">validate_rules</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#cstate:4"><span class="id" title="variable">cstate</span></a>.(<a class="idref" href="ConCert.Examples.Congress.Congress.html#state_rules"><span class="id" title="projection">state_rules</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#lift_contract_state_prop"><span class="id" title="lemma">lift_contract_state_prop</span></a> <a class="idref" href="ConCert.Examples.Congress.Congress.html#contract"><span class="id" title="definition">contract</span></a>); <span class="id" title="tactic">intros</span> *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">init_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">init_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.Congress.Congress.html#init"><span class="id" title="definition">Congress.init</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">init_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">validate_succeeds</span> <span class="id" title="tactic">in</span> <span class="id" title="var">init_some</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">init_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">valid_prev</span> <span class="id" title="var">receive</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span> <span class="id" title="keyword">as</span> [[]|]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H</span>: <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> ?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> ?<span class="id" title="var">y</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">auto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>; <span class="id" title="keyword">let</span> <span class="id" title="var">H</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="tactic">in</span> <span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">H</span> <span class="id" title="tactic">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">destruct_match</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.Congress.Congress.html#vote_on_proposal"><span class="id" title="definition">vote_on_proposal</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">receive</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">destruct_match</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.Congress.Congress.html#vote_on_proposal"><span class="id" title="definition">vote_on_proposal</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">receive</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">destruct_match</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.Congress.Congress.html#do_retract_vote"><span class="id" title="definition">do_retract_vote</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">receive</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">receive</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="num_acts_created_in_proposals" class="idref" href="#num_acts_created_in_proposals"><span class="id" title="definition">num_acts_created_in_proposals</span></a> (<a id="calls:5" class="idref" href="#calls:5"><span class="id" title="binder">calls</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallInfo"><span class="id" title="record">ContractCallInfo</span></a> <a class="idref" href="ConCert.Examples.Congress.Congress.html#Msg"><span class="id" title="inductive">Congress.Msg</span></a>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="count:7" class="idref" href="#count:7"><span class="id" title="binder">count</span></a> <a id="call:6" class="idref" href="#call:6"><span class="id" title="binder">call</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#call_msg"><span class="id" title="projection">call_msg</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#call:6"><span class="id" title="variable">call</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.Congress.Congress.html#create_proposal"><span class="id" title="constructor">create_proposal</span></a> <span class="id" title="var">acts</span>) =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> <span class="id" title="var">acts</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.Extras.html#sumnat"><span class="id" title="definition">sumnat</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#count:7"><span class="id" title="variable">count</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#calls:5"><span class="id" title="variable">calls</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="num_cacts_in_state" class="idref" href="#num_cacts_in_state"><span class="id" title="definition">num_cacts_in_state</span></a> <a id="state:8" class="idref" href="#state:8"><span class="id" title="binder">state</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.Extras.html#sumnat"><span class="id" title="definition">sumnat</span></a> (<span class="id" title="keyword">fun</span> '<a id="pat:11" class="idref" href="#pat:11"><span class="id" title="binder">(</span></a><a id="pat:11" class="idref" href="#pat:11"><span class="id" title="binder">k</span></a><a id="pat:11" class="idref" href="#pat:11"><span class="id" title="binder">,</span></a> <a id="pat:11" class="idref" href="#pat:11"><span class="id" title="binder">v</span></a><a id="pat:11" class="idref" href="#pat:11"><span class="id" title="binder">)</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> (<a class="idref" href="ConCert.Examples.Congress.Congress.html#actions"><span class="id" title="projection">actions</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#v:9"><span class="id" title="variable">v</span></a>)) (<a class="idref" href="ConCert.Execution.Containers.html#FMap.elements"><span class="id" title="abbreviation">FMap.elements</span></a> (<a class="idref" href="ConCert.Examples.Congress.Congress.html#proposals"><span class="id" title="projection">proposals</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#state:8"><span class="id" title="variable">state</span></a>)).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="num_cacts_in_state_deployment" class="idref" href="#num_cacts_in_state_deployment"><span class="id" title="lemma">num_cacts_in_state_deployment</span></a> <a id="chain:12" class="idref" href="#chain:12"><span class="id" title="binder">chain</span></a> <a id="ctx:13" class="idref" href="#ctx:13"><span class="id" title="binder">ctx</span></a> <a id="setup:14" class="idref" href="#setup:14"><span class="id" title="binder">setup</span></a> <a id="state:15" class="idref" href="#state:15"><span class="id" title="binder">state</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Congress.Congress.html#init"><span class="id" title="definition">init</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#chain:12"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#ctx:13"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#setup:14"><span class="id" title="variable">setup</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#state:15"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#num_cacts_in_state"><span class="id" title="definition">num_cacts_in_state</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#state:15"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">init</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.Congress.Congress.html#init"><span class="id" title="definition">Congress.init</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">init</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Examples.Congress.Congress.html#validate_rules"><span class="id" title="definition">validate_rules</span></a> <span class="id" title="var">_</span>); <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">init</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span> <span class="id" title="var">remember_new_proposal</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [|- <span class="id" title="keyword">context</span>[<a class="idref" href="ConCert.Execution.Containers.html#FMap.add"><span class="id" title="abbreviation">FMap.add</span></a> <span class="id" title="var">_</span> ?<span class="id" title="var">p</span>]] =&gt; <span class="id" title="var">remember</span> <span class="id" title="var">p</span> <span class="id" title="keyword">as</span> <span class="id" title="var">new_proposal</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">FMap.find_remove</span> : <span class="id" title="var">core</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="add_proposal_cacts" class="idref" href="#add_proposal_cacts"><span class="id" title="lemma">add_proposal_cacts</span></a> <a id="cacts:16" class="idref" href="#cacts:16"><span class="id" title="binder">cacts</span></a> <a id="chain:17" class="idref" href="#chain:17"><span class="id" title="binder">chain</span></a> <a id="state:18" class="idref" href="#state:18"><span class="id" title="binder">state</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#num_cacts_in_state"><span class="id" title="definition">num_cacts_in_state</span></a> (<a class="idref" href="ConCert.Examples.Congress.Congress.html#add_proposal"><span class="id" title="definition">add_proposal</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#cacts:16"><span class="id" title="variable">cacts</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#chain:17"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#state:18"><span class="id" title="variable">state</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">&lt;=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#num_cacts_in_state"><span class="id" title="definition">num_cacts_in_state</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#state:18"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#cacts:16"><span class="id" title="variable">cacts</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.Congress.Congress.html#add_proposal"><span class="id" title="definition">add_proposal</span></a>, <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#num_cacts_in_state"><span class="id" title="definition">num_cacts_in_state</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> (<a class="idref" href="ConCert.Examples.Congress.Congress.html#next_proposal_id"><span class="id" title="projection">next_proposal_id</span></a> <span class="id" title="var">state</span>) (<a class="idref" href="ConCert.Examples.Congress.Congress.html#proposals"><span class="id" title="projection">proposals</span></a> <span class="id" title="var">state</span>)) <span class="id" title="keyword">as</span> [<span class="id" title="var">proposal</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">find</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">remember_new_proposal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<a class="idref" href="ConCert.Execution.Containers.html#FMap.add_remove"><span class="id" title="lemma">FMap.add_remove</span></a> (<a class="idref" href="ConCert.Examples.Congress.Congress.html#next_proposal_id"><span class="id" title="projection">next_proposal_id</span></a> <span class="id" title="var">state</span>) <span class="id" title="var">new_proposal</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<a class="idref" href="ConCert.Execution.Containers.html#FMap.add_id"><span class="id" title="lemma">FMap.add_id</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">find</span>) <span class="id" title="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<a class="idref" href="ConCert.Execution.Containers.html#FMap.add_remove"><span class="id" title="lemma">FMap.add_remove</span></a> (<a class="idref" href="ConCert.Examples.Congress.Congress.html#next_proposal_id"><span class="id" title="projection">next_proposal_id</span></a> <span class="id" title="var">state</span>) <span class="id" title="var">proposal</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.elements_add"><span class="id" title="lemma">FMap.elements_add</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.elements_add"><span class="id" title="lemma">FMap.elements_add</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="vote_on_proposal_cacts_preserved" class="idref" href="#vote_on_proposal_cacts_preserved"><span class="id" title="lemma">vote_on_proposal_cacts_preserved</span></a> <a id="addr:19" class="idref" href="#addr:19"><span class="id" title="binder">addr</span></a> <a id="pid:20" class="idref" href="#pid:20"><span class="id" title="binder">pid</span></a> <a id="vote_val:21" class="idref" href="#vote_val:21"><span class="id" title="binder">vote_val</span></a> <a id="state:22" class="idref" href="#state:22"><span class="id" title="binder">state</span></a> <a id="new_state:23" class="idref" href="#new_state:23"><span class="id" title="binder">new_state</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Congress.Congress.html#vote_on_proposal"><span class="id" title="definition">vote_on_proposal</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#addr:19"><span class="id" title="variable">addr</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#pid:20"><span class="id" title="variable">pid</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#vote_val:21"><span class="id" title="variable">vote_val</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#state:22"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#new_state:23"><span class="id" title="variable">new_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#num_cacts_in_state"><span class="id" title="definition">num_cacts_in_state</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#new_state:23"><span class="id" title="variable">new_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#num_cacts_in_state"><span class="id" title="definition">num_cacts_in_state</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#state:22"><span class="id" title="variable">state</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">vote</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.Congress.Congress.html#vote_on_proposal"><span class="id" title="definition">vote_on_proposal</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">vote</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">found</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">vote</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#num_cacts_in_state"><span class="id" title="definition">num_cacts_in_state</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember_new_proposal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<a class="idref" href="ConCert.Execution.Containers.html#FMap.add_id"><span class="id" title="lemma">FMap.add_id</span></a> <span class="id" title="var">pid</span> <span class="id" title="var">p</span> (<a class="idref" href="ConCert.Examples.Congress.Congress.html#proposals"><span class="id" title="projection">proposals</span></a> <span class="id" title="var">state</span>)) <span class="id" title="tactic">at</span> 1; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<a class="idref" href="ConCert.Execution.Containers.html#FMap.add_remove"><span class="id" title="lemma">FMap.add_remove</span></a> <span class="id" title="var">pid</span> <span class="id" title="var">p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<a class="idref" href="ConCert.Execution.Containers.html#FMap.add_remove"><span class="id" title="lemma">FMap.add_remove</span></a> <span class="id" title="var">pid</span> <span class="id" title="var">new_proposal</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.elements_add"><span class="id" title="lemma">FMap.elements_add</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find_remove"><span class="id" title="lemma">FMap.find_remove</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">FMap.find_remove</span> : <span class="id" title="var">core</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="do_retract_vote_cacts_preserved" class="idref" href="#do_retract_vote_cacts_preserved"><span class="id" title="lemma">do_retract_vote_cacts_preserved</span></a> <a id="addr:24" class="idref" href="#addr:24"><span class="id" title="binder">addr</span></a> <a id="pid:25" class="idref" href="#pid:25"><span class="id" title="binder">pid</span></a> <a id="state:26" class="idref" href="#state:26"><span class="id" title="binder">state</span></a> <a id="new_state:27" class="idref" href="#new_state:27"><span class="id" title="binder">new_state</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Congress.Congress.html#do_retract_vote"><span class="id" title="definition">do_retract_vote</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#addr:24"><span class="id" title="variable">addr</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#pid:25"><span class="id" title="variable">pid</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#state:26"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#new_state:27"><span class="id" title="variable">new_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#num_cacts_in_state"><span class="id" title="definition">num_cacts_in_state</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#new_state:27"><span class="id" title="variable">new_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#num_cacts_in_state"><span class="id" title="definition">num_cacts_in_state</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#state:26"><span class="id" title="variable">state</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">retract</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.Congress.Congress.html#do_retract_vote"><span class="id" title="definition">do_retract_vote</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">retract</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">found</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <span class="id" title="var">addr</span> <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">retract</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#num_cacts_in_state"><span class="id" title="definition">num_cacts_in_state</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember_new_proposal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<a class="idref" href="ConCert.Execution.Containers.html#FMap.add_id"><span class="id" title="lemma">FMap.add_id</span></a> <span class="id" title="var">pid</span> <span class="id" title="var">p</span> (<a class="idref" href="ConCert.Examples.Congress.Congress.html#proposals"><span class="id" title="projection">proposals</span></a> <span class="id" title="var">state</span>)) <span class="id" title="tactic">at</span> 1; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<a class="idref" href="ConCert.Execution.Containers.html#FMap.add_remove"><span class="id" title="lemma">FMap.add_remove</span></a> <span class="id" title="var">pid</span> <span class="id" title="var">p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<a class="idref" href="ConCert.Execution.Containers.html#FMap.add_remove"><span class="id" title="lemma">FMap.add_remove</span></a> <span class="id" title="var">pid</span> <span class="id" title="var">new_proposal</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.elements_add"><span class="id" title="lemma">FMap.elements_add</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="remove_proposal_cacts" class="idref" href="#remove_proposal_cacts"><span class="id" title="lemma">remove_proposal_cacts</span></a> <a id="pid:28" class="idref" href="#pid:28"><span class="id" title="binder">pid</span></a> <a id="state:29" class="idref" href="#state:29"><span class="id" title="binder">state</span></a> <a id="proposal:30" class="idref" href="#proposal:30"><span class="id" title="binder">proposal</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#pid:28"><span class="id" title="variable">pid</span></a> (<a class="idref" href="ConCert.Examples.Congress.Congress.html#proposals"><span class="id" title="projection">proposals</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#state:29"><span class="id" title="variable">state</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#proposal:30"><span class="id" title="variable">proposal</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#num_cacts_in_state"><span class="id" title="definition">num_cacts_in_state</span></a> (<a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#state:29"><span class="id" title="variable">state</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">&lt;|</span></a><a class="idref" href="ConCert.Examples.Congress.Congress.html#proposals"><span class="id" title="projection">proposals</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">::=</span></a> <a class="idref" href="ConCert.Execution.Containers.html#FMap.remove"><span class="id" title="abbreviation">FMap.remove</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#pid:28"><span class="id" title="variable">pid</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">|&gt;</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> (<a class="idref" href="ConCert.Examples.Congress.Congress.html#actions"><span class="id" title="projection">actions</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#proposal:30"><span class="id" title="variable">proposal</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#num_cacts_in_state"><span class="id" title="definition">num_cacts_in_state</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#state:29"><span class="id" title="variable">state</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">find</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#num_cacts_in_state"><span class="id" title="definition">num_cacts_in_state</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<a class="idref" href="ConCert.Execution.Containers.html#FMap.add_id"><span class="id" title="lemma">FMap.add_id</span></a> <span class="id" title="var">pid</span> <span class="id" title="var">proposal</span> (<a class="idref" href="ConCert.Examples.Congress.Congress.html#proposals"><span class="id" title="projection">proposals</span></a> <span class="id" title="var">state</span>)) <span class="id" title="tactic">at</span> 1; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="ConCert.Execution.Containers.html#FMap.add_remove"><span class="id" title="lemma">FMap.add_remove</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.elements_add"><span class="id" title="lemma">FMap.elements_add</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;The&nbsp;next&nbsp;lemma&nbsp;shows&nbsp;that&nbsp;when&nbsp;we&nbsp;send&nbsp;out&nbsp;transactions,&nbsp;the<br/>
&nbsp;&nbsp;state&nbsp;change&nbsp;will&nbsp;make&nbsp;up&nbsp;for&nbsp;number&nbsp;of&nbsp;outgoing&nbsp;actions&nbsp;queued.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="receive_state_well_behaved" class="idref" href="#receive_state_well_behaved"><span class="id" title="lemma">receive_state_well_behaved</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="chain:31" class="idref" href="#chain:31"><span class="id" title="binder">chain</span></a> <a id="ctx:32" class="idref" href="#ctx:32"><span class="id" title="binder">ctx</span></a> <a id="state:33" class="idref" href="#state:33"><span class="id" title="binder">state</span></a> <a id="msg:34" class="idref" href="#msg:34"><span class="id" title="binder">msg</span></a> <a id="new_state:35" class="idref" href="#new_state:35"><span class="id" title="binder">new_state</span></a> <a id="resp_acts:36" class="idref" href="#resp_acts:36"><span class="id" title="binder">resp_acts</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Congress.Congress.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#chain:31"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#ctx:32"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#state:33"><span class="id" title="variable">state</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#msg:34"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#new_state:35"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#resp_acts:36"><span class="id" title="variable">resp_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#num_cacts_in_state"><span class="id" title="definition">num_cacts_in_state</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#new_state:35"><span class="id" title="variable">new_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#resp_acts:36"><span class="id" title="variable">resp_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">&lt;=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#num_cacts_in_state"><span class="id" title="definition">num_cacts_in_state</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#state:33"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#msg:34"><span class="id" title="variable">msg</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.Congress.Congress.html#create_proposal"><span class="id" title="constructor">create_proposal</span></a> <span class="id" title="var">ls</span>) =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> <span class="id" title="var">ls</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">receive</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span> <span class="id" title="keyword">as</span> [[]|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> -[<span class="id" title="var">vote_on_proposal</span> <span class="id" title="var">do_retract_vote</span> <span class="id" title="var">do_finish_proposal</span>] <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;transfer_ownership&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">receive</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;change_rules&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Examples.Congress.Congress.html#validate_rules"><span class="id" title="definition">validate_rules</span></a> <span class="id" title="var">r</span>); <span class="id" title="tactic">inversion</span> <span class="id" title="var">receive</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;add_member&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">inversion</span> <span class="id" title="var">receive</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;remove_member&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">inversion</span> <span class="id" title="var">receive</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;create_proposal&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.mem"><span class="id" title="definition">FMap.mem</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>); <span class="id" title="tactic">inversion</span> <span class="id" title="var">receive</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#plus_n_O"><span class="id" title="lemma">plus_n_O</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#add_proposal_cacts"><span class="id" title="lemma">add_proposal_cacts</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;vote_for_proposal&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.mem"><span class="id" title="definition">FMap.mem</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>); <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Examples.Congress.Congress.html#vote_on_proposal"><span class="id" title="definition">vote_on_proposal</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">vote</span>; <span class="id" title="var">cbn</span> -[<span class="id" title="var">vote_on_proposal</span>] <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">receive</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#vote_on_proposal_cacts_preserved"><span class="id" title="lemma">vote_on_proposal_cacts_preserved</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;vote_against_proposal&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.mem"><span class="id" title="definition">FMap.mem</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>); <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Examples.Congress.Congress.html#vote_on_proposal"><span class="id" title="definition">vote_on_proposal</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">vote</span>; <span class="id" title="var">cbn</span> -[<span class="id" title="var">vote_on_proposal</span>] <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">receive</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#vote_on_proposal_cacts_preserved"><span class="id" title="lemma">vote_on_proposal_cacts_preserved</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;retract_vote&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.mem"><span class="id" title="definition">FMap.mem</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>); <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Examples.Congress.Congress.html#do_retract_vote"><span class="id" title="definition">do_retract_vote</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">retract</span>; <span class="id" title="var">cbn</span> -[<span class="id" title="var">do_retract_vote</span>] <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">receive</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#do_retract_vote_cacts_preserved"><span class="id" title="lemma">do_retract_vote_cacts_preserved</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;finish_proposal&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.Congress.Congress.html#do_finish_proposal"><span class="id" title="definition">do_finish_proposal</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">found</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="keyword">if</span> ?<span class="id" title="var">a</span> <span class="id" title="keyword">then</span> <span class="id" title="var">_</span> <span class="id" title="keyword">else</span> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">receive</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#remove_proposal_cacts"><span class="id" title="lemma">remove_proposal_cacts</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">found</span>), <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Examples.Congress.Congress.html#proposal_passed"><span class="id" title="definition">proposal_passed</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;I&nbsp;wonder&nbsp;why&nbsp;these&nbsp;asserts&nbsp;are&nbsp;necessary...&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="keyword">forall</span> <a id="a:40" class="idref" href="#a:40"><span class="id" title="binder">a</span></a> <a id="b:41" class="idref" href="#b:41"><span class="id" title="binder">b</span></a>, <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#a:38"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#b:39"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#a:38"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#b:39"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> 0) <span class="id" title="tactic">by</span> (<span class="id" title="tactic">intros</span>; <span class="id" title="var">lia</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">assert</span> (<span class="id" title="keyword">forall</span> <a id="a:44" class="idref" href="#a:44"><span class="id" title="binder">a</span></a> <a id="b:45" class="idref" href="#b:45"><span class="id" title="binder">b</span></a>, <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#a:42"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#a:42"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#b:43"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> 0) <span class="id" title="tactic">by</span> (<span class="id" title="tactic">intros</span>; <span class="id" title="var">lia</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">receive</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a id="congress_correct" class="idref" href="#congress_correct"><span class="id" title="lemma">congress_correct</span></a> <a id="bstate:46" class="idref" href="#bstate:46"><span class="id" title="binder">bstate</span></a> <a id="caddr:47" class="idref" href="#caddr:47"><span class="id" title="binder">caddr</span></a> (<a id="trace:48" class="idref" href="#trace:48"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#bstate:46"><span class="id" title="variable">bstate</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#bstate:46"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#caddr:47"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.Congress.Congress.html#contract"><span class="id" title="definition">Congress.contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">(</span></a><a id="cstate:49" class="idref" href="#cstate:49"><span class="id" title="binder">cstate</span></a> : <a class="idref" href="ConCert.Examples.Congress.Congress.html#State"><span class="id" title="record">Congress.State</span></a>) (<a id="inc_calls:50" class="idref" href="#inc_calls:50"><span class="id" title="binder">inc_calls</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallInfo"><span class="id" title="record">ContractCallInfo</span></a> <a class="idref" href="ConCert.Examples.Congress.Congress.html#Msg"><span class="id" title="inductive">Congress.Msg</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#bstate:46"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#caddr:47"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#cstate:49"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a> <a class="idref" href="ConCert.Examples.Congress.Congress.html#Msg"><span class="id" title="inductive">Msg</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#trace:48"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#caddr:47"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#inc_calls:50"><span class="id" title="variable">inc_calls</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#num_cacts_in_state"><span class="id" title="definition">num_cacts_in_state</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#cstate:49"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#trace:48"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#caddr:47"><span class="id" title="variable">caddr</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#bstate:46"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#caddr:47"><span class="id" title="variable">caddr</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">&lt;=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#num_acts_created_in_proposals"><span class="id" title="definition">num_acts_created_in_proposals</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#inc_calls:50"><span class="id" title="variable">inc_calls</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_induction</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">erewrite</span> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#num_cacts_in_state_deployment"><span class="id" title="lemma">num_cacts_in_state_deployment</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#receive_state_well_behaved"><span class="id" title="lemma">receive_state_well_behaved</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">receive_some</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">fcorrect</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fold</span> (<a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#num_acts_created_in_proposals"><span class="id" title="definition">num_acts_created_in_proposals</span></a> <span class="id" title="var">prev_inc_calls</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#receive_state_well_behaved"><span class="id" title="lemma">receive_state_well_behaved</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">receive_some</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">fcorrect</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fold</span> (<a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#num_acts_created_in_proposals"><span class="id" title="definition">num_acts_created_in_proposals</span></a> <span class="id" title="var">prev_inc_calls</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">perm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">solve_facts</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a id="congress_correct_after_block" class="idref" href="#congress_correct_after_block"><span class="id" title="lemma">congress_correct_after_block</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="ChainBuilder:51" class="idref" href="#ChainBuilder:51"><span class="id" title="binder">ChainBuilder</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainBuilderType"><span class="id" title="class">ChainBuilderType</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="prev:52" class="idref" href="#prev:52"><span class="id" title="binder">prev</span></a> <a id="new:53" class="idref" href="#new:53"><span class="id" title="binder">new</span></a> <a id="header:54" class="idref" href="#header:54"><span class="id" title="binder">header</span></a> <a id="acts:55" class="idref" href="#acts:55"><span class="id" title="binder">acts</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#builder_add_block"><span class="id" title="method">builder_add_block</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#prev:52"><span class="id" title="variable">prev</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#header:54"><span class="id" title="variable">header</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#acts:55"><span class="id" title="variable">acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#new:53"><span class="id" title="variable">new</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="caddr:56" class="idref" href="#caddr:56"><span class="id" title="binder">caddr</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#new:53"><span class="id" title="variable">new</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#caddr:56"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.Congress.Congress.html#contract"><span class="id" title="definition">Congress.contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="inc_calls:57" class="idref" href="#inc_calls:57"><span class="id" title="binder">inc_calls</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a> <a class="idref" href="ConCert.Examples.Congress.Congress.html#Msg"><span class="id" title="inductive">Msg</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#builder_trace"><span class="id" title="method">builder_trace</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#new:53"><span class="id" title="variable">new</span></a>) <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#caddr:56"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#inc_calls:57"><span class="id" title="variable">inc_calls</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#builder_trace"><span class="id" title="method">builder_trace</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#new:53"><span class="id" title="variable">new</span></a>) <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#caddr:56"><span class="id" title="variable">caddr</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">&lt;=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#num_acts_created_in_proposals"><span class="id" title="definition">num_acts_created_in_proposals</span></a> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#inc_calls:57"><span class="id" title="variable">inc_calls</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">add_block</span> <span class="id" title="var">contract</span> <span class="id" title="var">congress_at_addr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#congress_correct"><span class="id" title="lemma">congress_correct</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#builder_trace"><span class="id" title="method">builder_trace</span></a> <span class="id" title="var">new</span>) <span class="id" title="var">congress_at_addr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> <span class="id" title="var">general</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">general</span> <span class="id" title="keyword">as</span> [? [<span class="id" title="var">inc_calls</span> [? [? ?]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">inc_calls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Examples.Congress.CongressCorrect.html#Theories"><span class="id" title="section">Theories</span></a>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="https://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a> and <a href="https://github.com/jgallen23/toc">TOC</a>
</div>
</div>
<script>
  const elements = document.getElementsByClassName("libtitle");
  while(elements.length > 0){
        elements[0].parentNode.removeChild(elements[0]);
  }
  if (window.location.pathname.endsWith("/toc.html")) {
      const jstocDiv = document.getElementById("js-toc");
      jstocDiv.classList.remove("toc");
      jstocDiv.classList.add("jstoc-hidden");
      const jstocHeaderDiv = document.getElementById("js-toc-header");
      jstocHeaderDiv.classList.add("jstoc-hidden");
      const mainDiv = document.getElementById("main");
      mainDiv.classList.add("jstoc-hidden-main");
      const toggleDiv = document.getElementById("toggle-toc");
      toggleDiv.classList.add("jstoc-hidden");
  }
  console.log(window.location.pathname);
</script>
<script type="text/javascript" src="toc.js"></script>
</body>

</html>
