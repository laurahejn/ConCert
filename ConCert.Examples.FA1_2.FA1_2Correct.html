<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<link href="toc.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
      <span id="toggle-toc">Contents</span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="https://github.com/AU-COBRA/ConCert" target="_balnk">Project Page</a>
      <a href="index.html">Index</a>
      <a href="toc.html">Table of contents</a>
    </span>
</div>
  <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="js-toc" class="toc" data-toc="h1,h2,h3,h4" data-toc-container="doc" data-toc-offset="-40">
      <div id="js-toc-header" class="toc-header">Contents:</div>
    </div>
    <div id="main">
<h1 class="libtitle">Library ConCert.Examples.FA1_2.FA1_2Correct</h1>

<div class="code">
</div>

<div class="doc">
<a id="lab53"></a><h1 class="section">FA1.2 token contract</h1>
 A basic FA1.2 implementation inspired by the Dexter2 liquidity token FA1.2
    token implementation but with minting and burning removed. 
</div>
<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Utils.Automation.html#"><span class="id" title="library">Automation</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Utils.Extras.html#"><span class="id" title="library">Extras</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Blockchain.html#"><span class="id" title="library">Blockchain</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Containers.html#"><span class="id" title="library">Containers</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Serializable.html#"><span class="id" title="library">Serializable</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.ContractCommon.html#"><span class="id" title="library">ContractCommon</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.ResultMonad.html#"><span class="id" title="library">ResultMonad</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Examples.FA1_2</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#"><span class="id" title="library">FA1_2</span></a>. <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance"><span class="id" title="module">FA12Instance</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.ZArith_base.html#"><span class="id" title="library">ZArith_base</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Bool.Bool.html#"><span class="id" title="library">Bool</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#"><span class="id" title="library">List</span></a>. <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ListNotations"><span class="id" title="module">ListNotations</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.micromega.Lia.html#"><span class="id" title="library">Lia</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab54"></a><h1 class="section">Properties</h1>

</div>
<div class="code">
<span class="id" title="keyword">Section</span> <a id="Theories" class="idref" href="#Theories"><span class="id" title="section">Theories</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:1" class="idref" href="#H:1"><span class="id" title="binder">ChainBase</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">N_scope</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
<a id="lab55"></a><h2 class="section">Contract rejects money</h2>
 <span class="inlinecode"><a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">receive</span></a></span> only returns Some if the sender amount is zero 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="contract_not_payable" class="idref" href="#contract_not_payable"><span class="id" title="lemma">contract_not_payable</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:2" class="idref" href="#prev_state:2"><span class="id" title="binder">prev_state</span></a> <a id="new_state:3" class="idref" href="#new_state:3"><span class="id" title="binder">new_state</span></a> <a id="chain:4" class="idref" href="#chain:4"><span class="id" title="binder">chain</span></a> <a id="ctx:5" class="idref" href="#ctx:5"><span class="id" title="binder">ctx</span></a> <a id="msg:6" class="idref" href="#msg:6"><span class="id" title="binder">msg</span></a> <a id="new_acts:7" class="idref" href="#new_acts:7"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:4"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:5"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:2"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#msg:6"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:3"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:7"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:5"><span class="id" title="variable">ctx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> 0)%<span class="id" title="var">Z</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.receive"><span class="id" title="definition">receive</span></a>, <a class="idref" href="ConCert.Execution.ContractCommon.html#throwIf"><span class="id" title="definition">throwIf</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#f1746f02f141d025b1e53605943919bf"><span class="id" title="notation">&lt;?</span></a> <span class="id" title="var">_</span>)%<span class="id" title="var">Z</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">amount</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;case:&nbsp;ctx_amount&nbsp;&gt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;case:&nbsp;ctx_amount&nbsp;&lt;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.ltb_ge"><span class="id" title="lemma">Z.ltb_ge</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">amount</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="contract_not_payable'" class="idref" href="#contract_not_payable'"><span class="id" title="lemma">contract_not_payable'</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:8" class="idref" href="#prev_state:8"><span class="id" title="binder">prev_state</span></a> <a id="chain:9" class="idref" href="#chain:9"><span class="id" title="binder">chain</span></a> <a id="ctx:10" class="idref" href="#ctx:10"><span class="id" title="binder">ctx</span></a> <a id="msg:11" class="idref" href="#msg:11"><span class="id" title="binder">msg</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'&lt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:10"><span class="id" title="variable">ctx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'&lt;'_x"><span class="id" title="notation">)</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:9"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:10"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:8"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#msg:11"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Err"><span class="id" title="constructor">Err</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#default_error"><span class="id" title="definition">default_error</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">ctx_amount_positive</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.receive"><span class="id" title="definition">receive</span></a>,<a class="idref" href="ConCert.Execution.ContractCommon.html#throwIf"><span class="id" title="definition">throwIf</span></a>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#f1746f02f141d025b1e53605943919bf"><span class="id" title="notation">&lt;?</span></a> <span class="id" title="var">_</span>)%<span class="id" title="var">Z</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">amount</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;case:&nbsp;ctx_amount&nbsp;&gt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;case:&nbsp;ctx_amount&nbsp;&lt;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.ltb_ge"><span class="id" title="lemma">Z.ltb_ge</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">amount</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
<a id="lab56"></a><h2 class="section">Default entrypoint correct</h2>

</div>
<div class="code">
&nbsp;&nbsp;<span class="comment">(*&nbsp;Default&nbsp;entrypoint&nbsp;should&nbsp;never&nbsp;succeed&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="default_entrypoint_none" class="idref" href="#default_entrypoint_none"><span class="id" title="lemma">default_entrypoint_none</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:12" class="idref" href="#prev_state:12"><span class="id" title="binder">prev_state</span></a> <a id="chain:13" class="idref" href="#chain:13"><span class="id" title="binder">chain</span></a> <a id="ctx:14" class="idref" href="#ctx:14"><span class="id" title="binder">ctx</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:13"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:14"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:12"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Err"><span class="id" title="constructor">Err</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#default_error"><span class="id" title="definition">default_error</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">e</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_throw_if</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab57"></a><h2 class="section">Transfer correct</h2>

</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="transfer_balance_update_correct" class="idref" href="#transfer_balance_update_correct"><span class="id" title="definition">transfer_balance_update_correct</span></a> <a id="old_state:15" class="idref" href="#old_state:15"><span class="id" title="binder">old_state</span></a> <a id="new_state:16" class="idref" href="#new_state:16"><span class="id" title="binder">new_state</span></a> <a id="from:17" class="idref" href="#from:17"><span class="id" title="binder">from</span></a> <a id="to:18" class="idref" href="#to:18"><span class="id" title="binder">to</span></a> <a id="amount:19" class="idref" href="#amount:19"><span class="id" title="binder">amount</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="get_balance:22" class="idref" href="#get_balance:22"><span class="id" title="binder">get_balance</span></a> <a id="addr:20" class="idref" href="#addr:20"><span class="id" title="binder">addr</span></a> <a id="state:21" class="idref" href="#state:21"><span class="id" title="binder">state</span></a> := <a class="idref" href="ConCert.Utils.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#addr:20"><span class="id" title="variable">addr</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#state:21"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#tokens"><span class="id" title="projection">tokens</span></a>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="from_balance_before:23" class="idref" href="#from_balance_before:23"><span class="id" title="binder">from_balance_before</span></a> := <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#get_balance:22"><span class="id" title="variable">get_balance</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#from:17"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#old_state:15"><span class="id" title="variable">old_state</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="to_balance_before:24" class="idref" href="#to_balance_before:24"><span class="id" title="binder">to_balance_before</span></a> := <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#get_balance:22"><span class="id" title="variable">get_balance</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#to:18"><span class="id" title="variable">to</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#old_state:15"><span class="id" title="variable">old_state</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="from_balance_after:25" class="idref" href="#from_balance_after:25"><span class="id" title="binder">from_balance_after</span></a> := <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#get_balance:22"><span class="id" title="variable">get_balance</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#from:17"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:16"><span class="id" title="variable">new_state</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="to_balance_after:26" class="idref" href="#to_balance_after:26"><span class="id" title="binder">to_balance_after</span></a> := <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#get_balance:22"><span class="id" title="variable">get_balance</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#to:18"><span class="id" title="variable">to</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:16"><span class="id" title="variable">new_state</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;If&nbsp;the&nbsp;transfer&nbsp;is&nbsp;a&nbsp;self-transfer,&nbsp;balances&nbsp;should&nbsp;remain&nbsp;unchained&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#from:17"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#to:18"><span class="id" title="variable">to</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#from_balance_before:23"><span class="id" title="variable">from_balance_before</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#59a5ff4a6cbb127625aba1a377a243d1"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#from_balance_after:25"><span class="id" title="variable">from_balance_after</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#to_balance_before:24"><span class="id" title="variable">to_balance_before</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#59a5ff4a6cbb127625aba1a377a243d1"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#to_balance_after:26"><span class="id" title="variable">to_balance_after</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#from_balance_before:23"><span class="id" title="variable">from_balance_before</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#59a5ff4a6cbb127625aba1a377a243d1"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#from_balance_after:25"><span class="id" title="variable">from_balance_after</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#amount:19"><span class="id" title="variable">amount</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#to_balance_before:24"><span class="id" title="variable">to_balance_before</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#amount:19"><span class="id" title="variable">amount</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#59a5ff4a6cbb127625aba1a377a243d1"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#to_balance_after:26"><span class="id" title="variable">to_balance_after</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">)</span></a>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#try_transfer"><span class="id" title="definition">try_transfer</span></a></span> correctly moves <span class="inlinecode"><a class="idref" href="ConCert.Examples.FA2.FA2Interface.html#amount"><span class="id" title="projection">amount</span></a></span> from <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a></span> to <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#to"><span class="id" title="projection">to</span></a></span> 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_transfer_balance_correct" class="idref" href="#try_transfer_balance_correct"><span class="id" title="lemma">try_transfer_balance_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:27" class="idref" href="#prev_state:27"><span class="id" title="binder">prev_state</span></a> <a id="new_state:28" class="idref" href="#new_state:28"><span class="id" title="binder">new_state</span></a> <a id="chain:29" class="idref" href="#chain:29"><span class="id" title="binder">chain</span></a> <a id="ctx:30" class="idref" href="#ctx:30"><span class="id" title="binder">ctx</span></a> <a id="new_acts:31" class="idref" href="#new_acts:31"><span class="id" title="binder">new_acts</span></a> <a id="param:32" class="idref" href="#param:32"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:29"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:30"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:27"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#transfer"><span class="id" title="constructor">transfer</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:32"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:28"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:31"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#transfer_balance_update_correct"><span class="id" title="definition">transfer_balance_update_correct</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:27"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:28"><span class="id" title="variable">new_state</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:32"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#from"><span class="id" title="projection">from</span></a>) <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:32"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#to"><span class="id" title="projection">to</span></a>) <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:32"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#value"><span class="id" title="projection">value</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" title="var">H</span> : <a class="idref" href="ConCert.Utils.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#b39870dee55afcd85c6b795fb34de165"><span class="id" title="notation">&lt;?</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">rename</span> <span class="id" title="var">H</span> <span class="id" title="var">into</span> <span class="id" title="var">enough_balance</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.ltb_ge"><span class="id" title="lemma">N.ltb_ge</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">enough_balance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#transfer_balance_update_correct"><span class="id" title="definition">transfer_balance_update_correct</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">from_to_eqb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;from&nbsp;=&nbsp;to&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">param</span>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#from"><span class="id" title="projection">from</span></a>) <span class="id" title="var">param</span>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#to"><span class="id" title="projection">to</span></a>)) <span class="id" title="keyword">as</span> [&lt;-|]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Execution.Containers.html#FMap.map_update_idemp"><span class="id" title="lemma">FMap.map_update_idemp</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_eq"><span class="id" title="lemma">FMap.find_update_eq</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">map</span> := <span class="id" title="var">prev_state</span>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#tokens"><span class="id" title="projection">tokens</span></a>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#from"><span class="id" title="projection">from</span></a> <span class="id" title="var">param</span>) <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">from_prev</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.ContractCommon.html#maybe_sub_add"><span class="id" title="lemma">maybe_sub_add</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">enough_balance</span> <span class="id" title="keyword">as</span> [[-&gt; -&gt;] | -&gt;]; <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.eqb_refl"><span class="id" title="lemma">N.eqb_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.add_0_l"><span class="id" title="lemma">N.add_0_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.le_0_r"><span class="id" title="lemma">N.le_0_r</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">enough_balance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">enough_balance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;from&nbsp;&lt;&gt;&nbsp;to&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">param</span>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#from"><span class="id" title="projection">from</span></a>) <span class="id" title="var">param</span>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#to"><span class="id" title="projection">to</span></a>)) <span class="id" title="keyword">as</span> [| <span class="id" title="var">from_to_eq</span>]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_ne"><span class="id" title="lemma">FMap.find_update_ne</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">map</span> := <span class="id" title="var">prev_state</span>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#tokens"><span class="id" title="projection">tokens</span></a>)) <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_ne"><span class="id" title="lemma">FMap.find_update_ne</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_eq"><span class="id" title="lemma">FMap.find_update_eq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#from"><span class="id" title="projection">from</span></a> <span class="id" title="var">param</span>) <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">from_prev</span>; <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[| <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.le_0_r"><span class="id" title="lemma">N.le_0_r</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">enough_balance</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">enough_balance</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#to"><span class="id" title="projection">to</span></a> <span class="id" title="var">param</span>) <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">to_prev</span>; <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ?<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.add_0_l"><span class="id" title="lemma">N.add_0_l</span></a>, ?<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.add_0_r"><span class="id" title="lemma">N.add_0_r</span></a>, ?<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.sub_add"><span class="id" title="lemma">N.sub_add</span></a>, ?<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.eqb_refl"><span class="id" title="lemma">N.eqb_refl</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Bool.Bool.html#andb_true_iff"><span class="id" title="lemma">andb_true_iff</span></a>, ?<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.eqb_eq"><span class="id" title="lemma">N.eqb_eq</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">enough_balance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.ContractCommon.html#maybe_cases"><span class="id" title="lemma">maybe_cases</span></a> (<span class="id" title="var">n</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#value"><span class="id" title="projection">value</span></a> <span class="id" title="var">param</span>)) <span class="id" title="keyword">as</span> [[-&gt; ?<span class="id" title="var">H</span>] | [-&gt; <span class="id" title="var">_</span>]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.ContractCommon.html#maybe_cases"><span class="id" title="lemma">maybe_cases</span></a> (<span class="id" title="var">n0</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#value"><span class="id" title="projection">value</span></a> <span class="id" title="var">param</span>)) <span class="id" title="keyword">as</span> [[-&gt; ?<span class="id" title="var">H</span>] | [-&gt; <span class="id" title="var">_</span>]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.ContractCommon.html#maybe_cases"><span class="id" title="lemma">maybe_cases</span></a> (<span class="id" title="var">n</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#value"><span class="id" title="projection">value</span></a> <span class="id" title="var">param</span>)) <span class="id" title="keyword">as</span> [[-&gt; ?<span class="id" title="var">H</span>] | [-&gt; <span class="id" title="var">_</span>]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.ContractCommon.html#maybe_cases"><span class="id" title="lemma">maybe_cases</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#value"><span class="id" title="projection">value</span></a> <span class="id" title="var">param</span>)) <span class="id" title="keyword">as</span> [[-&gt; ?<span class="id" title="var">H</span>] | [-&gt; <span class="id" title="var">_</span>]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.ContractCommon.html#maybe_cases"><span class="id" title="lemma">maybe_cases</span></a> <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> [[-&gt; ?<span class="id" title="var">H</span>] | [-&gt; <span class="id" title="var">_</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="transfer_allowances_update_correct" class="idref" href="#transfer_allowances_update_correct"><span class="id" title="definition">transfer_allowances_update_correct</span></a> <a id="old_state:33" class="idref" href="#old_state:33"><span class="id" title="binder">old_state</span></a> <a id="new_state:34" class="idref" href="#new_state:34"><span class="id" title="binder">new_state</span></a> <a id="sender:35" class="idref" href="#sender:35"><span class="id" title="binder">sender</span></a> <a id="from:36" class="idref" href="#from:36"><span class="id" title="binder">from</span></a> <a id="amount:37" class="idref" href="#amount:37"><span class="id" title="binder">amount</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="get_allowance:41" class="idref" href="#get_allowance:41"><span class="id" title="binder">get_allowance</span></a> <a id="addr1:38" class="idref" href="#addr1:38"><span class="id" title="binder">addr1</span></a> <a id="addr2:39" class="idref" href="#addr2:39"><span class="id" title="binder">addr2</span></a> <a id="state:40" class="idref" href="#state:40"><span class="id" title="binder">state</span></a> := <a class="idref" href="ConCert.Utils.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#addr1:38"><span class="id" title="variable">addr1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#addr2:39"><span class="id" title="variable">addr2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#state:40"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowances"><span class="id" title="projection">allowances</span></a>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="allowance_before:42" class="idref" href="#allowance_before:42"><span class="id" title="binder">allowance_before</span></a> := <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#get_allowance:41"><span class="id" title="variable">get_allowance</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#from:36"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#sender:35"><span class="id" title="variable">sender</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#old_state:33"><span class="id" title="variable">old_state</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="allowance_after:43" class="idref" href="#allowance_after:43"><span class="id" title="binder">allowance_after</span></a> := <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#get_allowance:41"><span class="id" title="variable">get_allowance</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#from:36"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#sender:35"><span class="id" title="variable">sender</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:34"><span class="id" title="variable">new_state</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;If&nbsp;the&nbsp;from&nbsp;and&nbsp;sender&nbsp;is&nbsp;equal,&nbsp;allowances&nbsp;should&nbsp;remain&nbsp;unchained&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#sender:35"><span class="id" title="variable">sender</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#from:36"><span class="id" title="variable">from</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#allowance_before:42"><span class="id" title="variable">allowance_before</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#59a5ff4a6cbb127625aba1a377a243d1"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#allowance_after:43"><span class="id" title="variable">allowance_after</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#allowance_before:42"><span class="id" title="variable">allowance_before</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#59a5ff4a6cbb127625aba1a377a243d1"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#allowance_after:43"><span class="id" title="variable">allowance_after</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#amount:37"><span class="id" title="variable">amount</span></a>).<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#try_transfer"><span class="id" title="definition">try_transfer</span></a></span> correctly subtracts <span class="inlinecode"><a class="idref" href="ConCert.Examples.FA2.FA2Interface.html#amount"><span class="id" title="projection">amount</span></a></span> from allowances if <span class="inlinecode"><a class="idref" href="ConCert.Examples.Crowdfunding.CrowdfundingDataExt.html#sender"><span class="id" title="definition">sender</span></a></span> is not <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a></span> 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_transfer_allowance_correct" class="idref" href="#try_transfer_allowance_correct"><span class="id" title="lemma">try_transfer_allowance_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:44" class="idref" href="#prev_state:44"><span class="id" title="binder">prev_state</span></a> <a id="new_state:45" class="idref" href="#new_state:45"><span class="id" title="binder">new_state</span></a> <a id="chain:46" class="idref" href="#chain:46"><span class="id" title="binder">chain</span></a> <a id="ctx:47" class="idref" href="#ctx:47"><span class="id" title="binder">ctx</span></a> <a id="new_acts:48" class="idref" href="#new_acts:48"><span class="id" title="binder">new_acts</span></a> <a id="param:49" class="idref" href="#param:49"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:46"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:47"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:44"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#transfer"><span class="id" title="constructor">transfer</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:49"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:45"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:48"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#transfer_allowances_update_correct"><span class="id" title="definition">transfer_allowances_update_correct</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:44"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:45"><span class="id" title="variable">new_state</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:47"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>) <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:49"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#from"><span class="id" title="projection">from</span></a>) <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:49"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#value"><span class="id" title="projection">value</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#transfer_allowances_update_correct"><span class="id" title="definition">transfer_allowances_update_correct</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">sender_from_eqb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;sender&nbsp;=&nbsp;from&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" title="var">H</span> : <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowances"><span class="id" title="projection">allowances</span></a> <span class="id" title="var">_</span>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">rename</span> <span class="id" title="var">H</span> <span class="id" title="var">into</span> <span class="id" title="var">allowances_eq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">allowances_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.eqb_refl"><span class="id" title="lemma">N.eqb_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;sender&nbsp;&lt;&gt;&nbsp;from&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" title="var">H</span> : <a class="idref" href="ConCert.Utils.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <span class="id" title="var">_</span> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowances"><span class="id" title="projection">allowances</span></a> <span class="id" title="var">_</span>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#b39870dee55afcd85c6b795fb34de165"><span class="id" title="notation">&lt;?</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">rename</span> <span class="id" title="var">H</span> <span class="id" title="var">into</span> <span class="id" title="var">enough_allowance</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.ltb_ge"><span class="id" title="lemma">N.ltb_ge</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">enough_allowance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_eq"><span class="id" title="lemma">FMap.find_update_eq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#from"><span class="id" title="projection">from</span></a> <span class="id" title="var">param</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <span class="id" title="var">ctx</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowances"><span class="id" title="projection">allowances</span></a> <span class="id" title="var">prev_state</span>)) <span class="id" title="var">eqn</span>:<span class="id" title="var">from_prev</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.ContractCommon.html#maybe"><span class="id" title="definition">maybe</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">n</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#value"><span class="id" title="projection">value</span></a> <span class="id" title="var">param</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#59a5ff4a6cbb127625aba1a377a243d1"><span class="id" title="notation">=?</span></a> 0) <span class="id" title="var">eqn</span>:<span class="id" title="var">n_eq_value</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.eqb_eq"><span class="id" title="lemma">N.eqb_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">n_eq_value</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.sub_0_le"><span class="id" title="lemma">N.sub_0_le</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">n_eq_value</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.le_antisymm"><span class="id" title="lemma">N.le_antisymm</span></a> <span class="id" title="var">n</span> <span class="id" title="var">_</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.eqb_refl"><span class="id" title="lemma">N.eqb_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.sub_add"><span class="id" title="lemma">N.sub_add</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.eqb_refl"><span class="id" title="lemma">N.eqb_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.le_0_r"><span class="id" title="lemma">N.le_0_r</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">enough_allowance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">enough_allowance</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#try_transfer"><span class="id" title="definition">try_transfer</span></a></span> does not produce any new actions 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_transfer_new_acts_correct" class="idref" href="#try_transfer_new_acts_correct"><span class="id" title="lemma">try_transfer_new_acts_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:50" class="idref" href="#prev_state:50"><span class="id" title="binder">prev_state</span></a> <a id="new_state:51" class="idref" href="#new_state:51"><span class="id" title="binder">new_state</span></a> <a id="chain:52" class="idref" href="#chain:52"><span class="id" title="binder">chain</span></a> <a id="ctx:53" class="idref" href="#ctx:53"><span class="id" title="binder">ctx</span></a> <a id="new_acts:54" class="idref" href="#new_acts:54"><span class="id" title="binder">new_acts</span></a> <a id="param:55" class="idref" href="#param:55"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:52"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:53"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:50"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#transfer"><span class="id" title="constructor">transfer</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:55"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:51"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:54"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:54"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#try_transfer"><span class="id" title="definition">try_transfer</span></a></span> does not change the total supply of tokens 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_transfer_preserves_total_supply" class="idref" href="#try_transfer_preserves_total_supply"><span class="id" title="lemma">try_transfer_preserves_total_supply</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:56" class="idref" href="#prev_state:56"><span class="id" title="binder">prev_state</span></a> <a id="new_state:57" class="idref" href="#new_state:57"><span class="id" title="binder">new_state</span></a> <a id="chain:58" class="idref" href="#chain:58"><span class="id" title="binder">chain</span></a> <a id="ctx:59" class="idref" href="#ctx:59"><span class="id" title="binder">ctx</span></a> <a id="new_acts:60" class="idref" href="#new_acts:60"><span class="id" title="binder">new_acts</span></a> <a id="param:61" class="idref" href="#param:61"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:58"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:59"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:56"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#transfer"><span class="id" title="constructor">transfer</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:61"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:57"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:60"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#total_supply"><span class="id" title="projection">total_supply</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:56"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#total_supply"><span class="id" title="projection">total_supply</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:57"><span class="id" title="variable">new_state</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#try_transfer"><span class="id" title="definition">try_transfer</span></a></span> only modifies the <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a></span> and <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#to"><span class="id" title="projection">to</span></a></span> balances 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_transfer_preserves_other_balances" class="idref" href="#try_transfer_preserves_other_balances"><span class="id" title="lemma">try_transfer_preserves_other_balances</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:62" class="idref" href="#prev_state:62"><span class="id" title="binder">prev_state</span></a> <a id="new_state:63" class="idref" href="#new_state:63"><span class="id" title="binder">new_state</span></a> <a id="chain:64" class="idref" href="#chain:64"><span class="id" title="binder">chain</span></a> <a id="ctx:65" class="idref" href="#ctx:65"><span class="id" title="binder">ctx</span></a> <a id="new_acts:66" class="idref" href="#new_acts:66"><span class="id" title="binder">new_acts</span></a> <a id="param:67" class="idref" href="#param:67"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:64"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:65"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:62"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#transfer"><span class="id" title="constructor">transfer</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:67"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:63"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:66"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="account:68" class="idref" href="#account:68"><span class="id" title="binder">account</span></a>, <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#account:68"><span class="id" title="variable">account</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:67"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#from"><span class="id" title="projection">from</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#account:68"><span class="id" title="variable">account</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:67"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#to"><span class="id" title="projection">to</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#account:68"><span class="id" title="variable">account</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:62"><span class="id" title="variable">prev_state</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#account:68"><span class="id" title="variable">account</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:63"><span class="id" title="variable">new_state</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span> <span class="id" title="var">account</span> <span class="id" title="var">account_not_from</span> <span class="id" title="var">account_not_to</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_ne"><span class="id" title="lemma">FMap.find_update_ne</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#try_transfer"><span class="id" title="definition">try_transfer</span></a></span> only modifies the <span class="inlinecode"><a class="idref" href="ConCert.Examples.Crowdfunding.CrowdfundingDataExt.html#sender"><span class="id" title="definition">sender</span></a></span> and <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a></span> allowances 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_transfer_preserves_other_allowances" class="idref" href="#try_transfer_preserves_other_allowances"><span class="id" title="lemma">try_transfer_preserves_other_allowances</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:69" class="idref" href="#prev_state:69"><span class="id" title="binder">prev_state</span></a> <a id="new_state:70" class="idref" href="#new_state:70"><span class="id" title="binder">new_state</span></a> <a id="chain:71" class="idref" href="#chain:71"><span class="id" title="binder">chain</span></a> <a id="ctx:72" class="idref" href="#ctx:72"><span class="id" title="binder">ctx</span></a> <a id="new_acts:73" class="idref" href="#new_acts:73"><span class="id" title="binder">new_acts</span></a> <a id="param:74" class="idref" href="#param:74"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:71"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:72"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:69"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#transfer"><span class="id" title="constructor">transfer</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:74"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:70"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:73"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="allowance_key:75" class="idref" href="#allowance_key:75"><span class="id" title="binder">allowance_key</span></a>, <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#allowance_key:75"><span class="id" title="variable">allowance_key</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:74"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#from"><span class="id" title="projection">from</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:72"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#allowance_key:75"><span class="id" title="variable">allowance_key</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:69"><span class="id" title="variable">prev_state</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#allowance_key:75"><span class="id" title="variable">allowance_key</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:70"><span class="id" title="variable">new_state</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span> <span class="id" title="var">account</span> <span class="id" title="var">allowance_key_ne</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" title="var">H</span> : <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">rename</span> <span class="id" title="var">H</span> <span class="id" title="var">into</span> <span class="id" title="var">allowance_eq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;from&nbsp;=&nbsp;sender&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">allowance_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;from&nbsp;&lt;&gt;&nbsp;sender&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="tactic">in</span> <span class="id" title="var">allowance_eq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">allowance_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_ne"><span class="id" title="lemma">FMap.find_update_ne</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#try_transfer"><span class="id" title="definition">try_transfer</span></a></span> removes empty entries from allowances map 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_transfer_remove_empty_allowances" class="idref" href="#try_transfer_remove_empty_allowances"><span class="id" title="lemma">try_transfer_remove_empty_allowances</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:76" class="idref" href="#prev_state:76"><span class="id" title="binder">prev_state</span></a> <a id="new_state:77" class="idref" href="#new_state:77"><span class="id" title="binder">new_state</span></a> <a id="chain:78" class="idref" href="#chain:78"><span class="id" title="binder">chain</span></a> <a id="ctx:79" class="idref" href="#ctx:79"><span class="id" title="binder">ctx</span></a> <a id="new_acts:80" class="idref" href="#new_acts:80"><span class="id" title="binder">new_acts</span></a> <a id="param:81" class="idref" href="#param:81"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <a id="n:82" class="idref" href="#n:82"><span class="id" title="binder">n</span></a>, <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:81"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#from"><span class="id" title="projection">from</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:79"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:76"><span class="id" title="variable">prev_state</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#n:82"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#n:82"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:78"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:79"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:76"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#transfer"><span class="id" title="constructor">transfer</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:81"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:77"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:80"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="n:83" class="idref" href="#n:83"><span class="id" title="binder">n</span></a>, <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:81"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#from"><span class="id" title="projection">from</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:79"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:77"><span class="id" title="variable">new_state</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#n:83"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#n:83"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">IH</span> <span class="id" title="var">receive_some</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_eq"><span class="id" title="lemma">FMap.find_update_eq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.ContractCommon.html#maybe_cases"><span class="id" title="lemma">maybe_cases</span></a> ) <span class="id" title="keyword">as</span> [[-&gt; ?<span class="id" title="var">H</span>] | [-&gt; ?<span class="id" title="var">H</span>]].<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#try_transfer"><span class="id" title="definition">try_transfer</span></a></span> removes empty entries from balance map 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_transfer_remove_empty_balances" class="idref" href="#try_transfer_remove_empty_balances"><span class="id" title="lemma">try_transfer_remove_empty_balances</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:84" class="idref" href="#prev_state:84"><span class="id" title="binder">prev_state</span></a> <a id="new_state:85" class="idref" href="#new_state:85"><span class="id" title="binder">new_state</span></a> <a id="chain:86" class="idref" href="#chain:86"><span class="id" title="binder">chain</span></a> <a id="ctx:87" class="idref" href="#ctx:87"><span class="id" title="binder">ctx</span></a> <a id="new_acts:88" class="idref" href="#new_acts:88"><span class="id" title="binder">new_acts</span></a> <a id="param:89" class="idref" href="#param:89"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:86"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:87"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:84"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#transfer"><span class="id" title="constructor">transfer</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:89"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:85"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:88"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="n:90" class="idref" href="#n:90"><span class="id" title="binder">n</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:89"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#from"><span class="id" title="projection">from</span></a>) (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:85"><span class="id" title="variable">new_state</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#n:90"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#n:90"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:89"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#to"><span class="id" title="projection">to</span></a>) (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:85"><span class="id" title="variable">new_state</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#n:90"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#n:90"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.ltb_ge"><span class="id" title="lemma">N.ltb_ge</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">param</span>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#from"><span class="id" title="projection">from</span></a>) <span class="id" title="var">param</span>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#to"><span class="id" title="projection">to</span></a>)) <span class="id" title="keyword">as</span> [&lt;-|]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_eq"><span class="id" title="lemma">FMap.find_update_eq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.ContractCommon.html#maybe_cases"><span class="id" title="lemma">maybe_cases</span></a> ) <span class="id" title="keyword">as</span> [[-&gt; ?<span class="id" title="var">H</span>] | [-&gt; ?<span class="id" title="var">H</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_ne"><span class="id" title="lemma">FMap.find_update_ne</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_eq"><span class="id" title="lemma">FMap.find_update_eq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_ne"><span class="id" title="lemma">FMap.find_update_ne</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">map</span> := <span class="id" title="var">prev_state</span>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#tokens"><span class="id" title="projection">tokens</span></a>)) <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.ContractCommon.html#maybe_cases"><span class="id" title="lemma">maybe_cases</span></a> ) <span class="id" title="keyword">as</span> [[-&gt; ?<span class="id" title="var">H</span>] | [-&gt; ?<span class="id" title="var">H</span>]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.ContractCommon.html#maybe_cases"><span class="id" title="lemma">maybe_cases</span></a> ) <span class="id" title="keyword">as</span> [[-&gt; ?<span class="id" title="var">H</span>] | [-&gt; ?<span class="id" title="var">H</span>]].<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If the requirements are met then then receive on transfer msg must succeed and
      if receive on transfer msg succeeds then requirements must hold 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_transfer_is_some" class="idref" href="#try_transfer_is_some"><span class="id" title="lemma">try_transfer_is_some</span></a> : <span class="id" title="keyword">forall</span> <a id="state:91" class="idref" href="#state:91"><span class="id" title="binder">state</span></a> <a id="chain:92" class="idref" href="#chain:92"><span class="id" title="binder">chain</span></a> <a id="ctx:93" class="idref" href="#ctx:93"><span class="id" title="binder">ctx</span></a> <a id="param:94" class="idref" href="#param:94"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:93"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> 0)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:94"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#value"><span class="id" title="projection">value</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#2ccca3280733654024e33c2005ae2530"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Utils.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:94"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#from"><span class="id" title="projection">from</span></a>) (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#state:91"><span class="id" title="variable">state</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:94"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#from"><span class="id" title="projection">from</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:93"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:94"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#value"><span class="id" title="projection">value</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#2ccca3280733654024e33c2005ae2530"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Utils.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:94"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#from"><span class="id" title="projection">from</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:93"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#state:91"><span class="id" title="variable">state</span></a>))<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="new_state:95" class="idref" href="#new_state:95"><span class="id" title="binder">new_state</span></a> <a id="new_acts:96" class="idref" href="#new_acts:96"><span class="id" title="binder">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:92"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:93"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#state:91"><span class="id" title="variable">state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#transfer"><span class="id" title="constructor">transfer</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:94"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:95"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:96"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> (<span class="id" title="var">amount_zero</span> &amp; <span class="id" title="var">enough_balance</span> &amp; <span class="id" title="var">enough_allowance</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.ltb_ge"><span class="id" title="lemma">Z.ltb_ge</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">amount_zero</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">amount_zero</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">receive_some</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">allowances_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">sender_from_eqb</span> <span class="id" title="tactic">in</span> <span class="id" title="var">allowances_eq</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">enough_allowance_check</span> <span class="id" title="tactic">in</span> <span class="id" title="var">allowances_eq</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">new_balance</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">enough_balance_check</span> <span class="id" title="tactic">in</span> <span class="id" title="var">new_balance</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;case&nbsp;no&nbsp;contradictions&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">allowances_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">allowances_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;enough&nbsp;balances&nbsp;contradiction&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.ltb_lt"><span class="id" title="lemma">N.ltb_lt</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">enough_balance_check</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.le_ngt"><span class="id" title="lemma">N.le_ngt</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">enough_balance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;enough&nbsp;balances&nbsp;contradiction&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.ltb_lt"><span class="id" title="lemma">N.ltb_lt</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">enough_balance_check</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.le_ngt"><span class="id" title="lemma">N.le_ngt</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">enough_balance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;enough&nbsp;allowance&nbsp;contradiction&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.ltb_lt"><span class="id" title="lemma">N.ltb_lt</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">enough_allowance_check</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">ctx</span>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>) <span class="id" title="var">param</span>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#from"><span class="id" title="projection">from</span></a>)) <span class="id" title="keyword">as</span> [| <span class="id" title="var">sender_from_ne</span>]; <span class="id" title="tactic">try</span> <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#not_eq_sym"><span class="id" title="lemma">not_eq_sym</span></a>, <span class="id" title="var">enough_allowance</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.le_ngt"><span class="id" title="lemma">N.le_ngt</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">sender_from_ne</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> (<span class="id" title="var">new_state</span> &amp; <span class="id" title="var">new_acts</span> &amp; <span class="id" title="var">receive_some</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.ltb_ge"><span class="id" title="lemma">Z.ltb_ge</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.ltb_ge"><span class="id" title="lemma">N.ltb_ge</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">sender_from_eqb</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">ctx</span>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>) <span class="id" title="var">param</span>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#from"><span class="id" title="projection">from</span></a>)) <span class="id" title="keyword">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">send_from_eq</span> | <span class="id" title="var">sender_from_ne</span>]; <span class="id" title="var">contract_simpl</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;sender&nbsp;=&nbsp;from&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;sender&nbsp;&lt;&gt;&nbsp;from&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">enough_allowance</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.ltb_ge"><span class="id" title="lemma">N.ltb_ge</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">enough_allowance</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab58"></a><h2 class="section">Approve correct</h2>
 <span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#try_approve"><span class="id" title="definition">try_approve</span></a></span> correctly sets allowance of <span class="inlinecode">(<a class="idref" href="ConCert.Examples.Crowdfunding.CrowdfundingDataExt.html#sender"><span class="id" title="definition">sender</span></a>,</span> <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#spender"><span class="id" title="projection">spender</span></a>)</span> to <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#value_"><span class="id" title="projection">value_</span></a></span> 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_approve_allowance_correct" class="idref" href="#try_approve_allowance_correct"><span class="id" title="lemma">try_approve_allowance_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:97" class="idref" href="#prev_state:97"><span class="id" title="binder">prev_state</span></a> <a id="new_state:98" class="idref" href="#new_state:98"><span class="id" title="binder">new_state</span></a> <a id="chain:99" class="idref" href="#chain:99"><span class="id" title="binder">chain</span></a> <a id="ctx:100" class="idref" href="#ctx:100"><span class="id" title="binder">ctx</span></a> <a id="new_acts:101" class="idref" href="#new_acts:101"><span class="id" title="binder">new_acts</span></a> <a id="param:102" class="idref" href="#param:102"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:99"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:100"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:97"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#approve"><span class="id" title="constructor">approve</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:102"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:98"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:101"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:100"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:102"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#spender"><span class="id" title="projection">spender</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:98"><span class="id" title="variable">new_state</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ContractCommon.html#maybe"><span class="id" title="definition">maybe</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:102"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#value_"><span class="id" title="projection">value_</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_eq"><span class="id" title="lemma">FMap.find_update_eq</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#try_approve"><span class="id" title="definition">try_approve</span></a></span> does not produce any new actions 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_approve_new_acts_correct" class="idref" href="#try_approve_new_acts_correct"><span class="id" title="lemma">try_approve_new_acts_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:103" class="idref" href="#prev_state:103"><span class="id" title="binder">prev_state</span></a> <a id="new_state:104" class="idref" href="#new_state:104"><span class="id" title="binder">new_state</span></a> <a id="chain:105" class="idref" href="#chain:105"><span class="id" title="binder">chain</span></a> <a id="ctx:106" class="idref" href="#ctx:106"><span class="id" title="binder">ctx</span></a> <a id="new_acts:107" class="idref" href="#new_acts:107"><span class="id" title="binder">new_acts</span></a> <a id="param:108" class="idref" href="#param:108"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:105"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:106"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:103"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#approve"><span class="id" title="constructor">approve</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:108"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:104"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:107"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:107"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#try_approve"><span class="id" title="definition">try_approve</span></a></span> does not change allowances map of other addresses 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_approve_preserves_other_allowances" class="idref" href="#try_approve_preserves_other_allowances"><span class="id" title="lemma">try_approve_preserves_other_allowances</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:109" class="idref" href="#prev_state:109"><span class="id" title="binder">prev_state</span></a> <a id="new_state:110" class="idref" href="#new_state:110"><span class="id" title="binder">new_state</span></a> <a id="chain:111" class="idref" href="#chain:111"><span class="id" title="binder">chain</span></a> <a id="ctx:112" class="idref" href="#ctx:112"><span class="id" title="binder">ctx</span></a> <a id="new_acts:113" class="idref" href="#new_acts:113"><span class="id" title="binder">new_acts</span></a> <a id="param:114" class="idref" href="#param:114"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:111"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:112"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:109"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#approve"><span class="id" title="constructor">approve</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:114"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:110"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:113"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="allowance_key:115" class="idref" href="#allowance_key:115"><span class="id" title="binder">allowance_key</span></a>, <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#allowance_key:115"><span class="id" title="variable">allowance_key</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:112"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:114"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#spender"><span class="id" title="projection">spender</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#allowance_key:115"><span class="id" title="variable">allowance_key</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:109"><span class="id" title="variable">prev_state</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#allowance_key:115"><span class="id" title="variable">allowance_key</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:110"><span class="id" title="variable">new_state</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span> <span class="id" title="var">allowance_key</span> <span class="id" title="var">allowance_key_ne</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_ne"><span class="id" title="lemma">FMap.find_update_ne</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#try_approve"><span class="id" title="definition">try_approve</span></a></span> does not change total supply of tokens 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_approve_preserves_total_supply" class="idref" href="#try_approve_preserves_total_supply"><span class="id" title="lemma">try_approve_preserves_total_supply</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:116" class="idref" href="#prev_state:116"><span class="id" title="binder">prev_state</span></a> <a id="new_state:117" class="idref" href="#new_state:117"><span class="id" title="binder">new_state</span></a> <a id="chain:118" class="idref" href="#chain:118"><span class="id" title="binder">chain</span></a> <a id="ctx:119" class="idref" href="#ctx:119"><span class="id" title="binder">ctx</span></a> <a id="new_acts:120" class="idref" href="#new_acts:120"><span class="id" title="binder">new_acts</span></a> <a id="param:121" class="idref" href="#param:121"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:118"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:119"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:116"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#approve"><span class="id" title="constructor">approve</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:121"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:117"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:120"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#total_supply"><span class="id" title="projection">total_supply</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:116"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#total_supply"><span class="id" title="projection">total_supply</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:117"><span class="id" title="variable">new_state</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#try_approve"><span class="id" title="definition">try_approve</span></a></span> does not change balances 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_approve_preserves_balances" class="idref" href="#try_approve_preserves_balances"><span class="id" title="lemma">try_approve_preserves_balances</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:122" class="idref" href="#prev_state:122"><span class="id" title="binder">prev_state</span></a> <a id="new_state:123" class="idref" href="#new_state:123"><span class="id" title="binder">new_state</span></a> <a id="chain:124" class="idref" href="#chain:124"><span class="id" title="binder">chain</span></a> <a id="ctx:125" class="idref" href="#ctx:125"><span class="id" title="binder">ctx</span></a> <a id="new_acts:126" class="idref" href="#new_acts:126"><span class="id" title="binder">new_acts</span></a> <a id="param:127" class="idref" href="#param:127"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:124"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:125"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:122"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#approve"><span class="id" title="constructor">approve</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:127"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:123"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:126"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:122"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:123"><span class="id" title="variable">new_state</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#try_approve"><span class="id" title="definition">try_approve</span></a></span> removes empty entries from allowances map 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_approve_remove_empty_allowances" class="idref" href="#try_approve_remove_empty_allowances"><span class="id" title="lemma">try_approve_remove_empty_allowances</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:128" class="idref" href="#prev_state:128"><span class="id" title="binder">prev_state</span></a> <a id="new_state:129" class="idref" href="#new_state:129"><span class="id" title="binder">new_state</span></a> <a id="chain:130" class="idref" href="#chain:130"><span class="id" title="binder">chain</span></a> <a id="ctx:131" class="idref" href="#ctx:131"><span class="id" title="binder">ctx</span></a> <a id="new_acts:132" class="idref" href="#new_acts:132"><span class="id" title="binder">new_acts</span></a> <a id="param:133" class="idref" href="#param:133"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:130"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:131"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:128"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#approve"><span class="id" title="constructor">approve</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:133"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:129"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:132"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="n:134" class="idref" href="#n:134"><span class="id" title="binder">n</span></a>, <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:131"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:133"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#spender"><span class="id" title="projection">spender</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:129"><span class="id" title="variable">new_state</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#n:134"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#n:134"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">IH</span> <span class="id" title="var">receive_some</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_eq"><span class="id" title="lemma">FMap.find_update_eq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.ContractCommon.html#maybe_cases"><span class="id" title="lemma">maybe_cases</span></a> ) <span class="id" title="keyword">as</span> [[-&gt; ?<span class="id" title="var">H</span>] | [-&gt; ?<span class="id" title="var">H</span>]].<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If the requirements are met then then receive on approve msg must succeed and
      if receive on approve msg succeeds then requirements must hold 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_approve_is_some" class="idref" href="#try_approve_is_some"><span class="id" title="lemma">try_approve_is_some</span></a> : <span class="id" title="keyword">forall</span> <a id="state:135" class="idref" href="#state:135"><span class="id" title="binder">state</span></a> <a id="chain:136" class="idref" href="#chain:136"><span class="id" title="binder">chain</span></a> <a id="ctx:137" class="idref" href="#ctx:137"><span class="id" title="binder">ctx</span></a> <a id="param:138" class="idref" href="#param:138"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:137"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> 0)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Utils.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:137"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:138"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#spender"><span class="id" title="projection">spender</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#state:135"><span class="id" title="variable">state</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">\/</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:138"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#value_"><span class="id" title="projection">value_</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="new_state:139" class="idref" href="#new_state:139"><span class="id" title="binder">new_state</span></a> <a id="new_acts:140" class="idref" href="#new_acts:140"><span class="id" title="binder">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:136"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:137"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#state:135"><span class="id" title="variable">state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#approve"><span class="id" title="constructor">approve</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:138"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:139"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:140"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_hyps</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">H4</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_throw_if</span> <span class="id" title="var">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab59"></a><h2 class="section">Get allowance correct</h2>
 <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#Dexter2Lqt.try_get_allowance"><span class="id" title="definition">try_get_allowance</span></a></span> produces a callback to the correct contract with
      the requested allowance, the call should carry no balance 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_get_allowance_new_acts_correct" class="idref" href="#try_get_allowance_new_acts_correct"><span class="id" title="lemma">try_get_allowance_new_acts_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:141" class="idref" href="#prev_state:141"><span class="id" title="binder">prev_state</span></a> <a id="new_state:142" class="idref" href="#new_state:142"><span class="id" title="binder">new_state</span></a> <a id="chain:143" class="idref" href="#chain:143"><span class="id" title="binder">chain</span></a> <a id="ctx:144" class="idref" href="#ctx:144"><span class="id" title="binder">ctx</span></a> <a id="new_acts:145" class="idref" href="#new_acts:145"><span class="id" title="binder">new_acts</span></a> <a id="param:146" class="idref" href="#param:146"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:143"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:144"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:141"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#getAllowance"><span class="id" title="constructor">getAllowance</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:146"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:142"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:145"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:145"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:146"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowance_callback"><span class="id" title="projection">allowance_callback</span></a>) 0%<span class="id" title="var">Z</span> (<a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#receive_allowance"><span class="id" title="constructor">receive_allowance</span></a> (<a class="idref" href="ConCert.Utils.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:146"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#request"><span class="id" title="projection">request</span></a>) (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:141"><span class="id" title="variable">prev_state</span></a>)))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#Dexter2Lqt.try_get_allowance"><span class="id" title="definition">try_get_allowance</span></a></span> does not modify state 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_get_allowance_preserves_state" class="idref" href="#try_get_allowance_preserves_state"><span class="id" title="lemma">try_get_allowance_preserves_state</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:147" class="idref" href="#prev_state:147"><span class="id" title="binder">prev_state</span></a> <a id="new_state:148" class="idref" href="#new_state:148"><span class="id" title="binder">new_state</span></a> <a id="chain:149" class="idref" href="#chain:149"><span class="id" title="binder">chain</span></a> <a id="ctx:150" class="idref" href="#ctx:150"><span class="id" title="binder">ctx</span></a> <a id="new_acts:151" class="idref" href="#new_acts:151"><span class="id" title="binder">new_acts</span></a> <a id="param:152" class="idref" href="#param:152"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:149"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:150"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:147"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#getAllowance"><span class="id" title="constructor">getAllowance</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:152"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:148"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:151"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:147"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:148"><span class="id" title="variable">new_state</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If the requirements are met then then receive on get_allowance msg must succeed and
      if receive on get_allowance msg succeeds then requirements must hold 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_get_allowance_is_some" class="idref" href="#try_get_allowance_is_some"><span class="id" title="lemma">try_get_allowance_is_some</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:153" class="idref" href="#prev_state:153"><span class="id" title="binder">prev_state</span></a> <a id="chain:154" class="idref" href="#chain:154"><span class="id" title="binder">chain</span></a> <a id="ctx:155" class="idref" href="#ctx:155"><span class="id" title="binder">ctx</span></a> <a id="param:156" class="idref" href="#param:156"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:155"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> 0)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="new_state:157" class="idref" href="#new_state:157"><span class="id" title="binder">new_state</span></a> <a id="new_acts:158" class="idref" href="#new_acts:158"><span class="id" title="binder">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:154"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:155"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:153"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#getAllowance"><span class="id" title="constructor">getAllowance</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:156"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:157"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:158"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_hyps</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab60"></a><h2 class="section">Get balance correct</h2>
 <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#Dexter2Lqt.try_get_balance"><span class="id" title="definition">try_get_balance</span></a></span> produces a callback to the correct contract with
      the requested balance, the call should carry no balance 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_get_balance_new_acts_correct" class="idref" href="#try_get_balance_new_acts_correct"><span class="id" title="lemma">try_get_balance_new_acts_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:159" class="idref" href="#prev_state:159"><span class="id" title="binder">prev_state</span></a> <a id="new_state:160" class="idref" href="#new_state:160"><span class="id" title="binder">new_state</span></a> <a id="chain:161" class="idref" href="#chain:161"><span class="id" title="binder">chain</span></a> <a id="ctx:162" class="idref" href="#ctx:162"><span class="id" title="binder">ctx</span></a> <a id="new_acts:163" class="idref" href="#new_acts:163"><span class="id" title="binder">new_acts</span></a> <a id="param:164" class="idref" href="#param:164"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:161"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:162"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:159"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#getBalance"><span class="id" title="constructor">getBalance</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:164"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:160"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:163"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:163"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:164"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#balance_callback"><span class="id" title="projection">balance_callback</span></a>) 0%<span class="id" title="var">Z</span> (<a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#receive_balance_of"><span class="id" title="constructor">receive_balance_of</span></a> (<a class="idref" href="ConCert.Utils.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:164"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#owner_"><span class="id" title="projection">owner_</span></a>) (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:159"><span class="id" title="variable">prev_state</span></a>)))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#Dexter2Lqt.try_get_balance"><span class="id" title="definition">try_get_balance</span></a></span> does not modify state 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_get_balance_preserves_state" class="idref" href="#try_get_balance_preserves_state"><span class="id" title="lemma">try_get_balance_preserves_state</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:165" class="idref" href="#prev_state:165"><span class="id" title="binder">prev_state</span></a> <a id="new_state:166" class="idref" href="#new_state:166"><span class="id" title="binder">new_state</span></a> <a id="chain:167" class="idref" href="#chain:167"><span class="id" title="binder">chain</span></a> <a id="ctx:168" class="idref" href="#ctx:168"><span class="id" title="binder">ctx</span></a> <a id="new_acts:169" class="idref" href="#new_acts:169"><span class="id" title="binder">new_acts</span></a> <a id="param:170" class="idref" href="#param:170"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:167"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:168"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:165"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#getBalance"><span class="id" title="constructor">getBalance</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:170"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:166"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:169"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:165"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:166"><span class="id" title="variable">new_state</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If the requirements are met then then receive on getBalance msg must succeed and
      if receive on getBalance msg succeeds then requirements must hold 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_get_balance_is_some" class="idref" href="#try_get_balance_is_some"><span class="id" title="lemma">try_get_balance_is_some</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:171" class="idref" href="#prev_state:171"><span class="id" title="binder">prev_state</span></a> <a id="chain:172" class="idref" href="#chain:172"><span class="id" title="binder">chain</span></a> <a id="ctx:173" class="idref" href="#ctx:173"><span class="id" title="binder">ctx</span></a> <a id="param:174" class="idref" href="#param:174"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:173"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> 0)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="new_state:175" class="idref" href="#new_state:175"><span class="id" title="binder">new_state</span></a> <a id="new_acts:176" class="idref" href="#new_acts:176"><span class="id" title="binder">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:172"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:173"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:171"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#getBalance"><span class="id" title="constructor">getBalance</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:174"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:175"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:176"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_hyps</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab61"></a><h2 class="section">Get total supply correct</h2>
 <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#Dexter2Lqt.try_get_total_supply"><span class="id" title="definition">try_get_total_supply</span></a></span> produces a callback to the correct contract with
      the total supply of tokens, the call should carry no balance 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_get_total_supply_new_acts_correct" class="idref" href="#try_get_total_supply_new_acts_correct"><span class="id" title="lemma">try_get_total_supply_new_acts_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:177" class="idref" href="#prev_state:177"><span class="id" title="binder">prev_state</span></a> <a id="new_state:178" class="idref" href="#new_state:178"><span class="id" title="binder">new_state</span></a> <a id="chain:179" class="idref" href="#chain:179"><span class="id" title="binder">chain</span></a> <a id="ctx:180" class="idref" href="#ctx:180"><span class="id" title="binder">ctx</span></a> <a id="new_acts:181" class="idref" href="#new_acts:181"><span class="id" title="binder">new_acts</span></a> <a id="param:182" class="idref" href="#param:182"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:179"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:180"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:177"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#getTotalSupply"><span class="id" title="constructor">getTotalSupply</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:182"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:178"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:181"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:181"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:182"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#supply_callback"><span class="id" title="projection">supply_callback</span></a>) 0%<span class="id" title="var">Z</span> (<a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#receive_total_supply"><span class="id" title="constructor">receive_total_supply</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:177"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#total_supply"><span class="id" title="projection">total_supply</span></a>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#Dexter2Lqt.try_get_total_supply"><span class="id" title="definition">try_get_total_supply</span></a></span> does not modify state 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_get_total_supply_preserves_state" class="idref" href="#try_get_total_supply_preserves_state"><span class="id" title="lemma">try_get_total_supply_preserves_state</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:183" class="idref" href="#prev_state:183"><span class="id" title="binder">prev_state</span></a> <a id="new_state:184" class="idref" href="#new_state:184"><span class="id" title="binder">new_state</span></a> <a id="chain:185" class="idref" href="#chain:185"><span class="id" title="binder">chain</span></a> <a id="ctx:186" class="idref" href="#ctx:186"><span class="id" title="binder">ctx</span></a> <a id="new_acts:187" class="idref" href="#new_acts:187"><span class="id" title="binder">new_acts</span></a> <a id="param:188" class="idref" href="#param:188"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:185"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:186"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:183"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#getTotalSupply"><span class="id" title="constructor">getTotalSupply</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:188"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:184"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:187"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:183"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:184"><span class="id" title="variable">new_state</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If the requirements are met then then receive on get_total_supply msg must succeed and
      if receive on get_total_supply msg succeeds then requirements must hold 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_get_total_supply_is_some" class="idref" href="#try_get_total_supply_is_some"><span class="id" title="lemma">try_get_total_supply_is_some</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:189" class="idref" href="#prev_state:189"><span class="id" title="binder">prev_state</span></a> <a id="chain:190" class="idref" href="#chain:190"><span class="id" title="binder">chain</span></a> <a id="ctx:191" class="idref" href="#ctx:191"><span class="id" title="binder">ctx</span></a> <a id="param:192" class="idref" href="#param:192"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:191"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> 0)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="new_state:193" class="idref" href="#new_state:193"><span class="id" title="binder">new_state</span></a> <a id="new_acts:194" class="idref" href="#new_acts:194"><span class="id" title="binder">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:190"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:191"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:189"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#getTotalSupply"><span class="id" title="constructor">getTotalSupply</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#param:192"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:193"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:194"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_hyps</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab62"></a><h2 class="section">Init correct</h2>
 After initalization no accounts should hold tokens 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="init_balances_correct" class="idref" href="#init_balances_correct"><span class="id" title="lemma">init_balances_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="chain:195" class="idref" href="#chain:195"><span class="id" title="binder">chain</span></a> <a id="ctx:196" class="idref" href="#ctx:196"><span class="id" title="binder">ctx</span></a> <a id="setup:197" class="idref" href="#setup:197"><span class="id" title="binder">setup</span></a> <a id="state:198" class="idref" href="#state:198"><span class="id" title="binder">state</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.init"><span class="id" title="definition">init</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:195"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:196"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#setup:197"><span class="id" title="variable">setup</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#state:198"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#state:198"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#tokens"><span class="id" title="projection">tokens</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Containers.html#FMap.add"><span class="id" title="abbreviation">FMap.add</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#setup:197"><span class="id" title="variable">setup</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#lqt_provider"><span class="id" title="projection">lqt_provider</span></a>) <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#setup:197"><span class="id" title="variable">setup</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#initial_pool"><span class="id" title="projection">initial_pool</span></a>) <a class="idref" href="ConCert.Execution.Containers.html#FMap.empty"><span class="id" title="abbreviation">FMap.empty</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">init_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
After initalization no allowances should be set 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="init_allowances_correct" class="idref" href="#init_allowances_correct"><span class="id" title="lemma">init_allowances_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="chain:199" class="idref" href="#chain:199"><span class="id" title="binder">chain</span></a> <a id="ctx:200" class="idref" href="#ctx:200"><span class="id" title="binder">ctx</span></a> <a id="setup:201" class="idref" href="#setup:201"><span class="id" title="binder">setup</span></a> <a id="state:202" class="idref" href="#state:202"><span class="id" title="binder">state</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.init"><span class="id" title="definition">init</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:199"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:200"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#setup:201"><span class="id" title="variable">setup</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#state:202"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#state:202"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowances"><span class="id" title="projection">allowances</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Containers.html#FMap.empty"><span class="id" title="abbreviation">FMap.empty</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">init_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="init_total_supply_correct" class="idref" href="#init_total_supply_correct"><span class="id" title="lemma">init_total_supply_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="chain:203" class="idref" href="#chain:203"><span class="id" title="binder">chain</span></a> <a id="ctx:204" class="idref" href="#ctx:204"><span class="id" title="binder">ctx</span></a> <a id="setup:205" class="idref" href="#setup:205"><span class="id" title="binder">setup</span></a> <a id="state:206" class="idref" href="#state:206"><span class="id" title="binder">state</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.init"><span class="id" title="definition">init</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:203"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:204"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#setup:205"><span class="id" title="variable">setup</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#state:206"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#state:206"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#total_supply"><span class="id" title="projection">total_supply</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#setup:205"><span class="id" title="variable">setup</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#initial_pool"><span class="id" title="projection">initial_pool</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">init_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
initialization should always succeed 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="init_is_some" class="idref" href="#init_is_some"><span class="id" title="lemma">init_is_some</span></a> : <span class="id" title="keyword">forall</span> <a id="chain:207" class="idref" href="#chain:207"><span class="id" title="binder">chain</span></a> <a id="ctx:208" class="idref" href="#ctx:208"><span class="id" title="binder">ctx</span></a> <a id="setup:209" class="idref" href="#setup:209"><span class="id" title="binder">setup</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="state:210" class="idref" href="#state:210"><span class="id" title="binder">state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.init"><span class="id" title="definition">init</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:207"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:208"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#setup:209"><span class="id" title="variable">setup</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#state:210"><span class="id" title="variable">state</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
<a id="lab63"></a><h2 class="section">Outgoing acts facts</h2>
 If contract emits self calls then they are for the receive entrypoints (which do not exits) 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="only_getter_self_calls" class="idref" href="#only_getter_self_calls"><span class="id" title="lemma">only_getter_self_calls</span></a> <a id="bstate:211" class="idref" href="#bstate:211"><span class="id" title="binder">bstate</span></a> <a id="caddr:212" class="idref" href="#caddr:212"><span class="id" title="binder">caddr</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:211"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:211"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#caddr:212"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <a id="act_body:213" class="idref" href="#act_body:213"><span class="id" title="binder">act_body</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#act_body:213"><span class="id" title="variable">act_body</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#to"><span class="id" title="projection">to</span></a> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#to"><span class="id" title="projection">to</span></a> <span class="id" title="var">_</span> <span class="id" title="var">msg</span> =&gt; <span class="id" title="var">to</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#caddr:212"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="n:215" class="idref" href="#n:215"><span class="id" title="binder">n</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">msg</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#receive_allowance"><span class="id" title="constructor">receive_allowance</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#n:215"><span class="id" title="variable">n</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">\/</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="n:216" class="idref" href="#n:216"><span class="id" title="binder">n</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">msg</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#receive_balance_of"><span class="id" title="constructor">receive_balance_of</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#n:216"><span class="id" title="variable">n</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">\/</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="n:217" class="idref" href="#n:217"><span class="id" title="binder">n</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">msg</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#receive_total_supply"><span class="id" title="constructor">receive_total_supply</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#n:217"><span class="id" title="variable">n</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>) (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:211"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#caddr:212"><span class="id" title="variable">caddr</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_induction</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall_app"><span class="id" title="lemma">Forall_app</span></a>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">IH</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">try_solve_acts_correct</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> [|? ? <span class="id" title="var">head_not_me</span> <span class="id" title="var">tail_not_me</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">head</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">action_facts</span> <span class="id" title="keyword">as</span> (? &amp; ? &amp; ? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">head_not_me</span> <span class="id" title="keyword">as</span> [[] | [[] | []]]; <span class="id" title="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">perm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">solve_facts</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Contract never calls itself 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="no_self_calls" class="idref" href="#no_self_calls"><span class="id" title="lemma">no_self_calls</span></a> : <span class="id" title="keyword">forall</span> <a id="bstate:218" class="idref" href="#bstate:218"><span class="id" title="binder">bstate</span></a> <a id="origin:219" class="idref" href="#origin:219"><span class="id" title="binder">origin</span></a> <a id="from_addr:220" class="idref" href="#from_addr:220"><span class="id" title="binder">from_addr</span></a> <a id="to_addr:221" class="idref" href="#to_addr:221"><span class="id" title="binder">to_addr</span></a> <a id="amount:222" class="idref" href="#amount:222"><span class="id" title="binder">amount</span></a> <a id="msg:223" class="idref" href="#msg:223"><span class="id" title="binder">msg</span></a> <a id="acts:224" class="idref" href="#acts:224"><span class="id" title="binder">acts</span></a> <a id="ctx:225" class="idref" href="#ctx:225"><span class="id" title="binder">ctx</span></a> <a id="prev_state:226" class="idref" href="#prev_state:226"><span class="id" title="binder">prev_state</span></a> <a id="new_state:227" class="idref" href="#new_state:227"><span class="id" title="binder">new_state</span></a> <a id="resp_acts:228" class="idref" href="#resp_acts:228"><span class="id" title="binder">resp_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:218"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:218"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#to_addr:221"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:218"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">{|</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_origin"><span class="id" title="projection">act_origin</span></a> := <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#origin:219"><span class="id" title="variable">origin</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#act_from"><span class="id" title="projection">act_from</span></a> := <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#from_addr:220"><span class="id" title="variable">from_addr</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#act_body"><span class="id" title="projection">act_body</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#msg:223"><span class="id" title="variable">msg</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">msg</span> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#to_addr:221"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#amount:222"><span class="id" title="variable">amount</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#msg:223"><span class="id" title="variable">msg</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#to_addr:221"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#amount:222"><span class="id" title="variable">amount</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">|}</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#acts:224"><span class="id" title="variable">acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#wc_receive"><span class="id" title="definition">wc_receive</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.contract"><span class="id" title="definition">contract</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:218"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:225"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:226"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#msg:223"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:227"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#resp_acts:228"><span class="id" title="variable">resp_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#from_addr:220"><span class="id" title="variable">from_addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#to_addr:221"><span class="id" title="variable">to_addr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">reach</span> <span class="id" title="var">deployed</span> <span class="id" title="var">queue</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#only_getter_self_calls"><span class="id" title="lemma">only_getter_self_calls</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed</span> <span class="id" title="keyword">as</span> <span class="id" title="var">no_self_calls</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">no_self_calls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue</span> <span class="id" title="tactic">in</span> <span class="id" title="var">no_self_calls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">no_self_calls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">no_self_calls</span> <span class="id" title="keyword">as</span> [|? ? <span class="id" title="var">hd</span> <span class="id" title="var">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">hd</span> <span class="id" title="keyword">as</span> [[] | [[] | []]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>; <span class="id" title="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#wc_receive_strong"><span class="id" title="lemma">wc_receive_strong</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">_</span> &amp; ? &amp; <span class="id" title="var">_</span> &amp; <span class="id" title="var">_</span> &amp; <span class="id" title="var">msg_correct</span> &amp; <span class="id" title="var">_</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">destruct_match</span> <span class="id" title="tactic">in</span> <span class="id" title="var">msg_correct</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
The contract never produces actions carrying money 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="new_acts_amount_zero" class="idref" href="#new_acts_amount_zero"><span class="id" title="lemma">new_acts_amount_zero</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:230" class="idref" href="#prev_state:230"><span class="id" title="binder">prev_state</span></a> <a id="chain:231" class="idref" href="#chain:231"><span class="id" title="binder">chain</span></a> <a id="ctx:232" class="idref" href="#ctx:232"><span class="id" title="binder">ctx</span></a> <a id="msg:233" class="idref" href="#msg:233"><span class="id" title="binder">msg</span></a> <a id="new_state:234" class="idref" href="#new_state:234"><span class="id" title="binder">new_state</span></a> <a id="new_acts:235" class="idref" href="#new_acts:235"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#chain:231"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:232"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#prev_state:230"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#msg:233"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_state:234"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:235"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.Extras.html#sumZ"><span class="id" title="definition">sumZ</span></a> (<span class="id" title="keyword">fun</span> <a id="act:236" class="idref" href="#act:236"><span class="id" title="binder">act</span></a> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#act_body_amount"><span class="id" title="definition">act_body_amount</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#act:236"><span class="id" title="variable">act</span></a>) <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts:235"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0%<span class="id" title="var">Z</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>; <span class="id" title="var">try_solve_acts_correct</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="outgoing_acts_amount_zero" class="idref" href="#outgoing_acts_amount_zero"><span class="id" title="lemma">outgoing_acts_amount_zero</span></a> : <span class="id" title="keyword">forall</span> <a id="bstate:237" class="idref" href="#bstate:237"><span class="id" title="binder">bstate</span></a> <a id="caddr:238" class="idref" href="#caddr:238"><span class="id" title="binder">caddr</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:237"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:237"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#caddr:238"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <a id="act:239" class="idref" href="#act:239"><span class="id" title="binder">act</span></a> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#act_body_amount"><span class="id" title="definition">act_body_amount</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#act:239"><span class="id" title="variable">act</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0%<span class="id" title="var">Z</span>) (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:237"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#caddr:238"><span class="id" title="variable">caddr</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">reach</span> <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#lift_outgoing_acts_prop"><span class="id" title="lemma">lift_outgoing_acts_prop</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.contract"><span class="id" title="definition">contract</span></a>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>; <span class="id" title="var">try_solve_acts_correct</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Contract only produces contract call actions 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="outgoing_acts_are_calls" class="idref" href="#outgoing_acts_are_calls"><span class="id" title="lemma">outgoing_acts_are_calls</span></a> : <span class="id" title="keyword">forall</span> <a id="bstate:240" class="idref" href="#bstate:240"><span class="id" title="binder">bstate</span></a> <a id="caddr:241" class="idref" href="#caddr:241"><span class="id" title="binder">caddr</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:240"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:240"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#caddr:241"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <a id="act_body:242" class="idref" href="#act_body:242"><span class="id" title="binder">act_body</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#act_body:242"><span class="id" title="variable">act_body</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>) (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:240"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#caddr:241"><span class="id" title="variable">caddr</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">reach</span> <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#lift_outgoing_acts_prop"><span class="id" title="lemma">lift_outgoing_acts_prop</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.contract"><span class="id" title="definition">contract</span></a>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>; <span class="id" title="var">try_solve_acts_correct</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab64"></a><h2 class="section">Contract balance facts</h2>
 Contract balance should always be zero 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="contract_initial_balance_bound" class="idref" href="#contract_initial_balance_bound"><span class="id" title="lemma">contract_initial_balance_bound</span></a> : <span class="id" title="keyword">forall</span> <a id="bstate:244" class="idref" href="#bstate:244"><span class="id" title="binder">bstate</span></a> <a id="caddr:245" class="idref" href="#caddr:245"><span class="id" title="binder">caddr</span></a> (<a id="trace:246" class="idref" href="#trace:246"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:244"><span class="id" title="variable">bstate</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:244"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#caddr:245"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="deploy_info:247" class="idref" href="#deploy_info:247"><span class="id" title="binder">deploy_info</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#Setup"><span class="id" title="record">Setup</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#trace:246"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#caddr:245"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#deploy_info:247"><span class="id" title="variable">deploy_info</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#deploy_info:247"><span class="id" title="variable">deploy_info</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_amount"><span class="id" title="projection">deployment_amount</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0%<span class="id" title="var">Z</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_induction</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">instantiate</span> (<span class="id" title="var">DeployFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <a id="ctx:248" class="idref" href="#ctx:248"><span class="id" title="binder">ctx</span></a> =&gt; (0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:248"><span class="id" title="variable">ctx</span></a>)%<span class="id" title="var">Z</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">DeployFacts</span> <span class="id" title="tactic">in</span> <span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">solve_facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.ge_le"><span class="id" title="lemma">Z.ge_le</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="contract_balance_bound'" class="idref" href="#contract_balance_bound'"><span class="id" title="lemma">contract_balance_bound'</span></a> : <span class="id" title="keyword">forall</span> <a id="bstate:249" class="idref" href="#bstate:249"><span class="id" title="binder">bstate</span></a> <a id="caddr:250" class="idref" href="#caddr:250"><span class="id" title="binder">caddr</span></a> (<a id="trace:251" class="idref" href="#trace:251"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:249"><span class="id" title="variable">bstate</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="effective_balance:253" class="idref" href="#effective_balance:253"><span class="id" title="binder">effective_balance</span></a> := (<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:249"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#caddr:250"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Utils.Extras.html#sumZ"><span class="id" title="definition">sumZ</span></a> (<span class="id" title="keyword">fun</span> <a id="act:252" class="idref" href="#act:252"><span class="id" title="binder">act</span></a> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#act_body_amount"><span class="id" title="definition">act_body_amount</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#act:252"><span class="id" title="variable">act</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:249"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#caddr:250"><span class="id" title="variable">caddr</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">)</span></a>)%<span class="id" title="var">Z</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:249"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#caddr:250"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="deploy_info:254" class="idref" href="#deploy_info:254"><span class="id" title="binder">deploy_info</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#Setup"><span class="id" title="record">Setup</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#trace:251"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#caddr:250"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#deploy_info:254"><span class="id" title="variable">deploy_info</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#effective_balance:253"><span class="id" title="variable">effective_balance</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#deploy_info:254"><span class="id" title="variable">deploy_info</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_amount"><span class="id" title="projection">deployment_amount</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">effective_balance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_induction</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">instantiate</span> (<span class="id" title="var">CallFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <a id="ctx:255" class="idref" href="#ctx:255"><span class="id" title="binder">ctx</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:255"><span class="id" title="variable">ctx</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:255"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:255"><span class="id" title="variable">ctx</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">facts</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">ctx_amount_positive</span> &amp; <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#contract_not_payable"><span class="id" title="lemma">contract_not_payable</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span> <span class="id" title="keyword">as</span> <span class="id" title="var">not_payable</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#new_acts_amount_zero"><span class="id" title="lemma">new_acts_amount_zero</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span> <span class="id" title="keyword">as</span> <span class="id" title="var">amount_zero_new_acts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.le_antisymm"><span class="id" title="lemma">Z.le_antisymm</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ctx_amount_positive</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">ctx_amount_positive</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.sub_0_r"><span class="id" title="lemma">Z.sub_0_r</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Utils.Extras.html#sumZ_app"><span class="id" title="lemma">sumZ_app</span></a>, <span class="id" title="var">amount_zero_new_acts</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.add_0_l"><span class="id" title="lemma">Z.add_0_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">erewrite</span> <a class="idref" href="ConCert.Utils.Extras.html#sumZ_permutation"><span class="id" title="lemma">sumZ_permutation</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IH</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">solve_facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.ge_le"><span class="id" title="lemma">Z.ge_le</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> ?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">subst</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#no_self_calls"><span class="id" title="lemma">no_self_calls</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="contract_balance_bound" class="idref" href="#contract_balance_bound"><span class="id" title="lemma">contract_balance_bound</span></a> : <span class="id" title="keyword">forall</span> <a id="bstate:256" class="idref" href="#bstate:256"><span class="id" title="binder">bstate</span></a> <a id="caddr:257" class="idref" href="#caddr:257"><span class="id" title="binder">caddr</span></a> (<a id="trace:258" class="idref" href="#trace:258"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:256"><span class="id" title="variable">bstate</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:256"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#caddr:257"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:256"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#caddr:257"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0%<span class="id" title="var">Z</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">trace</span> <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#contract_balance_bound'"><span class="id" title="lemma">contract_balance_bound'</span></a> <span class="id" title="keyword">as</span> (<span class="id" title="var">dep_info</span> &amp; <span class="id" title="var">deployment_info_eq</span> &amp; <span class="id" title="var">balance_bound</span>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#contract_initial_balance_bound"><span class="id" title="lemma">contract_initial_balance_bound</span></a> <span class="id" title="keyword">as</span> (<span class="id" title="var">dep_info'</span> &amp; <span class="id" title="var">deployment_info_eq'</span> &amp; <span class="id" title="var">balance_init_bound</span>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployment_info_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployment_info_eq'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">all</span>: <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">injection</span> <span class="id" title="var">deployment_info_eq'</span> <span class="id" title="keyword">as</span> -&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">balance_init_bound</span> <span class="id" title="tactic">in</span> <span class="id" title="var">balance_bound</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#outgoing_acts_amount_zero"><span class="id" title="lemma">outgoing_acts_amount_zero</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed</span> <span class="id" title="keyword">as</span> <span class="id" title="var">act_amount_zero</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">balance_bound</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Zminus_0_l_reverse"><span class="id" title="lemma">Zminus_0_l_reverse</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.sub_cancel_l"><span class="id" title="lemma">Z.sub_cancel_l</span></a> <span class="id" title="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">balance_init_bound</span> <span class="id" title="var">balance_bound</span> <span class="id" title="var">deployment_info_eq</span> <span class="id" title="var">dep_info'</span> <span class="id" title="var">trace</span> <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.list.html#Forall_cons"><span class="id" title="lemma">list.Forall_cons</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">act_amount_zero</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">act_amount_zero</span> &amp; <span class="id" title="var">acts_amount_zero</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">act_amount_zero</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.add_0_l"><span class="id" title="lemma">Z.add_0_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab65"></a><h2 class="section">Total supply / token balance facts</h2>
 Sum of all token balances 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="sum_balances" class="idref" href="#sum_balances"><span class="id" title="definition">sum_balances</span></a> <a id="state:259" class="idref" href="#state:259"><span class="id" title="binder">state</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.Extras.html#sumN"><span class="id" title="definition">sumN</span></a> (<span class="id" title="keyword">fun</span> '<a id="pat:262" class="idref" href="#pat:262"><span class="id" title="binder">(</span></a><a id="pat:262" class="idref" href="#pat:262"><span class="id" title="binder">k</span></a><a id="pat:262" class="idref" href="#pat:262"><span class="id" title="binder">,</span></a> <a id="pat:262" class="idref" href="#pat:262"><span class="id" title="binder">v</span></a><a id="pat:262" class="idref" href="#pat:262"><span class="id" title="binder">)</span></a> =&gt; <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#v:260"><span class="id" title="variable">v</span></a>) (<a class="idref" href="ConCert.Execution.Containers.html#FMap.elements"><span class="id" title="abbreviation">FMap.elements</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#state:259"><span class="id" title="variable">state</span></a>)).<br/>

<br/>
</div>

<div class="doc">
The balance of a single account is always less than
    or equal to the sum of all balances 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="balance_le_sum_balances" class="idref" href="#balance_le_sum_balances"><span class="id" title="lemma">balance_le_sum_balances</span></a> : <span class="id" title="keyword">forall</span> <a id="addr:263" class="idref" href="#addr:263"><span class="id" title="binder">addr</span></a> <a id="state:264" class="idref" href="#state:264"><span class="id" title="binder">state</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#addr:263"><span class="id" title="variable">addr</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#state:264"><span class="id" title="variable">state</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#2ccca3280733654024e33c2005ae2530"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#sum_balances"><span class="id" title="definition">sum_balances</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#state:264"><span class="id" title="variable">state</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">balance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.In_elements"><span class="id" title="lemma">FMap.In_elements</span></a>, <a class="idref" href="ConCert.Utils.Extras.html#sumN_in_le"><span class="id" title="lemma">sumN_in_le</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">balance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.le_trans"><span class="id" title="lemma">N.le_trans</span></a>; <span class="id" title="var">cycle</span> 1; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.le_0_l"><span class="id" title="lemma">N.le_0_l</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#total_supply"><span class="id" title="projection">total_supply</span></a></span> is always equal to the sum of all account token balances 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="sum_balances_eq_total_supply" class="idref" href="#sum_balances_eq_total_supply"><span class="id" title="lemma">sum_balances_eq_total_supply</span></a> : <span class="id" title="keyword">forall</span> <a id="bstate:265" class="idref" href="#bstate:265"><span class="id" title="binder">bstate</span></a> <a id="caddr:266" class="idref" href="#caddr:266"><span class="id" title="binder">caddr</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:265"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:265"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#caddr:266"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="cstate:267" class="idref" href="#cstate:267"><span class="id" title="binder">cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:265"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#caddr:266"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#cstate:267"><span class="id" title="variable">cstate</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#total_supply"><span class="id" title="projection">total_supply</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#cstate:267"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#sum_balances"><span class="id" title="definition">sum_balances</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#cstate:267"><span class="id" title="variable">cstate</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">reach</span> <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#lift_contract_state_prop"><span class="id" title="lemma">lift_contract_state_prop</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.contract"><span class="id" title="definition">contract</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> *; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">reach</span> <span class="id" title="var">deployed</span> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">init_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#sum_balances"><span class="id" title="definition">sum_balances</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#init_total_supply_correct"><span class="id" title="lemma">init_total_supply_correct</span></a>, <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#init_balances_correct"><span class="id" title="lemma">init_balances_correct</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.elements_add"><span class="id" title="lemma">FMap.elements_add</span></a>, <a class="idref" href="ConCert.Execution.Containers.html#FMap.elements_empty"><span class="id" title="lemma">FMap.elements_empty</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">IH</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">erewrite</span> &lt;- <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#try_transfer_preserves_total_supply"><span class="id" title="lemma">try_transfer_preserves_total_supply</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rename</span> <span class="id" title="var">t</span> <span class="id" title="var">into</span> <span class="id" title="var">param</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#sum_balances"><span class="id" title="definition">sum_balances</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.ltb_ge"><span class="id" title="lemma">N.ltb_ge</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">param</span>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#from"><span class="id" title="projection">from</span></a>) <span class="id" title="var">param</span>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#to"><span class="id" title="projection">to</span></a>)) <span class="id" title="keyword">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&lt;-| <span class="id" title="var">from_to_ne</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_eq"><span class="id" title="lemma">FMap.find_update_eq</span></a> | <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_ne"><span class="id" title="lemma">FMap.find_update_ne</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#from"><span class="id" title="projection">from</span></a> <span class="id" title="var">param</span>) <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">from_balance</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#to"><span class="id" title="projection">to</span></a> <span class="id" title="var">param</span>) (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#tokens"><span class="id" title="projection">tokens</span></a> <span class="id" title="var">cstate</span>)) <span class="id" title="var">eqn</span>:<span class="id" title="var">to_balance</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">param</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> (<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : ?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> ?<span class="id" title="var">y</span> |- <span class="id" title="keyword">context</span> [ ?<span class="id" title="var">x</span> ] =&gt; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#2ccca3280733654024e33c2005ae2530"><span class="id" title="notation">&lt;=</span></a> 0 |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.lt_eq_cases"><span class="id" title="lemma">N.lt_eq_cases</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">H</span> | <span class="id" title="var">H</span>]; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>; <span class="id" title="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> ?<span class="id" title="var">x</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.add"><span class="id" title="abbreviation">FMap.add</span></a> ?<span class="id" title="var">x</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find_add"><span class="id" title="lemma">FMap.find_add</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Containers.html#FMap.add"><span class="id" title="abbreviation">FMap.add</span></a> ?<span class="id" title="var">x</span> <span class="id" title="var">_</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.add"><span class="id" title="abbreviation">FMap.add</span></a> ?<span class="id" title="var">x</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.add_add"><span class="id" title="lemma">FMap.add_add</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : ?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> ?<span class="id" title="var">y</span> |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> ?<span class="id" title="var">x</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.add"><span class="id" title="abbreviation">FMap.add</span></a> ?<span class="id" title="var">y</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find_add_ne"><span class="id" title="lemma">FMap.find_add_ne</span></a>; <span class="id" title="tactic">eauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : ?<span class="id" title="var">y</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> ?<span class="id" title="var">x</span> |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> ?<span class="id" title="var">x</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.add"><span class="id" title="abbreviation">FMap.add</span></a> ?<span class="id" title="var">y</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find_add_ne"><span class="id" title="lemma">FMap.find_add_ne</span></a>; <span class="id" title="tactic">eauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : ?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> ?<span class="id" title="var">y</span> |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> ?<span class="id" title="var">x</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.remove"><span class="id" title="abbreviation">FMap.remove</span></a> ?<span class="id" title="var">y</span> <span class="id" title="var">_</span>) ] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find_remove_ne"><span class="id" title="lemma">FMap.find_remove_ne</span></a>; <span class="id" title="tactic">eauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : ?<span class="id" title="var">y</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> ?<span class="id" title="var">x</span> |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> ?<span class="id" title="var">x</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.remove"><span class="id" title="abbreviation">FMap.remove</span></a> ?<span class="id" title="var">y</span> <span class="id" title="var">_</span>) ] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find_remove_ne"><span class="id" title="lemma">FMap.find_remove_ne</span></a>; <span class="id" title="tactic">eauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> ?<span class="id" title="var">x</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Containers.html#FMap.elements"><span class="id" title="abbreviation">FMap.elements</span></a> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.add"><span class="id" title="abbreviation">FMap.add</span></a> ?<span class="id" title="var">x</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.elements_add_existing"><span class="id" title="lemma">FMap.elements_add_existing</span></a>; <span class="id" title="tactic">eauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> ?<span class="id" title="var">x</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Containers.html#FMap.elements"><span class="id" title="abbreviation">FMap.elements</span></a> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.add"><span class="id" title="abbreviation">FMap.add</span></a> ?<span class="id" title="var">x</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.elements_add"><span class="id" title="lemma">FMap.elements_add</span></a>; <span class="id" title="tactic">eauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Containers.html#FMap.remove"><span class="id" title="abbreviation">FMap.remove</span></a> ?<span class="id" title="var">x</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.add"><span class="id" title="abbreviation">FMap.add</span></a> ?<span class="id" title="var">x</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.fin_maps.html#delete_insert_delete"><span class="id" title="lemma">fin_maps.delete_insert_delete</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> ?<span class="id" title="var">x</span> ?<span class="id" title="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Utils.Extras.html#sumN"><span class="id" title="definition">sumN</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Containers.html#FMap.elements"><span class="id" title="abbreviation">FMap.elements</span></a> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.remove"><span class="id" title="abbreviation">FMap.remove</span></a> ?<span class="id" title="var">x</span> ?<span class="id" title="var">m</span>)) ] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.fin_maps.html#map_to_list_delete"><span class="id" title="lemma">fin_maps.map_to_list_delete</span></a>; <span class="id" title="tactic">auto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> ?<span class="id" title="var">x</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> ?<span class="id" title="var">n</span> |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Utils.Extras.html#sumN"><span class="id" title="definition">sumN</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>?<span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> ?<span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Containers.html#FMap.elements"><span class="id" title="abbreviation">FMap.elements</span></a> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.remove"><span class="id" title="abbreviation">FMap.remove</span></a> ?<span class="id" title="var">x</span> <span class="id" title="var">_</span>)) ] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Utils.Extras.html#sumN_swap"><span class="id" title="lemma">sumN_swap</span></a>, <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.fin_maps.html#map_to_list_delete"><span class="id" title="lemma">fin_maps.map_to_list_delete</span></a>; <span class="id" title="tactic">auto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Utils.Extras.html#sumN"><span class="id" title="definition">sumN</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>?<span class="id" title="var">t</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> ?<span class="id" title="var">n</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> ?<span class="id" title="var">m</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">_</span>) ] =&gt; <span class="id" title="var">erewrite</span> <a class="idref" href="ConCert.Utils.Extras.html#sumN_split"><span class="id" title="lemma">sumN_split</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">x</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">t</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) (<span class="id" title="var">y</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">m</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Utils.Extras.html#sumN"><span class="id" title="definition">sumN</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> 0<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>?<span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> ?<span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">_</span>) ] =&gt; <span class="id" title="var">erewrite</span> &lt;- <a class="idref" href="ConCert.Utils.Extras.html#sumN_split"><span class="id" title="lemma">sumN_split</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">z</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Utils.Extras.html#sumN"><span class="id" title="definition">sumN</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> ?<span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>?<span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> ?<span class="id" title="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">-</span></a> ?<span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">_</span>) ] =&gt; <span class="id" title="var">erewrite</span> &lt;- <a class="idref" href="ConCert.Utils.Extras.html#sumN_split"><span class="id" title="lemma">sumN_split</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">z</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">n</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <span class="id" title="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Utils.Extras.html#sumN"><span class="id" title="definition">sumN</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>?<span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> ?<span class="id" title="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">-</span></a> ?<span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> ?<span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">_</span>) ] =&gt; <span class="id" title="var">erewrite</span> &lt;- <a class="idref" href="ConCert.Utils.Extras.html#sumN_split"><span class="id" title="lemma">sumN_split</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">z</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">n</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <span class="id" title="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Utils.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Utils.Extras.html#with_default"><span class="id" title="definition">with_default</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Utils.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span>) ] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Utils.Extras.html#with_default"><span class="id" title="definition">with_default</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Containers.html#FMap.update"><span class="id" title="definition">FMap.update</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.update"><span class="id" title="definition">FMap.update</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Containers.html#FMap.update"><span class="id" title="definition">FMap.update</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.update"><span class="id" title="definition">FMap.update</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.add_0_l"><span class="id" title="lemma">N.add_0_l</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> 0 ] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.add_0_r"><span class="id" title="lemma">N.add_0_r</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.sub_0_l"><span class="id" title="lemma">N.sub_0_l</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">-</span></a> 0 ] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.sub_0_r"><span class="id" title="lemma">N.sub_0_r</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : ?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#2ccca3280733654024e33c2005ae2530"><span class="id" title="notation">&lt;=</span></a> ?<span class="id" title="var">y</span>, <span class="id" title="var">G</span> : ?<span class="id" title="var">y</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">-</span></a> ?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0 |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.sub_0_le"><span class="id" title="lemma">N.sub_0_le</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">G</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.le_antisymm"><span class="id" title="lemma">N.le_antisymm</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">G</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : ?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> ?<span class="id" title="var">y</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0 |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.eq_add_0"><span class="id" title="lemma">N.eq_add_0</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : ?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0 |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">subst</span> <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Containers.html#FMap.update"><span class="id" title="definition">FMap.update</span></a> ?<span class="id" title="var">k</span> <span class="id" title="var">_</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.update"><span class="id" title="definition">FMap.update</span></a> ?<span class="id" title="var">k</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.map_update_idemp"><span class="id" title="lemma">FMap.map_update_idemp</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : ?<span class="id" title="var">y</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#2ccca3280733654024e33c2005ae2530"><span class="id" title="notation">&lt;=</span></a> ?<span class="id" title="var">x</span> |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.ContractCommon.html#maybe"><span class="id" title="definition">maybe</span></a> (<a class="idref" href="ConCert.Utils.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.ContractCommon.html#maybe"><span class="id" title="definition">maybe</span></a> (?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">-</span></a> ?<span class="id" title="var">y</span>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> ?<span class="id" title="var">y</span>) ] =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.ContractCommon.html#maybe_sub_add"><span class="id" title="lemma">maybe_sub_add</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [[-&gt; -&gt;] | -&gt;]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> ?<span class="id" title="var">x</span> ?<span class="id" title="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> 0 |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Containers.html#FMap.elements"><span class="id" title="abbreviation">FMap.elements</span></a> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.remove"><span class="id" title="abbreviation">FMap.remove</span></a> ?<span class="id" title="var">x</span> <span class="id" title="var">_</span>) ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.add_0_r"><span class="id" title="lemma">N.add_0_r</span></a>; <span class="id" title="tactic">change</span> 0 <span class="id" title="keyword">with</span> ((<span class="id" title="keyword">fun</span> '<a id="pat:285" class="idref" href="#pat:285"><span class="id" title="binder">(</span></a><a id="pat:285" class="idref" href="#pat:285"><span class="id" title="binder">_</span></a><a id="pat:285" class="idref" href="#pat:285"><span class="id" title="binder">,</span></a> <a id="pat:285" class="idref" href="#pat:285"><span class="id" title="binder">v</span></a><a id="pat:285" class="idref" href="#pat:285"><span class="id" title="binder">)</span></a> =&gt; <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#v:270"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> 0<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>); <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Utils.Extras.html#sumN_inv"><span class="id" title="lemma">sumN_inv</span></a>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.fin_maps.html#map_to_list_delete"><span class="id" title="lemma">fin_maps.map_to_list_delete</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> ?<span class="id" title="var">k</span> ?<span class="id" title="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Containers.html#FMap.remove"><span class="id" title="abbreviation">FMap.remove</span></a> ?<span class="id" title="var">k</span> <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.fin_maps.html#delete_notin"><span class="id" title="lemma">fin_maps.delete_notin</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.ContractCommon.html#maybe"><span class="id" title="definition">maybe</span></a> <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">specialize</span> <a class="idref" href="ConCert.Execution.ContractCommon.html#maybe_cases"><span class="id" title="lemma">maybe_cases</span></a> <span class="id" title="keyword">as</span> [[-&gt; ?<span class="id" title="var">H</span>] | [-&gt; <span class="id" title="var">_</span>]]<br/>
              | <span class="id" title="var">H</span> : ?<span class="id" title="var">y</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> ?<span class="id" title="var">x</span> |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Utils.Extras.html#sumN"><span class="id" title="definition">sumN</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>?<span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> ?<span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Containers.html#FMap.elements"><span class="id" title="abbreviation">FMap.elements</span></a> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.remove"><span class="id" title="abbreviation">FMap.remove</span></a> ?<span class="id" title="var">y</span> <span class="id" title="var">_</span>)) ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.add_comm"><span class="id" title="lemma">N.add_comm</span></a>; <span class="id" title="tactic">change</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span> ((<span class="id" title="keyword">fun</span> '<a id="pat:283" class="idref" href="#pat:283"><span class="id" title="binder">(</span></a><a id="pat:283" class="idref" href="#pat:283"><span class="id" title="binder">_</span></a><a id="pat:283" class="idref" href="#pat:283"><span class="id" title="binder">,</span></a> <a id="pat:283" class="idref" href="#pat:283"><span class="id" title="binder">v</span></a><a id="pat:283" class="idref" href="#pat:283"><span class="id" title="binder">)</span></a> =&gt; <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#v:268"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">y</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>); <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Utils.Extras.html#sumN_inv"><span class="id" title="lemma">sumN_inv</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>); <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">erewrite</span> &lt;- <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#try_approve_preserves_total_supply"><span class="id" title="lemma">try_approve_preserves_total_supply</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#sum_balances"><span class="id" title="definition">sum_balances</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> &lt;- <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#try_approve_preserves_balances"><span class="id" title="lemma">try_approve_preserves_balances</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">try_solve_preserves_state</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">try_solve_preserves_state</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">try_solve_preserves_state</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#default_entrypoint_none"><span class="id" title="lemma">default_entrypoint_none</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Account token balances are always less than or equal to <span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#total_supply"><span class="id" title="projection">total_supply</span></a></span> 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="token_balance_le_total_supply" class="idref" href="#token_balance_le_total_supply"><span class="id" title="lemma">token_balance_le_total_supply</span></a> : <span class="id" title="keyword">forall</span> <a id="bstate:286" class="idref" href="#bstate:286"><span class="id" title="binder">bstate</span></a> <a id="caddr:287" class="idref" href="#caddr:287"><span class="id" title="binder">caddr</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:286"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:286"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#caddr:287"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="cstate:288" class="idref" href="#cstate:288"><span class="id" title="binder">cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:286"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#caddr:287"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#cstate:288"><span class="id" title="variable">cstate</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <span class="id" title="keyword">forall</span> <a id="addr:289" class="idref" href="#addr:289"><span class="id" title="binder">addr</span></a>, <a class="idref" href="ConCert.Utils.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#addr:289"><span class="id" title="variable">addr</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#cstate:288"><span class="id" title="variable">cstate</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#2ccca3280733654024e33c2005ae2530"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#total_supply"><span class="id" title="projection">total_supply</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#cstate:288"><span class="id" title="variable">cstate</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">reach</span> <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#sum_balances_eq_total_supply"><span class="id" title="lemma">sum_balances_eq_total_supply</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed</span> <span class="id" title="keyword">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">cstate</span> &amp; <span class="id" title="var">deployed_state</span> &amp; <span class="id" title="var">sum_eq_supply</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed_state</span>, <span class="id" title="var">sum_eq_supply</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">reach</span> <span class="id" title="var">deployed_state</span> <span class="id" title="var">sum_eq_supply</span> <span class="id" title="var">caddr</span> <span class="id" title="var">bstate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#balance_le_sum_balances"><span class="id" title="lemma">balance_le_sum_balances</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab66"></a><h2 class="section">Empty map entries removed</h2>
 The <span class="inlinecode"><a class="idref" href="ConCert.Examples.FA2.FA2Token.html#tokens"><span class="id" title="projection">tokens</span></a></span> map never stores entries of zero 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="zero_balances_removed" class="idref" href="#zero_balances_removed"><span class="id" title="lemma">zero_balances_removed</span></a> : <span class="id" title="keyword">forall</span> <a id="bstate:290" class="idref" href="#bstate:290"><span class="id" title="binder">bstate</span></a> <a id="caddr:291" class="idref" href="#caddr:291"><span class="id" title="binder">caddr</span></a> (<a id="trace:292" class="idref" href="#trace:292"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:290"><span class="id" title="variable">bstate</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:290"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#caddr:291"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="depinfo:293" class="idref" href="#depinfo:293"><span class="id" title="binder">depinfo</span></a> <a id="cstate:294" class="idref" href="#cstate:294"><span class="id" title="binder">cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#Setup"><span class="id" title="record">Setup</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#trace:292"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#caddr:291"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#depinfo:293"><span class="id" title="variable">depinfo</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:290"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#caddr:291"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#cstate:294"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="initial_tokens:295" class="idref" href="#initial_tokens:295"><span class="id" title="binder">initial_tokens</span></a> := <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#initial_pool"><span class="id" title="projection">initial_pool</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_setup"><span class="id" title="projection">deployment_setup</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#depinfo:293"><span class="id" title="variable">depinfo</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#initial_tokens:295"><span class="id" title="variable">initial_tokens</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="addr:296" class="idref" href="#addr:296"><span class="id" title="binder">addr</span></a> <a id="n:297" class="idref" href="#n:297"><span class="id" title="binder">n</span></a>, <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#addr:296"><span class="id" title="variable">addr</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#cstate:294"><span class="id" title="variable">cstate</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#n:297"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#n:297"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#lift_dep_info_contract_state_prop"><span class="id" title="lemma">lift_dep_info_contract_state_prop</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.contract"><span class="id" title="definition">contract</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>; <span class="id" title="tactic">intros</span> *; <span class="id" title="tactic">clear</span> <span class="id" title="var">deployed</span> <span class="id" title="var">trace</span> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">init_some</span> <span class="id" title="var">initial_pool_positive</span> * <span class="id" title="var">addr_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#init"><span class="id" title="projection">Blockchain.init</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#init_balances_correct"><span class="id" title="lemma">init_balances_correct</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">addr_some</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">addr</span> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#lqt_provider"><span class="id" title="projection">lqt_provider</span></a> <span class="id" title="var">setup</span>)) <span class="id" title="keyword">as</span> [&lt;-| <span class="id" title="var">addr_ne</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">addr_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find_add"><span class="id" title="lemma">FMap.find_add</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">addr_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find_add_ne"><span class="id" title="lemma">FMap.find_add_ne</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">addr_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">IH</span> <span class="id" title="var">receive_some</span> <span class="id" title="var">initial_pool_positive</span> * <span class="id" title="var">addr_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">Blockchain.receive</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">addr</span> <span class="id" title="var">from</span>) <span class="id" title="keyword">as</span> [&lt;- | <span class="id" title="var">addr_from_ne</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">only</span> 2: <span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">addr</span> <span class="id" title="var">to</span>) <span class="id" title="keyword">as</span> [&lt;- | <span class="id" title="var">addr_to_ne</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;case:&nbsp;addr&nbsp;=&nbsp;from&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#try_transfer_remove_empty_balances"><span class="id" title="lemma">try_transfer_remove_empty_balances</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;case:&nbsp;addr&nbsp;=&nbsp;to&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#try_transfer_remove_empty_balances"><span class="id" title="lemma">try_transfer_remove_empty_balances</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;case:&nbsp;addr&nbsp;is&nbsp;not&nbsp;related&nbsp;to&nbsp;transaction&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#try_transfer_preserves_other_balances"><span class="id" title="lemma">try_transfer_preserves_other_balances</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">receive_some</span> <span class="id" title="tactic">in</span> <span class="id" title="var">addr_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">erewrite</span> &lt;- <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#try_approve_preserves_balances"><span class="id" title="lemma">try_approve_preserves_balances</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">addr_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#try_get_allowance_preserves_state"><span class="id" title="lemma">try_get_allowance_preserves_state</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#try_get_balance_preserves_state"><span class="id" title="lemma">try_get_balance_preserves_state</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#try_get_total_supply_preserves_state"><span class="id" title="lemma">try_get_total_supply_preserves_state</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
The <span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#allowances"><span class="id" title="projection">allowances</span></a></span> map never stores entries of zero 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="zero_allowances_removed" class="idref" href="#zero_allowances_removed"><span class="id" title="lemma">zero_allowances_removed</span></a> : <span class="id" title="keyword">forall</span> <a id="bstate:298" class="idref" href="#bstate:298"><span class="id" title="binder">bstate</span></a> <a id="caddr:299" class="idref" href="#caddr:299"><span class="id" title="binder">caddr</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:298"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:298"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#caddr:299"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="cstate:300" class="idref" href="#cstate:300"><span class="id" title="binder">cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:298"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#caddr:299"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#cstate:300"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="sender:301" class="idref" href="#sender:301"><span class="id" title="binder">sender</span></a> <a id="from:302" class="idref" href="#from:302"><span class="id" title="binder">from</span></a> <a id="n:303" class="idref" href="#n:303"><span class="id" title="binder">n</span></a>, <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#sender:301"><span class="id" title="variable">sender</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#from:302"><span class="id" title="variable">from</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#cstate:300"><span class="id" title="variable">cstate</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#n:303"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#n:303"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">reach</span> <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#lift_contract_state_prop"><span class="id" title="lemma">lift_contract_state_prop</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.contract"><span class="id" title="definition">contract</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> *; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">reach</span> <span class="id" title="var">deployed</span> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">init_some</span> * <span class="id" title="var">addr_some</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#init"><span class="id" title="projection">Blockchain.init</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#init_allowances_correct"><span class="id" title="lemma">init_allowances_correct</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">addr_some</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find_empty"><span class="id" title="lemma">FMap.find_empty</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">addr_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">IH</span> <span class="id" title="var">receive_some</span> * <span class="id" title="var">addr_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">Blockchain.receive</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">ctx</span>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>) <span class="id" title="var">from</span>) <span class="id" title="keyword">as</span> [&lt;- | <span class="id" title="var">addr_from_ne</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">only</span> 1: <span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">from0</span> <span class="id" title="var">sender</span>) <span class="id" title="keyword">as</span> [&lt;- | <span class="id" title="var">addr_from_ne</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#try_transfer_remove_empty_allowances"><span class="id" title="lemma">try_transfer_remove_empty_allowances</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#try_transfer_preserves_other_allowances"><span class="id" title="lemma">try_transfer_preserves_other_allowances</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">receive_some</span> <span class="id" title="tactic">in</span> <span class="id" title="var">addr_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">intros</span> <span class="id" title="var">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#try_transfer_preserves_other_allowances"><span class="id" title="lemma">try_transfer_preserves_other_allowances</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">receive_some</span> <span class="id" title="tactic">in</span> <span class="id" title="var">addr_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">intros</span> <span class="id" title="var">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">ctx</span>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>) <span class="id" title="var">sender</span>) <span class="id" title="keyword">as</span> [&lt;- | <span class="id" title="var">addr_from_ne</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">only</span> 1: <span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">spender</span> <span class="id" title="var">from</span>) <span class="id" title="keyword">as</span> [&lt;- | <span class="id" title="var">addr_from_ne</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#try_approve_remove_empty_allowances"><span class="id" title="lemma">try_approve_remove_empty_allowances</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#try_approve_preserves_other_allowances"><span class="id" title="lemma">try_approve_preserves_other_allowances</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">receive_some</span> <span class="id" title="tactic">in</span> <span class="id" title="var">addr_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">intros</span> <span class="id" title="var">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#try_approve_preserves_other_allowances"><span class="id" title="lemma">try_approve_preserves_other_allowances</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">receive_some</span> <span class="id" title="tactic">in</span> <span class="id" title="var">addr_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">intros</span> <span class="id" title="var">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#try_get_allowance_preserves_state"><span class="id" title="lemma">try_get_allowance_preserves_state</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#try_get_balance_preserves_state"><span class="id" title="lemma">try_get_balance_preserves_state</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#try_get_total_supply_preserves_state"><span class="id" title="lemma">try_get_total_supply_preserves_state</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab67"></a><h2 class="section">Total supply correct</h2>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">Z_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#total_supply"><span class="id" title="projection">total_supply</span></a></span> is equal to the initial tokens 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="total_supply_correct" class="idref" href="#total_supply_correct"><span class="id" title="lemma">total_supply_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="bstate:304" class="idref" href="#bstate:304"><span class="id" title="binder">bstate</span></a> <a id="caddr:305" class="idref" href="#caddr:305"><span class="id" title="binder">caddr</span></a> (<a id="trace:306" class="idref" href="#trace:306"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:304"><span class="id" title="variable">bstate</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:304"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#caddr:305"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#FA12Instance.contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="cstate:307" class="idref" href="#cstate:307"><span class="id" title="binder">cstate</span></a> <a id="depinfo:308" class="idref" href="#depinfo:308"><span class="id" title="binder">depinfo</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#bstate:304"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#caddr:305"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#cstate:307"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#Setup"><span class="id" title="record">Setup</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#trace:306"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#caddr:305"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#depinfo:308"><span class="id" title="variable">depinfo</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="initial_tokens:309" class="idref" href="#initial_tokens:309"><span class="id" title="binder">initial_tokens</span></a> := <a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#initial_pool"><span class="id" title="projection">initial_pool</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_setup"><span class="id" title="projection">deployment_setup</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#depinfo:308"><span class="id" title="variable">depinfo</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#cstate:307"><span class="id" title="variable">cstate</span></a>.(<a class="idref" href="ConCert.Examples.FA1_2.FA1_2.html#total_supply"><span class="id" title="projection">total_supply</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#initial_tokens:309"><span class="id" title="variable">initial_tokens</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_induction</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">cbn</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#init"><span class="id" title="projection">Blockchain.init</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">erewrite</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#init_total_supply_correct"><span class="id" title="lemma">init_total_supply_correct</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">instantiate</span> (<span class="id" title="var">CallFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <a id="ctx:310" class="idref" href="#ctx:310"><span class="id" title="binder">ctx</span></a> <a id="state:311" class="idref" href="#state:311"><span class="id" title="binder">state</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:310"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#ctx:310"><span class="id" title="variable">ctx</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">Blockchain.receive</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">erewrite</span> &lt;- <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#try_transfer_preserves_total_supply"><span class="id" title="lemma">try_transfer_preserves_total_supply</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">erewrite</span> &lt;- <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#try_approve_preserves_total_supply"><span class="id" title="lemma">try_approve_preserves_total_supply</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#try_get_allowance_preserves_state"><span class="id" title="lemma">try_get_allowance_preserves_state</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#try_get_balance_preserves_state"><span class="id" title="lemma">try_get_balance_preserves_state</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#try_get_total_supply_preserves_state"><span class="id" title="lemma">try_get_total_supply_preserves_state</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">solve_facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> ?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">subst</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#no_self_calls"><span class="id" title="lemma">no_self_calls</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Examples.FA1_2.FA1_2Correct.html#Theories"><span class="id" title="section">Theories</span></a>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="https://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a> and <a href="https://github.com/jgallen23/toc">TOC</a>
</div>
</div>
<script>
  const elements = document.getElementsByClassName("libtitle");
  while(elements.length > 0){
        elements[0].parentNode.removeChild(elements[0]);
  }
  if (window.location.pathname.endsWith("/toc.html")) {
      const jstocDiv = document.getElementById("js-toc");
      jstocDiv.classList.remove("toc");
      jstocDiv.classList.add("jstoc-hidden");
      const jstocHeaderDiv = document.getElementById("js-toc-header");
      jstocHeaderDiv.classList.add("jstoc-hidden");
      const mainDiv = document.getElementById("main");
      mainDiv.classList.add("jstoc-hidden-main");
      const toggleDiv = document.getElementById("toggle-toc");
      toggleDiv.classList.add("jstoc-hidden");
  }
  console.log(window.location.pathname);
</script>
<script type="text/javascript" src="toc.js"></script>
</body>

</html>
