<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<link href="toc.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
      <span id="toggle-toc">Contents</span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="https://github.com/AU-COBRA/ConCert" target="_balnk">Project Page</a>
      <a href="index.html">Index</a>
      <a href="toc.html">Table of contents</a>
    </span>
</div>
  <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="js-toc" class="toc" data-toc="h1,h2,h3,h4" data-toc-container="doc" data-toc-offset="-40">
      <div id="js-toc-header" class="toc-header">Contents:</div>
    </div>
    <div id="main">
<h1 class="libtitle">Library ConCert.Execution.InterContractCommunication</h1>

<div class="code">
</div>

<div class="doc">
Properties and tactics related to two communicating contracts 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Utils.Automation.html#"><span class="id" title="library">Automation</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Blockchain.html#"><span class="id" title="library">Blockchain</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Serializable.html#"><span class="id" title="library">Serializable</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#"><span class="id" title="library">List</span></a>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ListNotations"><span class="id" title="module">ListNotations</span></a>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">trace_induction</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> ?<span class="id" title="var">bstate</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">trace</span> <span class="id" title="keyword">as</span> [| * <span class="id" title="var">IH</span> <span class="id" title="var">step</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : ?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">subst</span> <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">try</span> <span class="id" title="tactic">discriminate</span> |<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_chain_step</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">destruct_action_eval</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">env_eq</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">env_eq</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">setoid_rewrite</span> <span class="id" title="var">env_eq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IH</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">auto</span>)))]; <span class="id" title="tactic">auto</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="InterContractCommunication" class="idref" href="#InterContractCommunication"><span class="id" title="section">InterContractCommunication</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<a id="BaseTypes:1" class="idref" href="#BaseTypes:1"><span class="id" title="binder">BaseTypes</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainBase"><span class="id" title="class">ChainBase</span></a>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="txCallTo" class="idref" href="#txCallTo"><span class="id" title="definition">txCallTo</span></a> (<a id="addr:2" class="idref" href="#addr:2"><span class="id" title="binder">addr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<a id="tx:3" class="idref" href="#tx:3"><span class="id" title="binder">tx</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Tx"><span class="id" title="record">Tx</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#tx:3"><span class="id" title="variable">tx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#tx_body"><span class="id" title="projection">tx_body</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#tx_call"><span class="id" title="constructor">tx_call</span></a> <span class="id" title="var">_</span> =&gt; (<a class="idref" href="ConCert.Execution.InterContractCommunication.html#tx:3"><span class="id" title="variable">tx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#tx_to"><span class="id" title="projection">tx_to</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#addr:2"><span class="id" title="variable">addr</span></a>)%<span class="id" title="var">address</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="actTo" class="idref" href="#actTo"><span class="id" title="definition">actTo</span></a> (<a id="addr:4" class="idref" href="#addr:4"><span class="id" title="binder">addr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<a id="act:5" class="idref" href="#act:5"><span class="id" title="binder">act</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#act:5"><span class="id" title="variable">act</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <span class="id" title="var">to</span> <span class="id" title="var">_</span> =&gt; (<span class="id" title="var">to</span> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#addr:4"><span class="id" title="variable">addr</span></a>)%<span class="id" title="var">address</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <span class="id" title="var">to</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; (<span class="id" title="var">to</span> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#addr:4"><span class="id" title="variable">addr</span></a>)%<span class="id" title="var">address</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="callFrom" class="idref" href="#callFrom"><span class="id" title="definition">callFrom</span></a> {<a id="Msg:7" class="idref" href="#Msg:7"><span class="id" title="binder">Msg</span></a> : <span class="id" title="keyword">Type</span>} (<a id="addr:8" class="idref" href="#addr:8"><span class="id" title="binder">addr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<a id="call_info:9" class="idref" href="#call_info:9"><span class="id" title="binder">call_info</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallInfo"><span class="id" title="record">ContractCallInfo</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#Msg:7"><span class="id" title="variable">Msg</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.InterContractCommunication.html#call_info:9"><span class="id" title="variable">call_info</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#call_from"><span class="id" title="projection">call_from</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#addr:8"><span class="id" title="variable">addr</span></a>)%<span class="id" title="var">address</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="deployed_incoming_calls_typed" class="idref" href="#deployed_incoming_calls_typed"><span class="id" title="lemma">deployed_incoming_calls_typed</span></a> : <span class="id" title="keyword">forall</span> <a id="bstate:10" class="idref" href="#bstate:10"><span class="id" title="binder">bstate</span></a> <a id="caddr:11" class="idref" href="#caddr:11"><span class="id" title="binder">caddr</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="Setup:12" class="idref" href="#Setup:12"><span class="id" title="binder">Setup</span></a> <a id="Msg:13" class="idref" href="#Msg:13"><span class="id" title="binder">Msg</span></a> <a id="State:14" class="idref" href="#State:14"><span class="id" title="binder">State</span></a> <a id="Error:15" class="idref" href="#Error:15"><span class="id" title="binder">Error</span></a> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H:16" class="idref" href="#H:16"><span class="id" title="binder">Serializable</span></a> <a id="H:16" class="idref" href="#H:16"><span class="id" title="binder">Setup</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H0:17" class="idref" href="#H0:17"><span class="id" title="binder">Serializable</span></a> <a id="H0:17" class="idref" href="#H0:17"><span class="id" title="binder">Msg</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H1:18" class="idref" href="#H1:18"><span class="id" title="binder">Serializable</span></a> <a id="H1:18" class="idref" href="#H1:18"><span class="id" title="binder">State</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H2:19" class="idref" href="#H2:19"><span class="id" title="binder">Serializable</span></a> <a id="H2:19" class="idref" href="#H2:19"><span class="id" title="binder">Error</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="contract:20" class="idref" href="#contract:20"><span class="id" title="binder">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Contract"><span class="id" title="record">Contract</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#Setup:12"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#Msg:13"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#State:14"><span class="id" title="variable">State</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#Error:15"><span class="id" title="variable">Error</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="trace:21" class="idref" href="#trace:21"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#bstate:10"><span class="id" title="variable">bstate</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#bstate:10"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#caddr:11"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.InterContractCommunication.html#contract:20"><span class="id" title="variable">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="inc_calls:22" class="idref" href="#inc_calls:22"><span class="id" title="binder">inc_calls</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#Msg:13"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#trace:21"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#caddr:11"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#inc_calls:22"><span class="id" title="variable">inc_calls</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">trace_induction</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;Contract&nbsp;deployment&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#undeployed_contract_no_in_calls"><span class="id" title="lemma">undeployed_contract_no_in_calls</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;Contract&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> [? <span class="id" title="var">IH</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">caddr</span> <span class="id" title="var">to_addr</span>) <span class="id" title="keyword">as</span> [&lt;-|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> ?<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_refl"><span class="id" title="lemma">address_eq_refl</span></a>, ?<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_ne"><span class="id" title="lemma">address_eq_ne</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">deployed0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#wc_receive_strong"><span class="id" title="lemma">wc_receive_strong</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span> <span class="id" title="keyword">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">prev_state'</span> &amp; <span class="id" title="var">msg'</span> &amp; <span class="id" title="var">new_state'</span> &amp; <span class="id" title="var">serialize_prev_state</span> &amp; <span class="id" title="var">msg_ser</span> &amp; <span class="id" title="var">serialize_new_state</span> &amp; <span class="id" title="var">receive_some</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg'</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">msg_ser</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">msg_ser</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">msg_ser</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="undeployed_contract_no_state" class="idref" href="#undeployed_contract_no_state"><span class="id" title="lemma">undeployed_contract_no_state</span></a> : <span class="id" title="keyword">forall</span> <a id="bstate:23" class="idref" href="#bstate:23"><span class="id" title="binder">bstate</span></a> <a id="caddr:24" class="idref" href="#caddr:24"><span class="id" title="binder">caddr</span></a> (<a id="trace:25" class="idref" href="#trace:25"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#bstate:23"><span class="id" title="variable">bstate</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#bstate:23"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#caddr:24"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contract_states"><span class="id" title="projection">env_contract_states</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#bstate:23"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#caddr:24"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">trace</span> <span class="id" title="var">not_deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">trace_induction</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">destruct_address_eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="no_outgoing_txs_to_undeployed_contract" class="idref" href="#no_outgoing_txs_to_undeployed_contract"><span class="id" title="lemma">no_outgoing_txs_to_undeployed_contract</span></a> : <span class="id" title="keyword">forall</span> <a id="bstate:26" class="idref" href="#bstate:26"><span class="id" title="binder">bstate</span></a> <a id="caddrA:27" class="idref" href="#caddrA:27"><span class="id" title="binder">caddrA</span></a> <a id="caddrB:28" class="idref" href="#caddrB:28"><span class="id" title="binder">caddrB</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="trace:29" class="idref" href="#trace:29"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#bstate:26"><span class="id" title="variable">bstate</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="Setup:30" class="idref" href="#Setup:30"><span class="id" title="binder">Setup</span></a> <a id="Msg:31" class="idref" href="#Msg:31"><span class="id" title="binder">Msg</span></a> <a id="State:32" class="idref" href="#State:32"><span class="id" title="binder">State</span></a> <a id="Error:33" class="idref" href="#Error:33"><span class="id" title="binder">Error</span></a> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H:34" class="idref" href="#H:34"><span class="id" title="binder">Serializable</span></a> <a id="H:34" class="idref" href="#H:34"><span class="id" title="binder">Setup</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H0:35" class="idref" href="#H0:35"><span class="id" title="binder">Serializable</span></a> <a id="H0:35" class="idref" href="#H0:35"><span class="id" title="binder">Msg</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H1:36" class="idref" href="#H1:36"><span class="id" title="binder">Serializable</span></a> <a id="H1:36" class="idref" href="#H1:36"><span class="id" title="binder">State</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H2:37" class="idref" href="#H2:37"><span class="id" title="binder">Serializable</span></a> <a id="H2:37" class="idref" href="#H2:37"><span class="id" title="binder">Error</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="contract:38" class="idref" href="#contract:38"><span class="id" title="binder">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Contract"><span class="id" title="record">Contract</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#Setup:30"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#Msg:31"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#State:32"><span class="id" title="variable">State</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#Error:33"><span class="id" title="variable">Error</span></a>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#bstate:26"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#caddrA:27"><span class="id" title="variable">caddrA</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.InterContractCommunication.html#contract:38"><span class="id" title="variable">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#bstate:26"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#caddrB:28"><span class="id" title="variable">caddrB</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> (<a class="idref" href="ConCert.Execution.InterContractCommunication.html#txCallTo"><span class="id" title="definition">txCallTo</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#caddrB:28"><span class="id" title="variable">caddrB</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#trace:29"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#caddrA:27"><span class="id" title="variable">caddrA</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">deployedA</span> <span class="id" title="var">not_deployedB</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">trace_induction</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">destruct_address_eq</span>); <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>; <span class="id" title="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#undeployed_contract_no_out_txs"><span class="id" title="lemma">undeployed_contract_no_out_txs</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">not_deployed</span>; <span class="id" title="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">not_deployed</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">not_deployed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="no_incoming_calls_from_undeployed_contract" class="idref" href="#no_incoming_calls_from_undeployed_contract"><span class="id" title="lemma">no_incoming_calls_from_undeployed_contract</span></a> : <span class="id" title="keyword">forall</span> <a id="bstate:39" class="idref" href="#bstate:39"><span class="id" title="binder">bstate</span></a> <a id="caddrA:40" class="idref" href="#caddrA:40"><span class="id" title="binder">caddrA</span></a> <a id="caddrB:41" class="idref" href="#caddrB:41"><span class="id" title="binder">caddrB</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="trace:42" class="idref" href="#trace:42"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#bstate:39"><span class="id" title="variable">bstate</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="Setup:43" class="idref" href="#Setup:43"><span class="id" title="binder">Setup</span></a> <a id="Msg:44" class="idref" href="#Msg:44"><span class="id" title="binder">Msg</span></a> <a id="State:45" class="idref" href="#State:45"><span class="id" title="binder">State</span></a> <a id="Error:46" class="idref" href="#Error:46"><span class="id" title="binder">Error</span></a> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H:47" class="idref" href="#H:47"><span class="id" title="binder">Serializable</span></a> <a id="H:47" class="idref" href="#H:47"><span class="id" title="binder">Setup</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H0:48" class="idref" href="#H0:48"><span class="id" title="binder">Serializable</span></a> <a id="H0:48" class="idref" href="#H0:48"><span class="id" title="binder">Msg</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H1:49" class="idref" href="#H1:49"><span class="id" title="binder">Serializable</span></a> <a id="H1:49" class="idref" href="#H1:49"><span class="id" title="binder">State</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H2:50" class="idref" href="#H2:50"><span class="id" title="binder">Serializable</span></a> <a id="H2:50" class="idref" href="#H2:50"><span class="id" title="binder">Error</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="contract:51" class="idref" href="#contract:51"><span class="id" title="binder">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Contract"><span class="id" title="record">Contract</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#Setup:43"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#Msg:44"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#State:45"><span class="id" title="variable">State</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#Error:46"><span class="id" title="variable">Error</span></a>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#bstate:39"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#caddrA:40"><span class="id" title="variable">caddrA</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#caddrA:40"><span class="id" title="variable">caddrA</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#bstate:39"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#caddrB:41"><span class="id" title="variable">caddrB</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.InterContractCommunication.html#contract:51"><span class="id" title="variable">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="inc_calls:52" class="idref" href="#inc_calls:52"><span class="id" title="binder">inc_calls</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#Msg:44"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#trace:42"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#caddrB:41"><span class="id" title="variable">caddrB</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#inc_calls:52"><span class="id" title="variable">inc_calls</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> (<a class="idref" href="ConCert.Execution.InterContractCommunication.html#callFrom"><span class="id" title="definition">callFrom</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#caddrA:40"><span class="id" title="variable">caddrA</span></a>) <a class="idref" href="ConCert.Execution.InterContractCommunication.html#inc_calls:52"><span class="id" title="variable">inc_calls</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">not_deployedA</span> <span class="id" title="var">A_is_contract</span> <span class="id" title="var">deployedB</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">trace_induction</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#undeployed_contract_no_in_calls"><span class="id" title="lemma">undeployed_contract_no_in_calls</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployedB</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#wc_receive_strong"><span class="id" title="lemma">wc_receive_strong</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span> <span class="id" title="keyword">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">prev_state'</span> &amp; <span class="id" title="var">msg'</span> &amp; <span class="id" title="var">new_state'</span> &amp; <span class="id" title="var">serialize_prev_state</span> &amp; <span class="id" title="var">msg_ser</span> &amp; <span class="id" title="var">serialize_new_state</span> &amp; <span class="id" title="var">receive_some</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> (? &amp; <span class="id" title="var">calls</span> &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#undeployed_contract_no_out_queue"><span class="id" title="lemma">undeployed_contract_no_out_queue</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">not_deployedA</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_prev</span> <span class="id" title="tactic">in</span> <span class="id" title="var">not_deployedA</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg'</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">msg_ser</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <span class="id" title="var">msg_ser</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">calls</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#callFrom"><span class="id" title="definition">callFrom</span></a>; <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall_inv"><span class="id" title="lemma">Forall_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">not_deployedA</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_refl"><span class="id" title="lemma">address_eq_refl</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">not_deployedA</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="contract_call_info_to_tx" class="idref" href="#contract_call_info_to_tx"><span class="id" title="definition">contract_call_info_to_tx</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="X:53" class="idref" href="#X:53"><span class="id" title="binder">X</span></a> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H:54" class="idref" href="#H:54"><span class="id" title="binder">Serializable</span></a> <a id="H:54" class="idref" href="#H:54"><span class="id" title="binder">X</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="caddr:55" class="idref" href="#caddr:55"><span class="id" title="binder">caddr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="call_info:56" class="idref" href="#call_info:56"><span class="id" title="binder">call_info</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallInfo"><span class="id" title="record">ContractCallInfo</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#X:53"><span class="id" title="variable">X</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="ConCert.Execution.Blockchain.html#Tx"><span class="id" title="record">Tx</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="body:57" class="idref" href="#body:57"><span class="id" title="binder">body</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#call_info:56"><span class="id" title="variable">call_info</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#call_msg"><span class="id" title="projection">call_msg</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<span class="id" title="var">msg</span>) =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#tx_call"><span class="id" title="constructor">tx_call</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> <span class="id" title="var">msg</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#tx_call"><span class="id" title="constructor">tx_call</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#tx_origin"><span class="id" title="projection">tx_origin</span></a> := <a class="idref" href="ConCert.Execution.InterContractCommunication.html#call_info:56"><span class="id" title="variable">call_info</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#call_origin"><span class="id" title="projection">call_origin</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#tx_from"><span class="id" title="projection">tx_from</span></a> := <a class="idref" href="ConCert.Execution.InterContractCommunication.html#call_info:56"><span class="id" title="variable">call_info</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#call_from"><span class="id" title="projection">call_from</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#tx_to"><span class="id" title="projection">tx_to</span></a> := <a class="idref" href="ConCert.Execution.InterContractCommunication.html#caddr:55"><span class="id" title="variable">caddr</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#tx_amount"><span class="id" title="projection">tx_amount</span></a> := <a class="idref" href="ConCert.Execution.InterContractCommunication.html#call_info:56"><span class="id" title="variable">call_info</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#call_amount"><span class="id" title="projection">call_amount</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#tx_body"><span class="id" title="projection">tx_body</span></a> := <a class="idref" href="ConCert.Execution.InterContractCommunication.html#body:57"><span class="id" title="variable">body</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="tx_to_contract_call_info" class="idref" href="#tx_to_contract_call_info"><span class="id" title="definition">tx_to_contract_call_info</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="X:58" class="idref" href="#X:58"><span class="id" title="binder">X</span></a> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H:59" class="idref" href="#H:59"><span class="id" title="binder">Serializable</span></a> <a id="H:59" class="idref" href="#H:59"><span class="id" title="binder">X</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="tx:60" class="idref" href="#tx:60"><span class="id" title="binder">tx</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Tx"><span class="id" title="record">Tx</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallInfo"><span class="id" title="record">ContractCallInfo</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#X:58"><span class="id" title="variable">X</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#tx:60"><span class="id" title="variable">tx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#tx_body"><span class="id" title="projection">tx_body</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#tx_call"><span class="id" title="constructor">tx_call</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#call_origin"><span class="id" title="projection">call_origin</span></a> := <a class="idref" href="ConCert.Execution.InterContractCommunication.html#tx:60"><span class="id" title="variable">tx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#tx_origin"><span class="id" title="projection">tx_origin</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#call_from"><span class="id" title="projection">call_from</span></a> := <a class="idref" href="ConCert.Execution.InterContractCommunication.html#tx:60"><span class="id" title="variable">tx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#tx_from"><span class="id" title="projection">tx_from</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#call_amount"><span class="id" title="projection">call_amount</span></a> := <a class="idref" href="ConCert.Execution.InterContractCommunication.html#tx:60"><span class="id" title="variable">tx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#tx_amount"><span class="id" title="projection">tx_amount</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#call_msg"><span class="id" title="projection">call_msg</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#tx_call"><span class="id" title="constructor">tx_call</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">m</span>) =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#call_origin"><span class="id" title="projection">call_origin</span></a> := <a class="idref" href="ConCert.Execution.InterContractCommunication.html#tx:60"><span class="id" title="variable">tx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#tx_origin"><span class="id" title="projection">tx_origin</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#call_from"><span class="id" title="projection">call_from</span></a> := <a class="idref" href="ConCert.Execution.InterContractCommunication.html#tx:60"><span class="id" title="variable">tx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#tx_from"><span class="id" title="projection">tx_from</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#call_amount"><span class="id" title="projection">call_amount</span></a> := <a class="idref" href="ConCert.Execution.InterContractCommunication.html#tx:60"><span class="id" title="variable">tx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#tx_amount"><span class="id" title="projection">tx_amount</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#call_msg"><span class="id" title="projection">call_msg</span></a> := @<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#X:58"><span class="id" title="variable">X</span></a> <span class="id" title="var">_</span> <span class="id" title="var">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="incomming_eq_outgoing" class="idref" href="#incomming_eq_outgoing"><span class="id" title="lemma">incomming_eq_outgoing</span></a> : <span class="id" title="keyword">forall</span> <a id="bstate:61" class="idref" href="#bstate:61"><span class="id" title="binder">bstate</span></a> <a id="caddrA:62" class="idref" href="#caddrA:62"><span class="id" title="binder">caddrA</span></a> <a id="caddrB:63" class="idref" href="#caddrB:63"><span class="id" title="binder">caddrB</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="trace:64" class="idref" href="#trace:64"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#bstate:61"><span class="id" title="variable">bstate</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="SetupA:65" class="idref" href="#SetupA:65"><span class="id" title="binder">SetupA</span></a> <a id="MsgA:66" class="idref" href="#MsgA:66"><span class="id" title="binder">MsgA</span></a> <a id="StateA:67" class="idref" href="#StateA:67"><span class="id" title="binder">StateA</span></a> <a id="ErrorA:68" class="idref" href="#ErrorA:68"><span class="id" title="binder">ErrorA</span></a> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="SetupB:69" class="idref" href="#SetupB:69"><span class="id" title="binder">SetupB</span></a> <a id="MsgB:70" class="idref" href="#MsgB:70"><span class="id" title="binder">MsgB</span></a> <a id="StateB:71" class="idref" href="#StateB:71"><span class="id" title="binder">StateB</span></a> <a id="ErrorB:72" class="idref" href="#ErrorB:72"><span class="id" title="binder">ErrorB</span></a> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H:73" class="idref" href="#H:73"><span class="id" title="binder">Serializable</span></a> <a id="H:73" class="idref" href="#H:73"><span class="id" title="binder">SetupA</span></a>} `{<a id="H0:74" class="idref" href="#H0:74"><span class="id" title="binder">Serializable</span></a> <a id="H0:74" class="idref" href="#H0:74"><span class="id" title="binder">SetupB</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H1:75" class="idref" href="#H1:75"><span class="id" title="binder">Serializable</span></a> <a id="H1:75" class="idref" href="#H1:75"><span class="id" title="binder">MsgA</span></a>} `{<a id="H2:76" class="idref" href="#H2:76"><span class="id" title="binder">Serializable</span></a> <a id="H2:76" class="idref" href="#H2:76"><span class="id" title="binder">MsgB</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H3:77" class="idref" href="#H3:77"><span class="id" title="binder">Serializable</span></a> <a id="H3:77" class="idref" href="#H3:77"><span class="id" title="binder">StateA</span></a>} `{<a id="H4:78" class="idref" href="#H4:78"><span class="id" title="binder">Serializable</span></a> <a id="H4:78" class="idref" href="#H4:78"><span class="id" title="binder">StateB</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H5:79" class="idref" href="#H5:79"><span class="id" title="binder">Serializable</span></a> <a id="H5:79" class="idref" href="#H5:79"><span class="id" title="binder">ErrorA</span></a>} `{<a id="H6:80" class="idref" href="#H6:80"><span class="id" title="binder">Serializable</span></a> <a id="H6:80" class="idref" href="#H6:80"><span class="id" title="binder">ErrorB</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="contractA:81" class="idref" href="#contractA:81"><span class="id" title="binder">contractA</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Contract"><span class="id" title="record">Contract</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#SetupA:65"><span class="id" title="variable">SetupA</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#MsgA:66"><span class="id" title="variable">MsgA</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#StateA:67"><span class="id" title="variable">StateA</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#ErrorA:68"><span class="id" title="variable">ErrorA</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="contractB:82" class="idref" href="#contractB:82"><span class="id" title="binder">contractB</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Contract"><span class="id" title="record">Contract</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#SetupB:69"><span class="id" title="variable">SetupB</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#MsgB:70"><span class="id" title="variable">MsgB</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#StateB:71"><span class="id" title="variable">StateB</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#ErrorB:72"><span class="id" title="variable">ErrorB</span></a>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <a id="x:83" class="idref" href="#x:83"><span class="id" title="binder">x</span></a> (<a id="y:84" class="idref" href="#y:84"><span class="id" title="binder">y</span></a> : <a class="idref" href="ConCert.Execution.InterContractCommunication.html#MsgB:70"><span class="id" title="variable">MsgB</span></a>), <a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#x:83"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#y:84"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#x:83"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#y:84"><span class="id" title="variable">y</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#bstate:61"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#caddrA:62"><span class="id" title="variable">caddrA</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.InterContractCommunication.html#contractA:81"><span class="id" title="variable">contractA</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#bstate:61"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#caddrB:63"><span class="id" title="variable">caddrB</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.InterContractCommunication.html#contractB:82"><span class="id" title="variable">contractB</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="inc_calls:85" class="idref" href="#inc_calls:85"><span class="id" title="binder">inc_calls</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#MsgB:70"><span class="id" title="variable">MsgB</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#trace:64"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#caddrB:63"><span class="id" title="variable">caddrB</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#inc_calls:85"><span class="id" title="variable">inc_calls</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> (<a class="idref" href="ConCert.Execution.InterContractCommunication.html#txCallTo"><span class="id" title="definition">txCallTo</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#caddrB:63"><span class="id" title="variable">caddrB</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#trace:64"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#caddrA:62"><span class="id" title="variable">caddrA</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="ConCert.Execution.InterContractCommunication.html#contract_call_info_to_tx"><span class="id" title="definition">contract_call_info_to_tx</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#caddrB:63"><span class="id" title="variable">caddrB</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> (<a class="idref" href="ConCert.Execution.InterContractCommunication.html#callFrom"><span class="id" title="definition">callFrom</span></a> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#caddrA:62"><span class="id" title="variable">caddrA</span></a>) <a class="idref" href="ConCert.Execution.InterContractCommunication.html#inc_calls:85"><span class="id" title="variable">inc_calls</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">deserialize_right_inverse</span> <span class="id" title="var">deployedA</span> <span class="id" title="var">deployedB</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">trace_induction</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">apply</span> <a class="idref" href="https://metacoq.github.io/html/MetaCoq.Template.utils.MCOption.html#some_inj"><span class="id" title="lemma">MCOption.some_inj</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">deployedA</span>; <span class="id" title="tactic">subst</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">apply</span> <a class="idref" href="https://metacoq.github.io/html/MetaCoq.Template.utils.MCOption.html#some_inj"><span class="id" title="lemma">MCOption.some_inj</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">deployedB</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployedB</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">clear</span> <span class="id" title="var">deployedB</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#undeployed_contract_no_in_calls"><span class="id" title="lemma">undeployed_contract_no_in_calls</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#undeployed_contract_no_out_txs"><span class="id" title="lemma">undeployed_contract_no_out_txs</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">not_deployed</span> <span class="id" title="keyword">as</span> <span class="id" title="var">no_txs</span>; <span class="id" title="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">no_txs</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">no_txs</span>); <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#no_outgoing_txs_to_undeployed_contract"><span class="id" title="lemma">no_outgoing_txs_to_undeployed_contract</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">not_deployed</span> <span class="id" title="keyword">as</span> <span class="id" title="var">no_txs</span>; <span class="id" title="var">cycle</span> -1; <span class="id" title="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">no_txs</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">no_txs</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#no_incoming_calls_from_undeployed_contract"><span class="id" title="lemma">no_incoming_calls_from_undeployed_contract</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">not_deployed</span>; <span class="id" title="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">not_deployed</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">calls</span> &amp; <span class="id" title="var">inc_calls_eq</span> &amp; <span class="id" title="var">calls_eq</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">calls</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">inc_calls_eq</span>, <span class="id" title="var">calls_eq</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="tactic">exists</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployedB</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#wc_receive_strong"><span class="id" title="lemma">wc_receive_strong</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span> <span class="id" title="keyword">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">prev_state'</span> &amp; <span class="id" title="var">msg'</span> &amp; <span class="id" title="var">new_state'</span> &amp; <span class="id" title="var">serialize_prev_state</span> &amp; <span class="id" title="var">msg_ser</span> &amp; <span class="id" title="var">serialize_new_state</span> &amp; <span class="id" title="var">receive_some</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> (? &amp; <span class="id" title="var">calls</span> &amp; <span class="id" title="var">IH</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg'</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">msg_ser</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <span class="id" title="var">msg_ser</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">calls</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#callFrom"><span class="id" title="definition">callFrom</span></a> <span class="id" title="tactic">in</span> *; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_refl"><span class="id" title="lemma">address_eq_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#contract_call_info_to_tx"><span class="id" title="definition">contract_call_info_to_tx</span></a>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 4 <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">deserialize_right_inverse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#callFrom"><span class="id" title="definition">callFrom</span></a> <span class="id" title="tactic">in</span> *; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_refl"><span class="id" title="lemma">address_eq_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployedB</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#wc_receive_strong"><span class="id" title="lemma">wc_receive_strong</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span> <span class="id" title="keyword">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">prev_state'</span> &amp; <span class="id" title="var">msg'</span> &amp; <span class="id" title="var">new_state'</span> &amp; <span class="id" title="var">serialize_prev_state</span> &amp; <span class="id" title="var">msg_ser</span> &amp; <span class="id" title="var">serialize_new_state</span> &amp; <span class="id" title="var">receive_some</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> (? &amp; <span class="id" title="var">calls</span> &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg'</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">msg_ser</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <span class="id" title="var">msg_ser</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">calls</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#callFrom"><span class="id" title="definition">callFrom</span></a>; <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">destruct_address_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_ne"><span class="id" title="lemma">address_eq_ne</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#InterContractCommunication"><span class="id" title="section">InterContractCommunication</span></a>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="https://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a> and <a href="https://github.com/jgallen23/toc">TOC</a>
</div>
</div>
<script>
  const elements = document.getElementsByClassName("libtitle");
  while(elements.length > 0){
        elements[0].parentNode.removeChild(elements[0]);
  }
  if (window.location.pathname.endsWith("/toc.html")) {
      const jstocDiv = document.getElementById("js-toc");
      jstocDiv.classList.remove("toc");
      jstocDiv.classList.add("jstoc-hidden");
      const jstocHeaderDiv = document.getElementById("js-toc-header");
      jstocHeaderDiv.classList.add("jstoc-hidden");
      const mainDiv = document.getElementById("main");
      mainDiv.classList.add("jstoc-hidden-main");
      const toggleDiv = document.getElementById("toggle-toc");
      toggleDiv.classList.add("jstoc-hidden");
  }
  console.log(window.location.pathname);
</script>
<script type="text/javascript" src="toc.js"></script>
</body>

</html>
