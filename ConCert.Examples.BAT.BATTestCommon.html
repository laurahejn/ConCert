<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<link href="toc.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
      <span id="toggle-toc">Contents</span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="https://github.com/AU-COBRA/ConCert" target="_balnk">Project Page</a>
      <a href="index.html">Index</a>
      <a href="toc.html">Table of contents</a>
    </span>
</div>
  <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="js-toc" class="toc" data-toc="h1,h2,h3,h4" data-toc-container="doc" data-toc-offset="-40">
      <div id="js-toc-header" class="toc-header">Contents:</div>
    </div>
    <div id="main">
<h1 class="libtitle">Library ConCert.Examples.BAT.BATTestCommon</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Utils.Extras.html#"><span class="id" title="library">Extras</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Blockchain.html#"><span class="id" title="library">Blockchain</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.BoundedN.html#"><span class="id" title="library">BoundedN</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Containers.html#"><span class="id" title="library">Containers</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Serializable.html#"><span class="id" title="library">Serializable</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution.Test</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Test.QCTest.html#"><span class="id" title="library">QCTest</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Examples.BAT</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#"><span class="id" title="library">BATCommon</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Examples.BAT</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#"><span class="id" title="library">BATGens</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Examples.BAT</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Examples.BAT.BATPrinters.html#"><span class="id" title="library">BATPrinters</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#"><span class="id" title="library">List</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.ZArith_base.html#"><span class="id" title="library">ZArith_base</span></a>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ListNotations"><span class="id" title="module">ListNotations</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="contract_base_addr" class="idref" href="#contract_base_addr"><span class="id" title="definition">contract_base_addr</span></a> := <a class="idref" href="ConCert.Execution.Test.TestUtils.html#addr_of_Z"><span class="id" title="definition">addr_of_Z</span></a> 128%<span class="id" title="var">Z</span>.<br/>
<span class="id" title="keyword">Definition</span> <a id="ethFund" class="idref" href="#ethFund"><span class="id" title="definition">ethFund</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> := <a class="idref" href="ConCert.Execution.Test.TestUtils.html#addr_of_Z"><span class="id" title="definition">addr_of_Z</span></a> 16%<span class="id" title="var">Z</span>.<br/>
<span class="id" title="keyword">Definition</span> <a id="batFund" class="idref" href="#batFund"><span class="id" title="definition">batFund</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> := <a class="idref" href="ConCert.Execution.Test.TestUtils.html#addr_of_Z"><span class="id" title="definition">addr_of_Z</span></a> 17%<span class="id" title="var">Z</span>.<br/>
<span class="id" title="keyword">Definition</span> <a id="initSupply_" class="idref" href="#initSupply_"><span class="id" title="definition">initSupply_</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a> := 20%<span class="id" title="var">N</span>.<br/>
<span class="id" title="keyword">Definition</span> <a id="exchangeRate_" class="idref" href="#exchangeRate_"><span class="id" title="definition">exchangeRate_</span></a> := 3%<span class="id" title="var">N</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> <a id="596d5f8b6c949e77dfd7dde509541b85" class="idref" href="#596d5f8b6c949e77dfd7dde509541b85"><span class="id" title="notation">&quot;</span></a>f '|||' g" := (<span class="id" title="keyword">fun</span> <a id="a:1" class="idref" href="#a:1"><span class="id" title="binder">a</span></a> <a id="b:2" class="idref" href="#b:2"><span class="id" title="binder">b</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">(</span></a><span class="id" title="var">f</span> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#a:1"><span class="id" title="variable">a</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#b:2"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">||</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">(</span></a><span class="id" title="var">g</span> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#a:1"><span class="id" title="variable">a</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#b:2"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">)</span></a>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 10).<br/>
<span class="id" title="keyword">Notation</span> <a id=":::x_'&amp;&amp;&amp;'_x" class="idref" href="#:::x_'&amp;&amp;&amp;'_x"><span class="id" title="notation">&quot;</span></a>f '&amp;&amp;&amp;' g" := (<span class="id" title="keyword">fun</span> <a id="a:3" class="idref" href="#a:3"><span class="id" title="binder">a</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">(</span></a><span class="id" title="var">f</span> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#a:3"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">(</span></a><span class="id" title="var">g</span> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#a:3"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">)</span></a>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 10).<br/>

<br/>
<span class="comment">(*&nbsp;Get&nbsp;value&nbsp;of&nbsp;isFinalized&nbsp;in&nbsp;last&nbsp;state&nbsp;of&nbsp;a&nbsp;chain&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="get_chain_finalized" class="idref" href="#get_chain_finalized"><span class="id" title="definition">get_chain_finalized</span></a> (<a id="cb:4" class="idref" href="#cb:4"><span class="id" title="binder">cb</span></a> : <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#get_contract_state"><span class="id" title="definition">get_contract_state</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">BATCommon.State</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#builder_env"><span class="id" title="method">builder_env</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#cb:4"><span class="id" title="variable">cb</span></a>) <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#contract_base_addr"><span class="id" title="definition">contract_base_addr</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">state</span> =&gt; <span class="id" title="var">state</span>.(<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#isFinalized"><span class="id" title="projection">isFinalized</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Get&nbsp;chain&nbsp;length&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="get_chain_height" class="idref" href="#get_chain_height"><span class="id" title="definition">get_chain_height</span></a> (<a id="cb:5" class="idref" href="#cb:5"><span class="id" title="binder">cb</span></a> : <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#builder_env"><span class="id" title="method">builder_env</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#cb:5"><span class="id" title="variable">cb</span></a>).(<a class="idref" href="ConCert.Execution.Blockchain.html#chain_height"><span class="id" title="projection">chain_height</span></a>).<br/>

<br/>
<span class="comment">(*&nbsp;Check&nbsp;if&nbsp;an&nbsp;action&nbsp;is&nbsp;finalize&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="action_is_finalize" class="idref" href="#action_is_finalize"><span class="id" title="definition">action_is_finalize</span></a> (<a id="action:6" class="idref" href="#action:6"><span class="id" title="binder">action</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#action:6"><span class="id" title="variable">action</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#act_body"><span class="id" title="projection">act_body</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">Blockchain.act_transfer</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_deploy"><span class="id" title="constructor">Blockchain.act_deploy</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">Blockchain.act_call</span></a> <span class="id" title="var">to</span> <span class="id" title="var">_</span> <span class="id" title="var">msg</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> <span class="id" title="var">to</span> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#contract_base_addr"><span class="id" title="definition">contract_base_addr</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> @<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#Msg"><span class="id" title="inductive">BATCommon.Msg</span></a> <span class="id" title="var">_</span> <span class="id" title="var">msg</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#finalize"><span class="id" title="constructor">finalize</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Check&nbsp;if&nbsp;an&nbsp;action&nbsp;is&nbsp;refund&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="action_is_refund" class="idref" href="#action_is_refund"><span class="id" title="definition">action_is_refund</span></a> (<a id="action:7" class="idref" href="#action:7"><span class="id" title="binder">action</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#action:7"><span class="id" title="variable">action</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#act_body"><span class="id" title="projection">act_body</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">Blockchain.act_transfer</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_deploy"><span class="id" title="constructor">Blockchain.act_deploy</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">Blockchain.act_call</span></a> <span class="id" title="var">to</span> <span class="id" title="var">_</span> <span class="id" title="var">msg</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> <span class="id" title="var">to</span> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#contract_base_addr"><span class="id" title="definition">contract_base_addr</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> @<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#Msg"><span class="id" title="inductive">BATCommon.Msg</span></a> <span class="id" title="var">_</span> <span class="id" title="var">msg</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#refund"><span class="id" title="constructor">refund</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Get&nbsp;last&nbsp;state&nbsp;before&nbsp;finalize/refund&nbsp;in&nbsp;a&nbsp;chain&nbsp;*)</span><br/>
<span class="id" title="keyword">Fixpoint</span> <a id="get_last_funding_state" class="idref" href="#get_last_funding_state"><span class="id" title="definition">get_last_funding_state</span></a> {<a id="from:8" class="idref" href="#from:8"><span class="id" title="binder">from</span></a> <a id="to:9" class="idref" href="#to:9"><span class="id" title="binder">to</span></a>} (<a id="trace:10" class="idref" href="#trace:10"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#from:8"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#to:9"><span class="id" title="variable">to</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="default:11" class="idref" href="#default:11"><span class="id" title="binder">default</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#trace:10"><span class="id" title="variable">trace</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ChainedList.html#snoc"><span class="id" title="constructor">ChainedList.snoc</span></a> <span class="id" title="var">trace'</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#step_action"><span class="id" title="constructor">Blockchain.step_action</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">act</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="keyword">as</span> <span class="id" title="var">step</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#action_is_finalize"><span class="id" title="definition">action_is_finalize</span></a> <span class="id" title="var">act</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> (<a class="idref" href="ConCert.Execution.Test.TestUtils.html#chainstep_states"><span class="id" title="definition">chainstep_states</span></a> <span class="id" title="var">step</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#action_is_refund"><span class="id" title="definition">action_is_refund</span></a> <span class="id" title="var">act</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#get_last_funding_state:12"><span class="id" title="definition">get_last_funding_state</span></a> <span class="id" title="var">trace'</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> (<a class="idref" href="ConCert.Execution.Test.TestUtils.html#chainstep_states"><span class="id" title="definition">chainstep_states</span></a> <span class="id" title="var">step</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#get_last_funding_state:12"><span class="id" title="definition">get_last_funding_state</span></a> <span class="id" title="var">trace'</span> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#default:11"><span class="id" title="variable">default</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ChainedList.html#snoc"><span class="id" title="constructor">ChainedList.snoc</span></a> <span class="id" title="var">trace'</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#get_last_funding_state:12"><span class="id" title="definition">get_last_funding_state</span></a> <span class="id" title="var">trace'</span> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#default:11"><span class="id" title="variable">default</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ChainedList.html#clnil"><span class="id" title="constructor">ChainedList.clnil</span></a> =&gt; <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#default:11"><span class="id" title="variable">default</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Get&nbsp;the&nbsp;number&nbsp;of&nbsp;tokens&nbsp;in&nbsp;last&nbsp;state&nbsp;before&nbsp;finalize/refund&nbsp;in&nbsp;a&nbsp;chain&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="get_chain_tokens" class="idref" href="#get_chain_tokens"><span class="id" title="definition">get_chain_tokens</span></a> (<a id="cb:14" class="idref" href="#cb:14"><span class="id" title="binder">cb</span></a> : <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a>) : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#TokenValue"><span class="id" title="definition">TokenValue</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="cs:15" class="idref" href="#cs:15"><span class="id" title="binder">cs</span></a> := <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#get_last_funding_state"><span class="id" title="definition">get_last_funding_state</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#builder_trace"><span class="id" title="method">builder_trace</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#cb:14"><span class="id" title="variable">cb</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#get_contract_state"><span class="id" title="definition">get_contract_state</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">BATCommon.State</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#cs:15"><span class="id" title="variable">cs</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#contract_base_addr"><span class="id" title="definition">contract_base_addr</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">state</span> =&gt; (<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#total_supply"><span class="id" title="definition">total_supply</span></a> <span class="id" title="var">state</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; 0%<span class="id" title="var">N</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="fmap_subseteqb" class="idref" href="#fmap_subseteqb"><span class="id" title="definition">fmap_subseteqb</span></a> {<a id="A:16" class="idref" href="#A:16"><span class="id" title="binder">A</span></a> <a id="B:17" class="idref" href="#B:17"><span class="id" title="binder">B</span></a>} `{<a id="H:19" class="idref" href="#H:19"><span class="id" title="binder">countable.Countable</span></a> <a id="H:19" class="idref" href="#H:19"><span class="id" title="binder">A</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="eqb:20" class="idref" href="#eqb:20"><span class="id" title="binder">eqb</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#B:17"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#B:17"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>) (<a id="fmap:21" class="idref" href="#fmap:21"><span class="id" title="binder">fmap</span></a> : <a class="idref" href="ConCert.Execution.Containers.html#FMap"><span class="id" title="abbreviation">FMap</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#A:16"><span class="id" title="variable">A</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#B:17"><span class="id" title="variable">B</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="fmap':22" class="idref" href="#fmap':22"><span class="id" title="binder">fmap'</span></a> : <a class="idref" href="ConCert.Execution.Containers.html#FMap"><span class="id" title="abbreviation">FMap</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#A:16"><span class="id" title="variable">A</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#B:17"><span class="id" title="variable">B</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="elements:23" class="idref" href="#elements:23"><span class="id" title="binder">elements</span></a> := <a class="idref" href="ConCert.Execution.Containers.html#FMap.elements"><span class="id" title="abbreviation">FMap.elements</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#fmap:21"><span class="id" title="variable">fmap</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#fold_left"><span class="id" title="definition">fold_left</span></a> (<span class="id" title="keyword">fun</span> <a id="b:24" class="idref" href="#b:24"><span class="id" title="binder">b</span></a> <a id="elem:25" class="idref" href="#elem:25"><span class="id" title="binder">elem</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.lookup"><span class="id" title="abbreviation">FMap.lookup</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#elem:25"><span class="id" title="variable">elem</span></a>) <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#fmap':22"><span class="id" title="variable">fmap'</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">v</span> =&gt; <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#b:24"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#eqb:20"><span class="id" title="variable">eqb</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#elem:25"><span class="id" title="variable">elem</span></a>) <span class="id" title="var">v</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>) <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#elements:23"><span class="id" title="variable">elements</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="fmap_eqb" class="idref" href="#fmap_eqb"><span class="id" title="definition">fmap_eqb</span></a> {<a id="A:26" class="idref" href="#A:26"><span class="id" title="binder">A</span></a> <a id="B:27" class="idref" href="#B:27"><span class="id" title="binder">B</span></a>} `{<a id="H:29" class="idref" href="#H:29"><span class="id" title="binder">countable.Countable</span></a> <a id="H:29" class="idref" href="#H:29"><span class="id" title="binder">A</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="eqb:30" class="idref" href="#eqb:30"><span class="id" title="binder">eqb</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#B:27"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#B:27"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>) (<a id="fmap:31" class="idref" href="#fmap:31"><span class="id" title="binder">fmap</span></a> : <a class="idref" href="ConCert.Execution.Containers.html#FMap"><span class="id" title="abbreviation">FMap</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#A:26"><span class="id" title="variable">A</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#B:27"><span class="id" title="variable">B</span></a>) (<a id="fmap':32" class="idref" href="#fmap':32"><span class="id" title="binder">fmap'</span></a> : <a class="idref" href="ConCert.Execution.Containers.html#FMap"><span class="id" title="abbreviation">FMap</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#A:26"><span class="id" title="variable">A</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#B:27"><span class="id" title="variable">B</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#fmap_subseteqb"><span class="id" title="definition">fmap_subseteqb</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#eqb:30"><span class="id" title="variable">eqb</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#fmap:31"><span class="id" title="variable">fmap</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#fmap':32"><span class="id" title="variable">fmap'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#fmap_subseteqb"><span class="id" title="definition">fmap_subseteqb</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#eqb:30"><span class="id" title="variable">eqb</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#fmap':32"><span class="id" title="variable">fmap'</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#fmap:31"><span class="id" title="variable">fmap</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">)</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="fmap_filter_eqb" class="idref" href="#fmap_filter_eqb"><span class="id" title="definition">fmap_filter_eqb</span></a> {<a id="A:33" class="idref" href="#A:33"><span class="id" title="binder">A</span></a> <a id="B:34" class="idref" href="#B:34"><span class="id" title="binder">B</span></a>} `{<a id="H:36" class="idref" href="#H:36"><span class="id" title="binder">countable.Countable</span></a> <a id="H:36" class="idref" href="#H:36"><span class="id" title="binder">A</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="excluded:37" class="idref" href="#excluded:37"><span class="id" title="binder">excluded</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#A:33"><span class="id" title="variable">A</span></a>) (<a id="eqb:38" class="idref" href="#eqb:38"><span class="id" title="binder">eqb</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#B:34"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#B:34"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="fmap:39" class="idref" href="#fmap:39"><span class="id" title="binder">fmap</span></a> : <a class="idref" href="ConCert.Execution.Containers.html#FMap"><span class="id" title="abbreviation">FMap</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#A:33"><span class="id" title="variable">A</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#B:34"><span class="id" title="variable">B</span></a>) (<a id="fmap':40" class="idref" href="#fmap':40"><span class="id" title="binder">fmap'</span></a> : <a class="idref" href="ConCert.Execution.Containers.html#FMap"><span class="id" title="abbreviation">FMap</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#A:33"><span class="id" title="variable">A</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#B:34"><span class="id" title="variable">B</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="map_filter:45" class="idref" href="#map_filter:45"><span class="id" title="binder">map_filter</span></a> <a id="m:41" class="idref" href="#m:41"><span class="id" title="binder">m</span></a> <a id="l:42" class="idref" href="#l:42"><span class="id" title="binder">l</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#fold_left"><span class="id" title="definition">fold_left</span></a> (<span class="id" title="keyword">fun</span> <a id="map:43" class="idref" href="#map:43"><span class="id" title="binder">map</span></a> <a id="elem:44" class="idref" href="#elem:44"><span class="id" title="binder">elem</span></a> =&gt; <a class="idref" href="ConCert.Execution.Containers.html#FMap.remove"><span class="id" title="abbreviation">FMap.remove</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#elem:44"><span class="id" title="variable">elem</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#map:43"><span class="id" title="variable">map</span></a>) <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#l:42"><span class="id" title="variable">l</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#m:41"><span class="id" title="variable">m</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="fmap_filtered:46" class="idref" href="#fmap_filtered:46"><span class="id" title="binder">fmap_filtered</span></a> := <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#map_filter:45"><span class="id" title="variable">map_filter</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#fmap:39"><span class="id" title="variable">fmap</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#excluded:37"><span class="id" title="variable">excluded</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="fmap'_filtered:47" class="idref" href="#fmap'_filtered:47"><span class="id" title="binder">fmap'_filtered</span></a> := <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#map_filter:45"><span class="id" title="variable">map_filter</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#fmap':40"><span class="id" title="variable">fmap'</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#excluded:37"><span class="id" title="variable">excluded</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#fmap_eqb"><span class="id" title="definition">fmap_eqb</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#eqb:38"><span class="id" title="variable">eqb</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#fmap_filtered:46"><span class="id" title="variable">fmap_filtered</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#fmap'_filtered:47"><span class="id" title="variable">fmap'_filtered</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="get_balance" class="idref" href="#get_balance"><span class="id" title="definition">get_balance</span></a> (<a id="state:48" class="idref" href="#state:48"><span class="id" title="binder">state</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">BATCommon.State</span></a>) (<a id="addr:49" class="idref" href="#addr:49"><span class="id" title="binder">addr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0%<span class="id" title="var">N</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#addr:49"><span class="id" title="variable">addr</span></a> (<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#balances"><span class="id" title="definition">balances</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#state:48"><span class="id" title="variable">state</span></a>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="msg_is_eip_msg" class="idref" href="#msg_is_eip_msg"><span class="id" title="definition">msg_is_eip_msg</span></a> (<a id="cstate:50" class="idref" href="#cstate:50"><span class="id" title="binder">cstate</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">BATCommon.State</span></a>) (<a id="msg:51" class="idref" href="#msg:51"><span class="id" title="binder">msg</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#Msg"><span class="id" title="inductive">BATCommon.Msg</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#msg:51"><span class="id" title="variable">msg</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#tokenMsg"><span class="id" title="constructor">tokenMsg</span></a> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="msg_is_transfer" class="idref" href="#msg_is_transfer"><span class="id" title="definition">msg_is_transfer</span></a> (<a id="cstate:53" class="idref" href="#cstate:53"><span class="id" title="binder">cstate</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">BATCommon.State</span></a>) (<a id="msg:54" class="idref" href="#msg:54"><span class="id" title="binder">msg</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#Msg"><span class="id" title="inductive">BATCommon.Msg</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#msg:54"><span class="id" title="variable">msg</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#tokenMsg"><span class="id" title="constructor">tokenMsg</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#transfer"><span class="id" title="constructor">EIP20Token.transfer</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="msg_is_transfer_from" class="idref" href="#msg_is_transfer_from"><span class="id" title="definition">msg_is_transfer_from</span></a> (<a id="cstate:56" class="idref" href="#cstate:56"><span class="id" title="binder">cstate</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">BATCommon.State</span></a>) (<a id="msg:57" class="idref" href="#msg:57"><span class="id" title="binder">msg</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#Msg"><span class="id" title="inductive">BATCommon.Msg</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#msg:57"><span class="id" title="variable">msg</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#tokenMsg"><span class="id" title="constructor">tokenMsg</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#transfer_from"><span class="id" title="constructor">EIP20Token.transfer_from</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="msg_is_approve" class="idref" href="#msg_is_approve"><span class="id" title="definition">msg_is_approve</span></a> (<a id="cstate:59" class="idref" href="#cstate:59"><span class="id" title="binder">cstate</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">BATCommon.State</span></a>) (<a id="msg:60" class="idref" href="#msg:60"><span class="id" title="binder">msg</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#Msg"><span class="id" title="inductive">BATCommon.Msg</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#msg:60"><span class="id" title="variable">msg</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#tokenMsg"><span class="id" title="constructor">tokenMsg</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#approve"><span class="id" title="constructor">EIP20Token.approve</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="msg_is_create_tokens" class="idref" href="#msg_is_create_tokens"><span class="id" title="definition">msg_is_create_tokens</span></a> (<a id="cstate:62" class="idref" href="#cstate:62"><span class="id" title="binder">cstate</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">BATCommon.State</span></a>) (<a id="msg:63" class="idref" href="#msg:63"><span class="id" title="binder">msg</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#Msg"><span class="id" title="inductive">BATCommon.Msg</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#msg:63"><span class="id" title="variable">msg</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#create_tokens"><span class="id" title="constructor">create_tokens</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="msg_is_finalize" class="idref" href="#msg_is_finalize"><span class="id" title="definition">msg_is_finalize</span></a> (<a id="cstate:65" class="idref" href="#cstate:65"><span class="id" title="binder">cstate</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">BATCommon.State</span></a>) (<a id="msg:66" class="idref" href="#msg:66"><span class="id" title="binder">msg</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#Msg"><span class="id" title="inductive">BATCommon.Msg</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#msg:66"><span class="id" title="variable">msg</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#finalize"><span class="id" title="constructor">finalize</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="msg_is_refund" class="idref" href="#msg_is_refund"><span class="id" title="definition">msg_is_refund</span></a> (<a id="cstate:68" class="idref" href="#cstate:68"><span class="id" title="binder">cstate</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">BATCommon.State</span></a>) (<a id="msg:69" class="idref" href="#msg:69"><span class="id" title="binder">msg</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#Msg"><span class="id" title="inductive">BATCommon.Msg</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#msg:69"><span class="id" title="variable">msg</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#refund"><span class="id" title="constructor">refund</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Checker&nbsp;failing&nbsp;if&nbsp;amount&nbsp;in&nbsp;a&nbsp;contract&nbsp;call&nbsp;context&nbsp;is&nbsp;not&nbsp;zero&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="amount_is_zero" class="idref" href="#amount_is_zero"><span class="id" title="definition">amount_is_zero</span></a> (<a id="chain:71" class="idref" href="#chain:71"><span class="id" title="binder">chain</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a>) (<a id="cctx:72" class="idref" href="#cctx:72"><span class="id" title="binder">cctx</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallContext"><span class="id" title="record">ContractCallContext</span></a>) (<a id="old_state:73" class="idref" href="#old_state:73"><span class="id" title="binder">old_state</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">State</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="msg:74" class="idref" href="#msg:74"><span class="id" title="binder">msg</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#Msg"><span class="id" title="inductive">Msg</span></a>) (<a id="result_opt:75" class="idref" href="#result_opt:75"><span class="id" title="binder">result_opt</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">State</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>)) :=<br/>
&nbsp;&nbsp;(<span class="id" title="method">checker</span> (<a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#cctx:72"><span class="id" title="variable">cctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#f10153ef1a81fe79ed16d848b456c79b"><span class="id" title="notation">=?</span></a> 0)%<span class="id" title="var">Z</span>).<br/>

<br/>
<span class="comment">(*&nbsp;Checker&nbsp;failing&nbsp;if&nbsp;amount&nbsp;in&nbsp;a&nbsp;contract&nbsp;call&nbsp;context&nbsp;is&nbsp;0&nbsp;or&nbsp;negative&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="amount_is_positive" class="idref" href="#amount_is_positive"><span class="id" title="definition">amount_is_positive</span></a> (<a id="chain:76" class="idref" href="#chain:76"><span class="id" title="binder">chain</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a>) (<a id="cctx:77" class="idref" href="#cctx:77"><span class="id" title="binder">cctx</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallContext"><span class="id" title="record">ContractCallContext</span></a>) (<a id="old_state:78" class="idref" href="#old_state:78"><span class="id" title="binder">old_state</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">State</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="msg:79" class="idref" href="#msg:79"><span class="id" title="binder">msg</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#Msg"><span class="id" title="inductive">Msg</span></a>) (<a id="result_opt:80" class="idref" href="#result_opt:80"><span class="id" title="binder">result_opt</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">State</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>)) :=<br/>
&nbsp;&nbsp;(<span class="id" title="method">checker</span> (<a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#cctx:77"><span class="id" title="variable">cctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#0f6d3b46a03d1336a5ac68936077dc02"><span class="id" title="notation">&gt;?</span></a> 0)%<span class="id" title="var">Z</span>).<br/>

<br/>
<span class="comment">(*&nbsp;Checker&nbsp;failing&nbsp;if&nbsp;result_opt&nbsp;contains&nbsp;actions&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="produces_no_actions" class="idref" href="#produces_no_actions"><span class="id" title="definition">produces_no_actions</span></a> (<a id="chain:81" class="idref" href="#chain:81"><span class="id" title="binder">chain</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a>) (<a id="cctx:82" class="idref" href="#cctx:82"><span class="id" title="binder">cctx</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallContext"><span class="id" title="record">ContractCallContext</span></a>) (<a id="old_state:83" class="idref" href="#old_state:83"><span class="id" title="binder">old_state</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">State</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="msg:84" class="idref" href="#msg:84"><span class="id" title="binder">msg</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#Msg"><span class="id" title="inductive">Msg</span></a>) (<a id="result_opt:85" class="idref" href="#result_opt:85"><span class="id" title="binder">result_opt</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">State</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>)) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#result_opt:85"><span class="id" title="variable">result_opt</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#msg:84"><span class="id" title="variable">msg</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">),</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt; <span class="id" title="method">checker</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="method">checker</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Checker&nbsp;failing&nbsp;if&nbsp;result_opt&nbsp;contains&nbsp;less&nbsp;than&nbsp;or&nbsp;more&nbsp;than&nbsp;one&nbsp;action&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="produces_one_action" class="idref" href="#produces_one_action"><span class="id" title="definition">produces_one_action</span></a> (<a id="chain:86" class="idref" href="#chain:86"><span class="id" title="binder">chain</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a>) (<a id="cctx:87" class="idref" href="#cctx:87"><span class="id" title="binder">cctx</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallContext"><span class="id" title="record">ContractCallContext</span></a>) (<a id="old_state:88" class="idref" href="#old_state:88"><span class="id" title="binder">old_state</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">State</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="msg:89" class="idref" href="#msg:89"><span class="id" title="binder">msg</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#Msg"><span class="id" title="inductive">Msg</span></a>) (<a id="result_opt:90" class="idref" href="#result_opt:90"><span class="id" title="binder">result_opt</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">State</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>)) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#result_opt:90"><span class="id" title="variable">result_opt</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#msg:89"><span class="id" title="variable">msg</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">),</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt; <span class="id" title="method">checker</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="method">checker</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="no_transfers_from_bat_fund" class="idref" href="#no_transfers_from_bat_fund"><span class="id" title="definition">no_transfers_from_bat_fund</span></a> (<a id="cs:91" class="idref" href="#cs:91"><span class="id" title="binder">cs</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#cs:91"><span class="id" title="variable">cs</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">act</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">act</span>.(<a class="idref" href="ConCert.Execution.Blockchain.html#act_body"><span class="id" title="projection">act_body</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">Blockchain.act_call</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ser_msg</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> @<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#Msg"><span class="id" title="inductive">Msg</span></a> <span class="id" title="var">_</span> <span class="id" title="var">ser_msg</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#tokenMsg"><span class="id" title="constructor">tokenMsg</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#transfer"><span class="id" title="constructor">EIP20Token.transfer</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)) =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#negb"><span class="id" title="definition">negb</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> <span class="id" title="var">act</span>.(<a class="idref" href="ConCert.Execution.Blockchain.html#act_from"><span class="id" title="projection">act_from</span></a>) <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#batFund"><span class="id" title="definition">batFund</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#tokenMsg"><span class="id" title="constructor">tokenMsg</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#transfer_from"><span class="id" title="constructor">EIP20Token.transfer_from</span></a> <span class="id" title="var">from</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)) =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#negb"><span class="id" title="definition">negb</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> <span class="id" title="var">from</span> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#batFund"><span class="id" title="definition">batFund</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="no_batfund_create_tokens" class="idref" href="#no_batfund_create_tokens"><span class="id" title="definition">no_batfund_create_tokens</span></a> (<a id="cs:92" class="idref" href="#cs:92"><span class="id" title="binder">cs</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#cs:92"><span class="id" title="variable">cs</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">act</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">act</span>.(<a class="idref" href="ConCert.Execution.Blockchain.html#act_body"><span class="id" title="projection">act_body</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">Blockchain.act_call</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ser_msg</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> @<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#Msg"><span class="id" title="inductive">Msg</span></a> <span class="id" title="var">_</span> <span class="id" title="var">ser_msg</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#create_tokens"><span class="id" title="constructor">create_tokens</span></a>) =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#negb"><span class="id" title="definition">negb</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> <span class="id" title="var">act</span>.(<a class="idref" href="ConCert.Execution.Blockchain.html#act_from"><span class="id" title="projection">act_from</span></a>) <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#batFund"><span class="id" title="definition">batFund</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="no_transfers_to_batfund" class="idref" href="#no_transfers_to_batfund"><span class="id" title="definition">no_transfers_to_batfund</span></a> (<a id="cs:93" class="idref" href="#cs:93"><span class="id" title="binder">cs</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#cs:93"><span class="id" title="variable">cs</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">act</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">act</span>.(<a class="idref" href="ConCert.Execution.Blockchain.html#act_body"><span class="id" title="projection">act_body</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">Blockchain.act_call</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ser_msg</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> @<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#Msg"><span class="id" title="inductive">Msg</span></a> <span class="id" title="var">_</span> <span class="id" title="var">ser_msg</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#tokenMsg"><span class="id" title="constructor">tokenMsg</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#transfer"><span class="id" title="constructor">EIP20Token.transfer</span></a> <span class="id" title="var">to</span> <span class="id" title="var">_</span>)) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#negb"><span class="id" title="definition">negb</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> <span class="id" title="var">to</span> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#batFund"><span class="id" title="definition">batFund</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#tokenMsg"><span class="id" title="constructor">tokenMsg</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#transfer_from"><span class="id" title="constructor">EIP20Token.transfer_from</span></a> <span class="id" title="var">_</span> <span class="id" title="var">to</span> <span class="id" title="var">_</span>)) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#negb"><span class="id" title="definition">negb</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> <span class="id" title="var">to</span> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#batFund"><span class="id" title="definition">batFund</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="is_fully_refunded" class="idref" href="#is_fully_refunded"><span class="id" title="definition">is_fully_refunded</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <a id="cs:94" class="idref" href="#cs:94"><span class="id" title="binder">cs</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="contract_balance:95" class="idref" href="#contract_balance:95"><span class="id" title="binder">contract_balance</span></a> := <a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#cs:94"><span class="id" title="variable">cs</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#contract_base_addr"><span class="id" title="definition">contract_base_addr</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#get_contract_state"><span class="id" title="definition">get_contract_state</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">State</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#cs:94"><span class="id" title="variable">cs</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#contract_base_addr"><span class="id" title="definition">contract_base_addr</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">state</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#negb"><span class="id" title="definition">negb</span></a> <span class="id" title="var">state</span>.(<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#isFinalized"><span class="id" title="projection">isFinalized</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">state</span>.(<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#fundingEnd"><span class="id" title="projection">fundingEnd</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Arith.PeanoNat.html#6b7621b45fff0af5e2b2cbb2bc2d4e1d"><span class="id" title="notation">&lt;?</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#cs:94"><span class="id" title="variable">cs</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a>))%<span class="id" title="var">nat</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.eqb"><span class="id" title="definition">Z.eqb</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#contract_balance:95"><span class="id" title="variable">contract_balance</span></a> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="only_transfers_modulo_exhange_rate" class="idref" href="#only_transfers_modulo_exhange_rate"><span class="id" title="definition">only_transfers_modulo_exhange_rate</span></a> (<a id="cs:96" class="idref" href="#cs:96"><span class="id" title="binder">cs</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#cs:96"><span class="id" title="variable">cs</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">act</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">act</span>.(<a class="idref" href="ConCert.Execution.Blockchain.html#act_body"><span class="id" title="projection">act_body</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">Blockchain.act_call</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ser_msg</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> @<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#Msg"><span class="id" title="inductive">Msg</span></a> <span class="id" title="var">_</span> <span class="id" title="var">ser_msg</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#tokenMsg"><span class="id" title="constructor">tokenMsg</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#transfer"><span class="id" title="constructor">EIP20Token.transfer</span></a> <span class="id" title="var">_</span> <span class="id" title="var">amount</span>)) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.eqb"><span class="id" title="definition">N.eqb</span></a> 0 (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.modulo"><span class="id" title="definition">N.modulo</span></a> <span class="id" title="var">amount</span> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#exchangeRate_"><span class="id" title="definition">exchangeRate_</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#tokenMsg"><span class="id" title="constructor">tokenMsg</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#transfer_from"><span class="id" title="constructor">EIP20Token.transfer_from</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">amount</span>)) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.eqb"><span class="id" title="definition">N.eqb</span></a> 0 (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.modulo"><span class="id" title="definition">N.modulo</span></a> <span class="id" title="var">amount</span> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#exchangeRate_"><span class="id" title="definition">exchangeRate_</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="funding_period_not_over" class="idref" href="#funding_period_not_over"><span class="id" title="definition">funding_period_not_over</span></a> (<a id="setup:97" class="idref" href="#setup:97"><span class="id" title="binder">setup</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#Setup"><span class="id" title="record">Setup</span></a>) <a id="cb:98" class="idref" href="#cb:98"><span class="id" title="binder">cb</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="current_slot:99" class="idref" href="#current_slot:99"><span class="id" title="binder">current_slot</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#env_chain"><span class="id" title="projection">env_chain</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#cb:98"><span class="id" title="variable">cb</span></a>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Arith.PeanoNat.html#Nat.leb"><span class="id" title="definition">Nat.leb</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#current_slot:99"><span class="id" title="variable">current_slot</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#setup:97"><span class="id" title="variable">setup</span></a>.(<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#_fundingEnd"><span class="id" title="projection">_fundingEnd</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="funding_period_non_empty" class="idref" href="#funding_period_non_empty"><span class="id" title="definition">funding_period_non_empty</span></a> (<a id="setup:100" class="idref" href="#setup:100"><span class="id" title="binder">setup</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#Setup"><span class="id" title="record">Setup</span></a>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Arith.PeanoNat.html#Nat.leb"><span class="id" title="definition">Nat.leb</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#setup:100"><span class="id" title="variable">setup</span></a>.(<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#_fundingStart"><span class="id" title="projection">_fundingStart</span></a>) <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#setup:100"><span class="id" title="variable">setup</span></a>.(<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#_fundingEnd"><span class="id" title="projection">_fundingEnd</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="initial_supply_le_cap" class="idref" href="#initial_supply_le_cap"><span class="id" title="definition">initial_supply_le_cap</span></a> (<a id="setup:101" class="idref" href="#setup:101"><span class="id" title="binder">setup</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#Setup"><span class="id" title="record">Setup</span></a>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.leb"><span class="id" title="definition">N.leb</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#setup:101"><span class="id" title="variable">setup</span></a>.(<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#_batFund"><span class="id" title="projection">_batFund</span></a>) <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#setup:101"><span class="id" title="variable">setup</span></a>.(<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#_tokenCreationCap"><span class="id" title="projection">_tokenCreationCap</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="exchange_rate_non_zero" class="idref" href="#exchange_rate_non_zero"><span class="id" title="definition">exchange_rate_non_zero</span></a> (<a id="setup:102" class="idref" href="#setup:102"><span class="id" title="binder">setup</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#Setup"><span class="id" title="record">Setup</span></a>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.ltb"><span class="id" title="definition">N.ltb</span></a> 0 <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#setup:102"><span class="id" title="variable">setup</span></a>.(<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#_tokenExchangeRate"><span class="id" title="projection">_tokenExchangeRate</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="is_finalized" class="idref" href="#is_finalized"><span class="id" title="definition">is_finalized</span></a> <a id="cs:103" class="idref" href="#cs:103"><span class="id" title="binder">cs</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#get_contract_state"><span class="id" title="definition">get_contract_state</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">State</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#cs:103"><span class="id" title="variable">cs</span></a> <a class="idref" href="ConCert.Examples.BAT.BATTestCommon.html#contract_base_addr"><span class="id" title="definition">contract_base_addr</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">state</span> =&gt; <span class="id" title="var">state</span>.(<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#isFinalized"><span class="id" title="projection">isFinalized</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="https://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a> and <a href="https://github.com/jgallen23/toc">TOC</a>
</div>
</div>
<script>
  const elements = document.getElementsByClassName("libtitle");
  while(elements.length > 0){
        elements[0].parentNode.removeChild(elements[0]);
  }
  if (window.location.pathname.endsWith("/toc.html")) {
      const jstocDiv = document.getElementById("js-toc");
      jstocDiv.classList.remove("toc");
      jstocDiv.classList.add("jstoc-hidden");
      const jstocHeaderDiv = document.getElementById("js-toc-header");
      jstocHeaderDiv.classList.add("jstoc-hidden");
      const mainDiv = document.getElementById("main");
      mainDiv.classList.add("jstoc-hidden-main");
      const toggleDiv = document.getElementById("toggle-toc");
      toggleDiv.classList.add("jstoc-hidden");
  }
  console.log(window.location.pathname);
</script>
<script type="text/javascript" src="toc.js"></script>
</body>

</html>
