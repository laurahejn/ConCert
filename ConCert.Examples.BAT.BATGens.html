<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<link href="toc.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
      <span id="toggle-toc">Contents</span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="https://github.com/AU-COBRA/ConCert" target="_balnk">Project Page</a>
      <a href="index.html">Index</a>
      <a href="toc.html">Table of contents</a>
    </span>
</div>
  <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="js-toc" class="toc" data-toc="h1,h2,h3,h4" data-toc-container="doc" data-toc-offset="-40">
      <div id="js-toc-header" class="toc-header">Contents:</div>
    </div>
    <div id="main">
<h1 class="libtitle">Library ConCert.Examples.BAT.BATGens</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Blockchain.html#"><span class="id" title="library">Blockchain</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Containers.html#"><span class="id" title="library">Containers</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Serializable.html#"><span class="id" title="library">Serializable</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution.Test</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Test.QCTest.html#"><span class="id" title="library">QCTest</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Examples.BAT</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#"><span class="id" title="library">BATCommon</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Examples.BAT</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Examples.BAT.BATPrinters.html#"><span class="id" title="library">BATPrinters</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Examples.EIP20</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#"><span class="id" title="library">EIP20TokenGens</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#"><span class="id" title="library">List</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.ZArith.html#"><span class="id" title="library">ZArith</span></a>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ListNotations"><span class="id" title="module">ListNotations</span></a>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#MonadNotation"><span class="id" title="module">MonadNotation</span></a>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="keyword">Type</span> <a id="BATGensInfo" class="idref" href="#BATGensInfo"><span class="id" title="module">BATGensInfo</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a id="BATGensInfo.trace_length" class="idref" href="#BATGensInfo.trace_length"><span class="id" title="axiom">trace_length</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a id="BATGensInfo.gAccount" class="idref" href="#BATGensInfo.gAccount"><span class="id" title="axiom">gAccount</span></a> : <span class="id" title="axiom">G</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a id="BATGensInfo.contract_addr" class="idref" href="#BATGensInfo.contract_addr"><span class="id" title="axiom">contract_addr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a id="BATGensInfo.accounts" class="idref" href="#BATGensInfo.accounts"><span class="id" title="axiom">accounts</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a id="BATGensInfo.accounts_total_balance" class="idref" href="#BATGensInfo.accounts_total_balance"><span class="id" title="axiom">accounts_total_balance</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a id="BATGensInfo.bat_addr" class="idref" href="#BATGensInfo.bat_addr"><span class="id" title="axiom">bat_addr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a id="BATGensInfo.fund_addr" class="idref" href="#BATGensInfo.fund_addr"><span class="id" title="axiom">fund_addr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a id="BATGensInfo.bat_addr_refundable" class="idref" href="#BATGensInfo.bat_addr_refundable"><span class="id" title="axiom">bat_addr_refundable</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a id="BATGensInfo.bat_addr_fundable" class="idref" href="#BATGensInfo.bat_addr_fundable"><span class="id" title="axiom">bat_addr_fundable</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a id="BATGensInfo.eip20_transactions_before_finalized" class="idref" href="#BATGensInfo.eip20_transactions_before_finalized"><span class="id" title="axiom">eip20_transactions_before_finalized</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#BATGensInfo"><span class="id" title="module">BATGensInfo</span></a>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <a id="BATGens" class="idref" href="#BATGens"><span class="id" title="module">BATGens</span></a> (<span class="id" title="var">Info</span> : <a class="idref" href="ConCert.Examples.BAT.BATGens.html#BATGensInfo"><span class="id" title="module">BATGensInfo</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info"><span class="id" title="module">Info</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Arguments</span> <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a> : <span class="id" title="tactic">clear</span> <span class="id" title="var">implicits</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Arguments</span> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> : <span class="id" title="tactic">clear</span> <span class="id" title="var">implicits</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Arguments</span> <a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> : <span class="id" title="tactic">clear</span> <span class="id" title="var">implicits</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="BATGens.account_balance" class="idref" href="#BATGens.account_balance"><span class="id" title="definition">account_balance</span></a> (<a id="env:11" class="idref" href="#env:11"><span class="id" title="binder">env</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>) (<a id="addr:12" class="idref" href="#addr:12"><span class="id" title="binder">addr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#env:11"><span class="id" title="variable">env</span></a>) <a class="idref" href="ConCert.Examples.BAT.BATGens.html#addr:12"><span class="id" title="variable">addr</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="BATGens.get_refundable_accounts" class="idref" href="#BATGens.get_refundable_accounts"><span class="id" title="definition">get_refundable_accounts</span></a> <a id="state:13" class="idref" href="#state:13"><span class="id" title="binder">state</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<span class="id" title="axiom">G</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="balances_list:14" class="idref" href="#balances_list:14"><span class="id" title="binder">balances_list</span></a> := <a class="idref" href="ConCert.Execution.Containers.html#FMap.elements"><span class="id" title="abbreviation">FMap.elements</span></a> (<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#balances"><span class="id" title="definition">balances</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:13"><span class="id" title="variable">state</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="filtered_balances:16" class="idref" href="#filtered_balances:16"><span class="id" title="binder">filtered_balances</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> (<span class="id" title="keyword">fun</span> <a id="x:15" class="idref" href="#x:15"><span class="id" title="binder">x</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.bat_addr_refundable"><span class="id" title="axiom">bat_addr_refundable</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">||</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#negb"><span class="id" title="definition">negb</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.bat_addr"><span class="id" title="axiom">bat_addr</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#x:15"><span class="id" title="variable">x</span></a>))<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> (0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#b39870dee55afcd85c6b795fb34de165"><span class="id" title="notation">&lt;?</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#b39870dee55afcd85c6b795fb34de165"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#x:15"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#b39870dee55afcd85c6b795fb34de165"><span class="id" title="notation">)</span></a>)%<span class="id" title="var">N</span>) <a class="idref" href="ConCert.Examples.BAT.BATGens.html#balances_list:14"><span class="id" title="variable">balances_list</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <span class="id" title="axiom">returnGen</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#filtered_balances:16"><span class="id" title="variable">filtered_balances</span></a>)).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="BATGens.get_fundable_accounts" class="idref" href="#BATGens.get_fundable_accounts"><span class="id" title="definition">get_fundable_accounts</span></a> <a id="env:17" class="idref" href="#env:17"><span class="id" title="binder">env</span></a> : <span class="id" title="axiom">G</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="freq_accounts:19" class="idref" href="#freq_accounts:19"><span class="id" title="binder">freq_accounts</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="keyword">fun</span> <a id="addr:18" class="idref" href="#addr:18"><span class="id" title="binder">addr</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="keyword">if</span> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.bat_addr_fundable"><span class="id" title="axiom">bat_addr_fundable</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">||</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#negb"><span class="id" title="definition">negb</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#addr:18"><span class="id" title="variable">addr</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.bat_addr"><span class="id" title="axiom">bat_addr</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> (<a class="idref" href="ConCert.Examples.BAT.BATGens.html#BATGens.account_balance"><span class="id" title="definition">account_balance</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#env:17"><span class="id" title="variable">env</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#addr:18"><span class="id" title="variable">addr</span></a>) <span class="id" title="keyword">else</span> 0<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#returnGenSome"><span class="id" title="definition">returnGenSome</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#addr:18"><span class="id" title="variable">addr</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.accounts"><span class="id" title="axiom">accounts</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="axiom">freq_</span> (<span class="id" title="axiom">returnGen</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>) <a class="idref" href="ConCert.Examples.BAT.BATGens.html#freq_accounts:19"><span class="id" title="variable">freq_accounts</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="BATGens.gFund_amount" class="idref" href="#BATGens.gFund_amount"><span class="id" title="definition">gFund_amount</span></a> <a id="env:20" class="idref" href="#env:20"><span class="id" title="binder">env</span></a> <a id="state:21" class="idref" href="#state:21"><span class="id" title="binder">state</span></a> <a id="addr:22" class="idref" href="#addr:22"><span class="id" title="binder">addr</span></a> : <span class="id" title="axiom">G</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="axiom">choose</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>1<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.min"><span class="id" title="definition">Z.min</span></a> (<a class="idref" href="ConCert.Examples.BAT.BATGens.html#BATGens.account_balance"><span class="id" title="definition">account_balance</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#env:20"><span class="id" title="variable">env</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#addr:22"><span class="id" title="variable">addr</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.of_N"><span class="id" title="definition">Z.of_N</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:21"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#tokenCreationCap"><span class="id" title="projection">tokenCreationCap</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.BAT.BATCommon.html#total_supply"><span class="id" title="definition">total_supply</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:21"><span class="id" title="variable">state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">/</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:21"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#tokenExchangeRate"><span class="id" title="projection">tokenExchangeRate</span></a>)))<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)%<span class="id" title="var">Z</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="BATGens.gCreateTokens" class="idref" href="#BATGens.gCreateTokens"><span class="id" title="definition">gCreateTokens</span></a> (<a id="env:23" class="idref" href="#env:23"><span class="id" title="binder">env</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>) (<a id="state:24" class="idref" href="#state:24"><span class="id" title="binder">state</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">BATCommon.State</span></a>) : <span class="id" title="definition">GOpt</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#Msg"><span class="id" title="inductive">Msg</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="current_slot:25" class="idref" href="#current_slot:25"><span class="id" title="binder">current_slot</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#env_chain"><span class="id" title="projection">env_chain</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#env:23"><span class="id" title="variable">env</span></a>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:24"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#isFinalized"><span class="id" title="projection">isFinalized</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">||</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Arith.PeanoNat.html#Nat.ltb"><span class="id" title="definition">Nat.ltb</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#current_slot:25"><span class="id" title="variable">current_slot</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:24"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#fundingStart"><span class="id" title="projection">fundingStart</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">||</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Arith.PeanoNat.html#Nat.ltb"><span class="id" title="definition">Nat.ltb</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:24"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#fundingEnd"><span class="id" title="projection">fundingEnd</span></a>) <a class="idref" href="ConCert.Examples.BAT.BATGens.html#current_slot:25"><span class="id" title="variable">current_slot</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">)</span></a> <span class="comment">(*&nbsp;Funding&nbsp;can&nbsp;only&nbsp;happen&nbsp;in&nbsp;funding&nbsp;period&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">||</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.ltb"><span class="id" title="definition">N.ltb</span></a> (<a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:24"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#tokenCreationCap"><span class="id" title="projection">tokenCreationCap</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.BAT.BATCommon.html#total_supply"><span class="id" title="definition">total_supply</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:24"><span class="id" title="variable">state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">)</span></a>) <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:24"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#tokenExchangeRate"><span class="id" title="projection">tokenExchangeRate</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">)</span></a>) <span class="comment">(*&nbsp;No&nbsp;funding&nbsp;if&nbsp;cap&nbsp;was&nbsp;hit&nbsp;or&nbsp;we&nbsp;are&nbsp;too&nbsp;close&nbsp;to&nbsp;it&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="axiom">returnGen</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="from_addr:26" class="idref" href="#from_addr:26"><span class="id" title="binder">from_addr</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#BATGens.get_fundable_accounts"><span class="id" title="definition">get_fundable_accounts</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#env:23"><span class="id" title="variable">env</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="value:27" class="idref" href="#value:27"><span class="id" title="binder">value</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">&lt;-</span></a> <span class="id" title="axiom">bindGen</span> (<a class="idref" href="ConCert.Examples.BAT.BATGens.html#BATGens.gFund_amount"><span class="id" title="definition">gFund_amount</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#env:23"><span class="id" title="variable">env</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:24"><span class="id" title="variable">state</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#from_addr:26"><span class="id" title="variable">from_addr</span></a>) <a class="idref" href="ConCert.Execution.Test.TestUtils.html#returnGenSome"><span class="id" title="definition">returnGenSome</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Test.TestUtils.html#returnGenSome"><span class="id" title="definition">returnGenSome</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.BAT.BATGens.html#from_addr:26"><span class="id" title="variable">from_addr</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#value:27"><span class="id" title="variable">value</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#create_tokens"><span class="id" title="constructor">create_tokens</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="BATGens.gCreateTokensInvalid" class="idref" href="#BATGens.gCreateTokensInvalid"><span class="id" title="definition">gCreateTokensInvalid</span></a> (<a id="env:28" class="idref" href="#env:28"><span class="id" title="binder">env</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>) (<a id="state:29" class="idref" href="#state:29"><span class="id" title="binder">state</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">BATCommon.State</span></a>) : <span class="id" title="definition">GOpt</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#Msg"><span class="id" title="inductive">Msg</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="from_addr:30" class="idref" href="#from_addr:30"><span class="id" title="binder">from_addr</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#BATGens.get_fundable_accounts"><span class="id" title="definition">get_fundable_accounts</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#env:28"><span class="id" title="variable">env</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="value:31" class="idref" href="#value:31"><span class="id" title="binder">value</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">&lt;-</span></a> <span class="id" title="axiom">bindGen</span> (<span class="id" title="axiom">choose</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>1<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#BATGens.account_balance"><span class="id" title="definition">account_balance</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#env:28"><span class="id" title="variable">env</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#from_addr:30"><span class="id" title="variable">from_addr</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>%<span class="id" title="var">Z</span>) <a class="idref" href="ConCert.Execution.Test.TestUtils.html#returnGenSome"><span class="id" title="definition">returnGenSome</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Test.TestUtils.html#returnGenSome"><span class="id" title="definition">returnGenSome</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.BAT.BATGens.html#from_addr:30"><span class="id" title="variable">from_addr</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#value:31"><span class="id" title="variable">value</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#create_tokens"><span class="id" title="constructor">create_tokens</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="BATGens.gRefund" class="idref" href="#BATGens.gRefund"><span class="id" title="definition">gRefund</span></a> (<a id="env:32" class="idref" href="#env:32"><span class="id" title="binder">env</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>) (<a id="state:33" class="idref" href="#state:33"><span class="id" title="binder">state</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">BATCommon.State</span></a>) : <span class="id" title="definition">GOpt</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#Msg"><span class="id" title="inductive">Msg</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="current_slot:34" class="idref" href="#current_slot:34"><span class="id" title="binder">current_slot</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#env_chain"><span class="id" title="projection">env_chain</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#env:32"><span class="id" title="variable">env</span></a>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="accounts:35" class="idref" href="#accounts:35"><span class="id" title="binder">accounts</span></a> := <a class="idref" href="ConCert.Examples.BAT.BATGens.html#BATGens.get_refundable_accounts"><span class="id" title="definition">get_refundable_accounts</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:33"><span class="id" title="variable">state</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> ((<a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:33"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#isFinalized"><span class="id" title="projection">isFinalized</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">||</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Arith.PeanoNat.html#Nat.leb"><span class="id" title="definition">Nat.leb</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#current_slot:34"><span class="id" title="variable">current_slot</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:33"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#fundingEnd"><span class="id" title="projection">fundingEnd</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">||</span></a> (<a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:33"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#tokenCreationMin"><span class="id" title="projection">tokenCreationMin</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#05335162eaa480b4616c18e1c329eb57"><span class="id" title="notation">&lt;=?</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#05335162eaa480b4616c18e1c329eb57"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.BAT.BATCommon.html#total_supply"><span class="id" title="definition">total_supply</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:33"><span class="id" title="variable">state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#05335162eaa480b4616c18e1c329eb57"><span class="id" title="notation">)</span></a>)%<span class="id" title="var">N</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="axiom">returnGen</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="from_addr:36" class="idref" href="#from_addr:36"><span class="id" title="binder">from_addr</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">&lt;-</span></a> <span class="id" title="axiom">oneOf_</span> (<span class="id" title="axiom">returnGen</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>) <a class="idref" href="ConCert.Examples.BAT.BATGens.html#accounts:35"><span class="id" title="variable">accounts</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Test.TestUtils.html#returnGenSome"><span class="id" title="definition">returnGenSome</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.BAT.BATGens.html#from_addr:36"><span class="id" title="variable">from_addr</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#refund"><span class="id" title="constructor">refund</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="BATGens.gRefundInvalid" class="idref" href="#BATGens.gRefundInvalid"><span class="id" title="definition">gRefundInvalid</span></a> (<a id="env:37" class="idref" href="#env:37"><span class="id" title="binder">env</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>) (<a id="state:38" class="idref" href="#state:38"><span class="id" title="binder">state</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">BATCommon.State</span></a>) : <span class="id" title="axiom">G</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#Msg"><span class="id" title="inductive">Msg</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="from_addr:39" class="idref" href="#from_addr:39"><span class="id" title="binder">from_addr</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.gAccount"><span class="id" title="axiom">gAccount</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="axiom">returnGen</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.BAT.BATGens.html#from_addr:39"><span class="id" title="variable">from_addr</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#refund"><span class="id" title="constructor">refund</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="BATGens.gFinalize" class="idref" href="#BATGens.gFinalize"><span class="id" title="definition">gFinalize</span></a> (<a id="env:40" class="idref" href="#env:40"><span class="id" title="binder">env</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>) (<a id="state:41" class="idref" href="#state:41"><span class="id" title="binder">state</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">BATCommon.State</span></a>) : <span class="id" title="definition">GOpt</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#Msg"><span class="id" title="inductive">Msg</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="current_slot:42" class="idref" href="#current_slot:42"><span class="id" title="binder">current_slot</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#env_chain"><span class="id" title="projection">env_chain</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#env:40"><span class="id" title="variable">env</span></a>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:41"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#isFinalized"><span class="id" title="projection">isFinalized</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">||</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#b39870dee55afcd85c6b795fb34de165"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.BAT.BATCommon.html#total_supply"><span class="id" title="definition">total_supply</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:41"><span class="id" title="variable">state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#b39870dee55afcd85c6b795fb34de165"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#b39870dee55afcd85c6b795fb34de165"><span class="id" title="notation">&lt;?</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:41"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#tokenCreationMin"><span class="id" title="projection">tokenCreationMin</span></a>))%<span class="id" title="var">N</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">||</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Arith.PeanoNat.html#Nat.leb"><span class="id" title="definition">Nat.leb</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#current_slot:42"><span class="id" title="variable">current_slot</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:41"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#fundingEnd"><span class="id" title="projection">fundingEnd</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#negb"><span class="id" title="definition">negb</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#59a5ff4a6cbb127625aba1a377a243d1"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.BAT.BATCommon.html#total_supply"><span class="id" title="definition">total_supply</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:41"><span class="id" title="variable">state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#59a5ff4a6cbb127625aba1a377a243d1"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#59a5ff4a6cbb127625aba1a377a243d1"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:41"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#tokenCreationCap"><span class="id" title="projection">tokenCreationCap</span></a>))%<span class="id" title="var">N</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">)</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="axiom">returnGen</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Test.TestUtils.html#returnGenSome"><span class="id" title="definition">returnGenSome</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.fund_addr"><span class="id" title="axiom">fund_addr</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#finalize"><span class="id" title="constructor">finalize</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="BATGens.gFinalizeInvalid" class="idref" href="#BATGens.gFinalizeInvalid"><span class="id" title="definition">gFinalizeInvalid</span></a> (<a id="env:43" class="idref" href="#env:43"><span class="id" title="binder">env</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>) (<a id="state:44" class="idref" href="#state:44"><span class="id" title="binder">state</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">BATCommon.State</span></a>) : <span class="id" title="axiom">G</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#Msg"><span class="id" title="inductive">Msg</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="from_addr:45" class="idref" href="#from_addr:45"><span class="id" title="binder">from_addr</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.gAccount"><span class="id" title="axiom">gAccount</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="axiom">returnGen</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.BAT.BATGens.html#from_addr:45"><span class="id" title="variable">from_addr</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#finalize"><span class="id" title="constructor">finalize</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Module</span> <a id="BATGens.EIP20" class="idref" href="#BATGens.EIP20"><span class="id" title="module">EIP20</span></a> := <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#EIP20Gens"><span class="id" title="module">EIP20Gens</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info"><span class="id" title="module">Info</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="BATGens.gTransfer" class="idref" href="#BATGens.gTransfer"><span class="id" title="definition">gTransfer</span></a> (<a id="env:46" class="idref" href="#env:46"><span class="id" title="binder">env</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>) (<a id="state:47" class="idref" href="#state:47"><span class="id" title="binder">state</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">BATCommon.State</span></a>) : <span class="id" title="definition">GOpt</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#Msg"><span class="id" title="inductive">Msg</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.eip20_transactions_before_finalized"><span class="id" title="axiom">eip20_transactions_before_finalized</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">||</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:47"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#isFinalized"><span class="id" title="projection">isFinalized</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#9d6c3e66ed5a7d11a2cd0c5e68ec6163"><span class="id" title="notation">'</span></a><a id="pat:50" class="idref" href="#pat:50"><span class="id" title="binder">(</span></a><a id="pat:50" class="idref" href="#pat:50"><span class="id" title="binder">caller</span></a><a id="pat:50" class="idref" href="#pat:50"><span class="id" title="binder">,</span></a> <a id="pat:50" class="idref" href="#pat:50"><span class="id" title="binder">msg</span></a><a id="pat:50" class="idref" href="#pat:50"><span class="id" title="binder">)</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#9d6c3e66ed5a7d11a2cd0c5e68ec6163"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#BATGens.gTransfer"><span class="id" title="definition">EIP20.gTransfer</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#env:46"><span class="id" title="variable">env</span></a> (<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#token_state"><span class="id" title="projection">token_state</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:47"><span class="id" title="variable">state</span></a>) <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#9d6c3e66ed5a7d11a2cd0c5e68ec6163"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Test.TestUtils.html#returnGenSome"><span class="id" title="definition">returnGenSome</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.BAT.BATGens.html#caller:49"><span class="id" title="variable">caller</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#tokenMsg"><span class="id" title="constructor">tokenMsg</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#msg:48"><span class="id" title="variable">msg</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="axiom">returnGen</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="BATGens.gApprove" class="idref" href="#BATGens.gApprove"><span class="id" title="definition">gApprove</span></a> (<a id="state:51" class="idref" href="#state:51"><span class="id" title="binder">state</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">BATCommon.State</span></a>) : <span class="id" title="definition">GOpt</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#Msg"><span class="id" title="inductive">Msg</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.eip20_transactions_before_finalized"><span class="id" title="axiom">eip20_transactions_before_finalized</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">||</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:51"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#isFinalized"><span class="id" title="projection">isFinalized</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="axiom">bindGenOpt</span> (<a class="idref" href="ConCert.Examples.BAT.BATGens.html#BATGens.gApprove"><span class="id" title="definition">EIP20.gApprove</span></a> (<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#token_state"><span class="id" title="projection">token_state</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:51"><span class="id" title="variable">state</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> '<a id="pat:54" class="idref" href="#pat:54"><span class="id" title="binder">(</span></a><a id="pat:54" class="idref" href="#pat:54"><span class="id" title="binder">caller</span></a><a id="pat:54" class="idref" href="#pat:54"><span class="id" title="binder">,</span></a> <a id="pat:54" class="idref" href="#pat:54"><span class="id" title="binder">msg</span></a><a id="pat:54" class="idref" href="#pat:54"><span class="id" title="binder">)</span></a> =&gt; <a class="idref" href="ConCert.Execution.Test.TestUtils.html#returnGenSome"><span class="id" title="definition">returnGenSome</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.BAT.BATGens.html#caller:53"><span class="id" title="variable">caller</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#tokenMsg"><span class="id" title="constructor">tokenMsg</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#msg:52"><span class="id" title="variable">msg</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="axiom">returnGen</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="BATGens.gTransfer_from" class="idref" href="#BATGens.gTransfer_from"><span class="id" title="definition">gTransfer_from</span></a> (<a id="state:55" class="idref" href="#state:55"><span class="id" title="binder">state</span></a> : <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">BATCommon.State</span></a>) : <span class="id" title="definition">GOpt</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#Msg"><span class="id" title="inductive">Msg</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.eip20_transactions_before_finalized"><span class="id" title="axiom">eip20_transactions_before_finalized</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">||</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:55"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#isFinalized"><span class="id" title="projection">isFinalized</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="axiom">bindGenOpt</span> (<a class="idref" href="ConCert.Examples.BAT.BATGens.html#BATGens.gTransfer_from"><span class="id" title="definition">EIP20.gTransfer_from</span></a> (<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#token_state"><span class="id" title="projection">token_state</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:55"><span class="id" title="variable">state</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> '<a id="pat:58" class="idref" href="#pat:58"><span class="id" title="binder">(</span></a><a id="pat:58" class="idref" href="#pat:58"><span class="id" title="binder">caller</span></a><a id="pat:58" class="idref" href="#pat:58"><span class="id" title="binder">,</span></a> <a id="pat:58" class="idref" href="#pat:58"><span class="id" title="binder">msg</span></a><a id="pat:58" class="idref" href="#pat:58"><span class="id" title="binder">)</span></a> =&gt; <a class="idref" href="ConCert.Execution.Test.TestUtils.html#returnGenSome"><span class="id" title="definition">returnGenSome</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.BAT.BATGens.html#caller:57"><span class="id" title="variable">caller</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#tokenMsg"><span class="id" title="constructor">tokenMsg</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#msg:56"><span class="id" title="variable">msg</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="axiom">returnGen</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;BAT&nbsp;valid&nbsp;call&nbsp;generator<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Generator&nbsp;that&nbsp;will&nbsp;always&nbsp;return&nbsp;BAToken&nbsp;contract&nbsp;calls&nbsp;that&nbsp;are&nbsp;valid&nbsp;on&nbsp;their&nbsp;own,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;i.e.&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;valid&nbsp;if&nbsp;it&nbsp;is&nbsp;the&nbsp;first&nbsp;action&nbsp;executed&nbsp;in&nbsp;the&nbsp;block.<br/>
&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="BATGens.gBATActionValid" class="idref" href="#BATGens.gBATActionValid"><span class="id" title="definition">gBATActionValid</span></a> (<a id="env:59" class="idref" href="#env:59"><span class="id" title="binder">env</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>) : <span class="id" title="definition">GOpt</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="call:64" class="idref" href="#call:64"><span class="id" title="binder">call</span></a> <a id="contract_addr:60" class="idref" href="#contract_addr:60"><span class="id" title="binder">contract_addr</span></a> <a id="caller_addr:61" class="idref" href="#caller_addr:61"><span class="id" title="binder">caller_addr</span></a> <a id="value:62" class="idref" href="#value:62"><span class="id" title="binder">value</span></a> <a id="msg:63" class="idref" href="#msg:63"><span class="id" title="binder">msg</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Test.TestUtils.html#returnGenSome"><span class="id" title="definition">returnGenSome</span></a> (<a class="idref" href="ConCert.Execution.Test.TestUtils.html#build_call"><span class="id" title="definition">build_call</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#caller_addr:61"><span class="id" title="variable">caller_addr</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#contract_addr:60"><span class="id" title="variable">contract_addr</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#value:62"><span class="id" title="variable">value</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#msg:63"><span class="id" title="variable">msg</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="state:65" class="idref" href="#state:65"><span class="id" title="binder">state</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">&lt;-</span></a> <span class="id" title="axiom">returnGen</span> (<a class="idref" href="ConCert.Execution.Test.TestUtils.html#get_contract_state"><span class="id" title="definition">get_contract_state</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">BATCommon.State</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#env:59"><span class="id" title="variable">env</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.contract_addr"><span class="id" title="axiom">contract_addr</span></a>) <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="axiom">backtrack</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;transfer&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>1<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="axiom">bindGenOpt</span> (<a class="idref" href="ConCert.Examples.BAT.BATGens.html#BATGens.gTransfer"><span class="id" title="definition">gTransfer</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#env:59"><span class="id" title="variable">env</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:65"><span class="id" title="variable">state</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> '<a id="pat:68" class="idref" href="#pat:68"><span class="id" title="binder">(</span></a><a id="pat:68" class="idref" href="#pat:68"><span class="id" title="binder">caller</span></a><a id="pat:68" class="idref" href="#pat:68"><span class="id" title="binder">,</span></a> <a id="pat:68" class="idref" href="#pat:68"><span class="id" title="binder">msg</span></a><a id="pat:68" class="idref" href="#pat:68"><span class="id" title="binder">)</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.BAT.BATGens.html#call:64"><span class="id" title="variable">call</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.contract_addr"><span class="id" title="axiom">contract_addr</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#caller:67"><span class="id" title="variable">caller</span></a> (0%<span class="id" title="var">Z</span>) <a class="idref" href="ConCert.Examples.BAT.BATGens.html#msg:66"><span class="id" title="variable">msg</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;transfer_from&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>2<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="axiom">bindGenOpt</span> (<a class="idref" href="ConCert.Examples.BAT.BATGens.html#BATGens.gTransfer_from"><span class="id" title="definition">gTransfer_from</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:65"><span class="id" title="variable">state</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> '<a id="pat:71" class="idref" href="#pat:71"><span class="id" title="binder">(</span></a><a id="pat:71" class="idref" href="#pat:71"><span class="id" title="binder">caller</span></a><a id="pat:71" class="idref" href="#pat:71"><span class="id" title="binder">,</span></a> <a id="pat:71" class="idref" href="#pat:71"><span class="id" title="binder">msg</span></a><a id="pat:71" class="idref" href="#pat:71"><span class="id" title="binder">)</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.BAT.BATGens.html#call:64"><span class="id" title="variable">call</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.contract_addr"><span class="id" title="axiom">contract_addr</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#caller:70"><span class="id" title="variable">caller</span></a> (0%<span class="id" title="var">Z</span>) <a class="idref" href="ConCert.Examples.BAT.BATGens.html#msg:69"><span class="id" title="variable">msg</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;approve&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>1<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="axiom">bindGenOpt</span> (<a class="idref" href="ConCert.Examples.BAT.BATGens.html#BATGens.gApprove"><span class="id" title="definition">gApprove</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:65"><span class="id" title="variable">state</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> '<a id="pat:74" class="idref" href="#pat:74"><span class="id" title="binder">(</span></a><a id="pat:74" class="idref" href="#pat:74"><span class="id" title="binder">caller</span></a><a id="pat:74" class="idref" href="#pat:74"><span class="id" title="binder">,</span></a> <a id="pat:74" class="idref" href="#pat:74"><span class="id" title="binder">msg</span></a><a id="pat:74" class="idref" href="#pat:74"><span class="id" title="binder">)</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.BAT.BATGens.html#call:64"><span class="id" title="variable">call</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.contract_addr"><span class="id" title="axiom">contract_addr</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#caller:73"><span class="id" title="variable">caller</span></a> (0%<span class="id" title="var">Z</span>) <a class="idref" href="ConCert.Examples.BAT.BATGens.html#msg:72"><span class="id" title="variable">msg</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;create_tokens&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>5<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="axiom">bindGenOpt</span> (<a class="idref" href="ConCert.Examples.BAT.BATGens.html#BATGens.gCreateTokens"><span class="id" title="definition">gCreateTokens</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#env:59"><span class="id" title="variable">env</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:65"><span class="id" title="variable">state</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> '<a id="pat:78" class="idref" href="#pat:78"><span class="id" title="binder">(</span></a><a id="pat:78" class="idref" href="#pat:78"><span class="id" title="binder">caller</span></a><a id="pat:78" class="idref" href="#pat:78"><span class="id" title="binder">,</span></a> <a id="pat:78" class="idref" href="#pat:78"><span class="id" title="binder">value</span></a><a id="pat:78" class="idref" href="#pat:78"><span class="id" title="binder">,</span></a> <a id="pat:78" class="idref" href="#pat:78"><span class="id" title="binder">msg</span></a><a id="pat:78" class="idref" href="#pat:78"><span class="id" title="binder">)</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.BAT.BATGens.html#call:64"><span class="id" title="variable">call</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.contract_addr"><span class="id" title="axiom">contract_addr</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#caller:77"><span class="id" title="variable">caller</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#value:76"><span class="id" title="variable">value</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#msg:75"><span class="id" title="variable">msg</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;refund&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>10<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="axiom">bindGenOpt</span> (<a class="idref" href="ConCert.Examples.BAT.BATGens.html#BATGens.gRefund"><span class="id" title="definition">gRefund</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#env:59"><span class="id" title="variable">env</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:65"><span class="id" title="variable">state</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> '<a id="pat:81" class="idref" href="#pat:81"><span class="id" title="binder">(</span></a><a id="pat:81" class="idref" href="#pat:81"><span class="id" title="binder">caller</span></a><a id="pat:81" class="idref" href="#pat:81"><span class="id" title="binder">,</span></a> <a id="pat:81" class="idref" href="#pat:81"><span class="id" title="binder">msg</span></a><a id="pat:81" class="idref" href="#pat:81"><span class="id" title="binder">)</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.BAT.BATGens.html#call:64"><span class="id" title="variable">call</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.contract_addr"><span class="id" title="axiom">contract_addr</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#caller:80"><span class="id" title="variable">caller</span></a> (0%<span class="id" title="var">Z</span>) <a class="idref" href="ConCert.Examples.BAT.BATGens.html#msg:79"><span class="id" title="variable">msg</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;finalize&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>10<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="axiom">bindGenOpt</span> (<a class="idref" href="ConCert.Examples.BAT.BATGens.html#BATGens.gFinalize"><span class="id" title="definition">gFinalize</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#env:59"><span class="id" title="variable">env</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:65"><span class="id" title="variable">state</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> '<a id="pat:84" class="idref" href="#pat:84"><span class="id" title="binder">(</span></a><a id="pat:84" class="idref" href="#pat:84"><span class="id" title="binder">caller</span></a><a id="pat:84" class="idref" href="#pat:84"><span class="id" title="binder">,</span></a> <a id="pat:84" class="idref" href="#pat:84"><span class="id" title="binder">msg</span></a><a id="pat:84" class="idref" href="#pat:84"><span class="id" title="binder">)</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.BAT.BATGens.html#call:64"><span class="id" title="variable">call</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.contract_addr"><span class="id" title="axiom">contract_addr</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#caller:83"><span class="id" title="variable">caller</span></a> (0%<span class="id" title="var">Z</span>) <a class="idref" href="ConCert.Examples.BAT.BATGens.html#msg:82"><span class="id" title="variable">msg</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;BAT&nbsp;invalid&nbsp;call&nbsp;generator<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Generator&nbsp;likely&nbsp;to&nbsp;generate&nbsp;invalid&nbsp;BAToken&nbsp;contract&nbsp;calls.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;It&nbsp;treats&nbsp;the&nbsp;BAToken&nbsp;code&nbsp;mostly&nbsp;as&nbsp;blackbox&nbsp;and&nbsp;only&nbsp;know&nbsp;the&nbsp;expected&nbsp;types&nbsp;of&nbsp;input<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;but&nbsp;does&nbsp;not&nbsp;make&nbsp;any&nbsp;assumptions/checks&nbsp;on&nbsp;which&nbsp;values&nbsp;will&nbsp;result&nbsp;in&nbsp;valid&nbsp;or&nbsp;invalid&nbsp;calls<br/>
&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="BATGens.gBATActionInvalid" class="idref" href="#BATGens.gBATActionInvalid"><span class="id" title="definition">gBATActionInvalid</span></a> (<a id="env:85" class="idref" href="#env:85"><span class="id" title="binder">env</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>) : <span class="id" title="definition">GOpt</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="call:90" class="idref" href="#call:90"><span class="id" title="binder">call</span></a> <a id="contract_addr:86" class="idref" href="#contract_addr:86"><span class="id" title="binder">contract_addr</span></a> <a id="caller_addr:87" class="idref" href="#caller_addr:87"><span class="id" title="binder">caller_addr</span></a> <a id="value:88" class="idref" href="#value:88"><span class="id" title="binder">value</span></a> <a id="msg:89" class="idref" href="#msg:89"><span class="id" title="binder">msg</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Test.TestUtils.html#returnGenSome"><span class="id" title="definition">returnGenSome</span></a> (<a class="idref" href="ConCert.Execution.Test.TestUtils.html#build_call"><span class="id" title="definition">build_call</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#caller_addr:87"><span class="id" title="variable">caller_addr</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#contract_addr:86"><span class="id" title="variable">contract_addr</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#value:88"><span class="id" title="variable">value</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#msg:89"><span class="id" title="variable">msg</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="state:91" class="idref" href="#state:91"><span class="id" title="binder">state</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">&lt;-</span></a> <span class="id" title="axiom">returnGen</span> (<a class="idref" href="ConCert.Execution.Test.TestUtils.html#get_contract_state"><span class="id" title="definition">get_contract_state</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">BATCommon.State</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#env:85"><span class="id" title="variable">env</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.contract_addr"><span class="id" title="axiom">contract_addr</span></a>) <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="axiom">backtrack</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;transfer&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>1<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#9d6c3e66ed5a7d11a2cd0c5e68ec6163"><span class="id" title="notation">'</span></a><a id="pat:94" class="idref" href="#pat:94"><span class="id" title="binder">(</span></a><a id="pat:94" class="idref" href="#pat:94"><span class="id" title="binder">caller</span></a><a id="pat:94" class="idref" href="#pat:94"><span class="id" title="binder">,</span></a> <a id="pat:94" class="idref" href="#pat:94"><span class="id" title="binder">msg</span></a><a id="pat:94" class="idref" href="#pat:94"><span class="id" title="binder">)</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#9d6c3e66ed5a7d11a2cd0c5e68ec6163"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#BATGens.gTransfer"><span class="id" title="definition">EIP20.gTransfer</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#env:85"><span class="id" title="variable">env</span></a> (<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#token_state"><span class="id" title="projection">token_state</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:91"><span class="id" title="variable">state</span></a>) <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#9d6c3e66ed5a7d11a2cd0c5e68ec6163"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.BAT.BATGens.html#call:90"><span class="id" title="variable">call</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.contract_addr"><span class="id" title="axiom">contract_addr</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#caller:93"><span class="id" title="variable">caller</span></a> (0%<span class="id" title="var">Z</span>) (<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#tokenMsg"><span class="id" title="constructor">tokenMsg</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#msg:92"><span class="id" title="variable">msg</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;transfer_from&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>2<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="axiom">bindGenOpt</span> (<a class="idref" href="ConCert.Examples.BAT.BATGens.html#BATGens.gTransfer_from"><span class="id" title="definition">EIP20.gTransfer_from</span></a> (<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#token_state"><span class="id" title="projection">token_state</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:91"><span class="id" title="variable">state</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> '<a id="pat:97" class="idref" href="#pat:97"><span class="id" title="binder">(</span></a><a id="pat:97" class="idref" href="#pat:97"><span class="id" title="binder">caller</span></a><a id="pat:97" class="idref" href="#pat:97"><span class="id" title="binder">,</span></a> <a id="pat:97" class="idref" href="#pat:97"><span class="id" title="binder">msg</span></a><a id="pat:97" class="idref" href="#pat:97"><span class="id" title="binder">)</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.BAT.BATGens.html#call:90"><span class="id" title="variable">call</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.contract_addr"><span class="id" title="axiom">contract_addr</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#caller:96"><span class="id" title="variable">caller</span></a> (0%<span class="id" title="var">Z</span>) (<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#tokenMsg"><span class="id" title="constructor">tokenMsg</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#msg:95"><span class="id" title="variable">msg</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;approve&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>1<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="axiom">bindGenOpt</span> (<a class="idref" href="ConCert.Examples.BAT.BATGens.html#BATGens.gApprove"><span class="id" title="definition">EIP20.gApprove</span></a> (<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#token_state"><span class="id" title="projection">token_state</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:91"><span class="id" title="variable">state</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> '<a id="pat:100" class="idref" href="#pat:100"><span class="id" title="binder">(</span></a><a id="pat:100" class="idref" href="#pat:100"><span class="id" title="binder">caller</span></a><a id="pat:100" class="idref" href="#pat:100"><span class="id" title="binder">,</span></a> <a id="pat:100" class="idref" href="#pat:100"><span class="id" title="binder">msg</span></a><a id="pat:100" class="idref" href="#pat:100"><span class="id" title="binder">)</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.BAT.BATGens.html#call:90"><span class="id" title="variable">call</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.contract_addr"><span class="id" title="axiom">contract_addr</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#caller:99"><span class="id" title="variable">caller</span></a> (0%<span class="id" title="var">Z</span>) (<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#tokenMsg"><span class="id" title="constructor">tokenMsg</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#msg:98"><span class="id" title="variable">msg</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;create_tokens&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>5<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="axiom">bindGenOpt</span> (<a class="idref" href="ConCert.Examples.BAT.BATGens.html#BATGens.gCreateTokensInvalid"><span class="id" title="definition">gCreateTokensInvalid</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#env:85"><span class="id" title="variable">env</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:91"><span class="id" title="variable">state</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> '<a id="pat:104" class="idref" href="#pat:104"><span class="id" title="binder">(</span></a><a id="pat:104" class="idref" href="#pat:104"><span class="id" title="binder">caller</span></a><a id="pat:104" class="idref" href="#pat:104"><span class="id" title="binder">,</span></a> <a id="pat:104" class="idref" href="#pat:104"><span class="id" title="binder">value</span></a><a id="pat:104" class="idref" href="#pat:104"><span class="id" title="binder">,</span></a> <a id="pat:104" class="idref" href="#pat:104"><span class="id" title="binder">msg</span></a><a id="pat:104" class="idref" href="#pat:104"><span class="id" title="binder">)</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.BAT.BATGens.html#call:90"><span class="id" title="variable">call</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.contract_addr"><span class="id" title="axiom">contract_addr</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#caller:103"><span class="id" title="variable">caller</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#value:102"><span class="id" title="variable">value</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#msg:101"><span class="id" title="variable">msg</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;refund&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>1<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#9d6c3e66ed5a7d11a2cd0c5e68ec6163"><span class="id" title="notation">'</span></a><a id="pat:107" class="idref" href="#pat:107"><span class="id" title="binder">(</span></a><a id="pat:107" class="idref" href="#pat:107"><span class="id" title="binder">caller</span></a><a id="pat:107" class="idref" href="#pat:107"><span class="id" title="binder">,</span></a> <a id="pat:107" class="idref" href="#pat:107"><span class="id" title="binder">msg</span></a><a id="pat:107" class="idref" href="#pat:107"><span class="id" title="binder">)</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#9d6c3e66ed5a7d11a2cd0c5e68ec6163"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#BATGens.gRefundInvalid"><span class="id" title="definition">gRefundInvalid</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#env:85"><span class="id" title="variable">env</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:91"><span class="id" title="variable">state</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#9d6c3e66ed5a7d11a2cd0c5e68ec6163"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.BAT.BATGens.html#call:90"><span class="id" title="variable">call</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.contract_addr"><span class="id" title="axiom">contract_addr</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#caller:106"><span class="id" title="variable">caller</span></a> (0%<span class="id" title="var">Z</span>) <a class="idref" href="ConCert.Examples.BAT.BATGens.html#msg:105"><span class="id" title="variable">msg</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;finalize&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>1<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#9d6c3e66ed5a7d11a2cd0c5e68ec6163"><span class="id" title="notation">'</span></a><a id="pat:110" class="idref" href="#pat:110"><span class="id" title="binder">(</span></a><a id="pat:110" class="idref" href="#pat:110"><span class="id" title="binder">caller</span></a><a id="pat:110" class="idref" href="#pat:110"><span class="id" title="binder">,</span></a> <a id="pat:110" class="idref" href="#pat:110"><span class="id" title="binder">msg</span></a><a id="pat:110" class="idref" href="#pat:110"><span class="id" title="binder">)</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#9d6c3e66ed5a7d11a2cd0c5e68ec6163"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#BATGens.gFinalizeInvalid"><span class="id" title="definition">gFinalizeInvalid</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#env:85"><span class="id" title="variable">env</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#state:91"><span class="id" title="variable">state</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#9d6c3e66ed5a7d11a2cd0c5e68ec6163"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.BAT.BATGens.html#call:90"><span class="id" title="variable">call</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.contract_addr"><span class="id" title="axiom">contract_addr</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#caller:109"><span class="id" title="variable">caller</span></a> (0%<span class="id" title="var">Z</span>) <a class="idref" href="ConCert.Examples.BAT.BATGens.html#msg:108"><span class="id" title="variable">msg</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;BAT&nbsp;call&nbsp;generator<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Has&nbsp;a&nbsp;7&nbsp;chance&nbsp;of&nbsp;generating&nbsp;a&nbsp;valid&nbsp;call&nbsp;and&nbsp;then&nbsp;replacing&nbsp;the&nbsp;amount&nbsp;of&nbsp;money&nbsp;sent&nbsp;with&nbsp;that&nbsp;call.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;BAT&nbsp;contract&nbsp;this&nbsp;is&nbsp;likely&nbsp;to&nbsp;result&nbsp;in&nbsp;an&nbsp;invalid&nbsp;call&nbsp;as&nbsp;most&nbsp;contract&nbsp;calls&nbsp;on&nbsp;BAToken&nbsp;are<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;not&nbsp;allowed&nbsp;to&nbsp;include&nbsp;money&nbsp;in&nbsp;them.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;6.5&nbsp;of&nbsp;the&nbsp;time&nbsp;it&nbsp;will&nbsp;generate&nbsp;a&nbsp;call&nbsp;that&nbsp;is&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;valid&nbsp;(only&nbsp;guaranteed&nbsp;to<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;be&nbsp;valid&nbsp;on&nbsp;its&nbsp;own,&nbsp;since&nbsp;the&nbsp;generator&nbsp;cannot&nbsp;know&nbsp;what&nbsp;other&nbsp;calls&nbsp;may&nbsp;be&nbsp;included&nbsp;in&nbsp;the&nbsp;same&nbsp;block&nbsp;and<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;which&nbsp;order&nbsp;they&nbsp;will&nbsp;be&nbsp;executed&nbsp;in)<br/>
&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="BATGens.gBATAction" class="idref" href="#BATGens.gBATAction"><span class="id" title="definition">gBATAction</span></a> (<a id="env:111" class="idref" href="#env:111"><span class="id" title="binder">env</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>) : <span class="id" title="definition">GOpt</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="state:112" class="idref" href="#state:112"><span class="id" title="binder">state</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">&lt;-</span></a> <span class="id" title="axiom">returnGen</span> (<a class="idref" href="ConCert.Execution.Test.TestUtils.html#get_contract_state"><span class="id" title="definition">get_contract_state</span></a> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#State"><span class="id" title="record">BATCommon.State</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#env:111"><span class="id" title="variable">env</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.contract_addr"><span class="id" title="axiom">contract_addr</span></a>) <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">freq</span> <span class="id" title="notation">[</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>5<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="axiom">bindGenOpt</span> (<a class="idref" href="ConCert.Examples.BAT.BATGens.html#BATGens.gBATActionValid"><span class="id" title="definition">gBATActionValid</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#env:111"><span class="id" title="variable">env</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> '(<a id="action:117" class="idref" href="#action:117"><span class="id" title="binder">action</span></a>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#action:113"><span class="id" title="variable">action</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#act_body"><span class="id" title="projection">act_body</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="axiom">returnGen</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_deploy"><span class="id" title="constructor">act_deploy</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="axiom">returnGen</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <span class="id" title="var">to</span> <span class="id" title="var">_</span> <span class="id" title="var">msg</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="amount:118" class="idref" href="#amount:118"><span class="id" title="binder">amount</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">&lt;-</span></a> <span class="id" title="axiom">choose</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>0<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#BATGens.account_balance"><span class="id" title="definition">account_balance</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#env:111"><span class="id" title="variable">env</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#action:113"><span class="id" title="variable">action</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#act_from"><span class="id" title="projection">act_from</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>%<span class="id" title="var">Z</span> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Test.TestUtils.html#returnGenSome"><span class="id" title="definition">returnGenSome</span></a> (<a class="idref" href="ConCert.Execution.Test.TestUtils.html#build_call"><span class="id" title="definition">build_call</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#action:113"><span class="id" title="variable">action</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#act_from"><span class="id" title="projection">act_from</span></a>) <span class="id" title="var">to</span> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#amount:115"><span class="id" title="variable">amount</span></a> <span class="id" title="var">msg</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>65<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#BATGens.gBATActionInvalid"><span class="id" title="definition">gBATActionInvalid</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#env:111"><span class="id" title="variable">env</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>930<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#BATGens.gBATActionValid"><span class="id" title="definition">gBATActionValid</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#env:111"><span class="id" title="variable">env</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">]</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="BATGens.gBATSetup" class="idref" href="#BATGens.gBATSetup"><span class="id" title="definition">gBATSetup</span></a> : <span class="id" title="axiom">G</span> <a class="idref" href="ConCert.Examples.BAT.BATCommon.html#Setup"><span class="id" title="record">Setup</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="fundingStart:119" class="idref" href="#fundingStart:119"><span class="id" title="binder">fundingStart</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">&lt;-</span></a> <span class="id" title="axiom">choose</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>0<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.trace_length"><span class="id" title="axiom">trace_length</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">))</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="fundingEnd:120" class="idref" href="#fundingEnd:120"><span class="id" title="binder">fundingEnd</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">&lt;-</span></a> <span class="id" title="axiom">choose</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>0<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.trace_length"><span class="id" title="axiom">trace_length</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">))</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="exchangeRate:121" class="idref" href="#exchangeRate:121"><span class="id" title="binder">exchangeRate</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">&lt;-</span></a> <span class="id" title="axiom">choose</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>0<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.to_N"><span class="id" title="definition">Z.to_N</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.accounts_total_balance"><span class="id" title="axiom">accounts_total_balance</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>%<span class="id" title="var">N</span> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="initSupply:122" class="idref" href="#initSupply:122"><span class="id" title="binder">initSupply</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">&lt;-</span></a> <span class="id" title="axiom">choose</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>0<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.to_N"><span class="id" title="definition">Z.to_N</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.accounts_total_balance"><span class="id" title="axiom">accounts_total_balance</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>%<span class="id" title="var">N</span> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="tokenMin:123" class="idref" href="#tokenMin:123"><span class="id" title="binder">tokenMin</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">&lt;-</span></a> <span class="id" title="axiom">choose</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>0<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.to_N"><span class="id" title="definition">Z.to_N</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.accounts_total_balance"><span class="id" title="axiom">accounts_total_balance</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>%<span class="id" title="var">N</span> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="tokenCap:124" class="idref" href="#tokenCap:124"><span class="id" title="binder">tokenCap</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">&lt;-</span></a> <span class="id" title="axiom">choose</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>0<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.to_N"><span class="id" title="definition">Z.to_N</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.accounts_total_balance"><span class="id" title="axiom">accounts_total_balance</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>%<span class="id" title="var">N</span> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="axiom">returnGen</span> (<a class="idref" href="ConCert.Examples.BAT.BATCommon.html#build_setup"><span class="id" title="constructor">BATCommon.build_setup</span></a> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#initSupply:122"><span class="id" title="variable">initSupply</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.fund_addr"><span class="id" title="axiom">fund_addr</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.BAT.BATGens.html#Info.bat_addr"><span class="id" title="axiom">bat_addr</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.BAT.BATGens.html#fundingStart:119"><span class="id" title="variable">fundingStart</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.BAT.BATGens.html#fundingEnd:120"><span class="id" title="variable">fundingEnd</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.BAT.BATGens.html#exchangeRate:121"><span class="id" title="variable">exchangeRate</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.BAT.BATGens.html#tokenCap:124"><span class="id" title="variable">tokenCap</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.BAT.BATGens.html#tokenMin:123"><span class="id" title="variable">tokenMin</span></a>).<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Examples.BAT.BATGens.html#BATGens"><span class="id" title="module">BATGens</span></a>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="https://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a> and <a href="https://github.com/jgallen23/toc">TOC</a>
</div>
</div>
<script>
  const elements = document.getElementsByClassName("libtitle");
  while(elements.length > 0){
        elements[0].parentNode.removeChild(elements[0]);
  }
  if (window.location.pathname.endsWith("/toc.html")) {
      const jstocDiv = document.getElementById("js-toc");
      jstocDiv.classList.remove("toc");
      jstocDiv.classList.add("jstoc-hidden");
      const jstocHeaderDiv = document.getElementById("js-toc-header");
      jstocHeaderDiv.classList.add("jstoc-hidden");
      const mainDiv = document.getElementById("main");
      mainDiv.classList.add("jstoc-hidden-main");
      const toggleDiv = document.getElementById("toggle-toc");
      toggleDiv.classList.add("jstoc-hidden");
  }
  console.log(window.location.pathname);
</script>
<script type="text/javascript" src="toc.js"></script>
</body>

</html>
