<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<link href="toc.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
      <span id="toggle-toc">Contents</span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="https://github.com/AU-COBRA/ConCert" target="_balnk">Project Page</a>
      <a href="index.html">Index</a>
      <a href="toc.html">Table of contents</a>
    </span>
</div>
  <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="js-toc" class="toc" data-toc="h1,h2,h3,h4" data-toc-container="doc" data-toc-offset="-40">
      <div id="js-toc-header" class="toc-header">Contents:</div>
    </div>
    <div id="main">
<h1 class="libtitle">Library ConCert.Examples.Dexter2.Dexter2CPMMCorrect</h1>

<div class="code">
</div>

<div class="doc">
<a id="lab128"></a><h1 class="section">Dexter 2 CPMM contract</h1>
 This file contains an implementation of the Dexter2 CPMM contract
    https://gitlab.com/dexter2tz/dexter2tz/-/blob/1cec9d9333eba756603d6cd90ea9c70d482a5d3d/dexter.mligo
    In addition this file contains proof of functional correctness w.r.t the
    informal specification https://gitlab.com/dexter2tz/dexter2tz/-/blob/1cec9d9333eba756603d6cd90ea9c70d482a5d3d/docs/informal-spec/dexter2-cpmm.md

<div class="paragraph"> </div>

    This contract is an implementation of a Constant Product Market Maker (CPMM).
    When paired with a FA1.2 or FA2 token contract and a Dexter2 liquidity contract,
    this contract serves as a decentralized exchange allowing users to trade between
    XTZ and tokens. Additionally users can also add or withdraw funds from the
    exchanges trading reserves. Traders pay a 0.3
</div>
<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Utils.Automation.html#"><span class="id" title="library">Automation</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Utils.Extras.html#"><span class="id" title="library">Extras</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Utils.RecordUpdate.html#"><span class="id" title="library">RecordUpdate</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Blockchain.html#"><span class="id" title="library">Blockchain</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Serializable.html#"><span class="id" title="library">Serializable</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#"><span class="id" title="library">InterContractCommunication</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.ContractCommon.html#"><span class="id" title="library">ContractCommon</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.ResultMonad.html#"><span class="id" title="library">ResultMonad</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Examples.FA2</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Examples.FA2.FA2Token.html#"><span class="id" title="library">FA2Token</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Examples.FA2</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Examples.FA2.FA2LegacyInterface.html#"><span class="id" title="library">FA2LegacyInterface</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Examples.Dexter2</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#"><span class="id" title="library">Dexter2FA12</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Examples.Dexter2</span> <span class="id" title="keyword">Require</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12Correct.html#"><span class="id" title="library">Dexter2FA12Correct</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Examples.Dexter2</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#"><span class="id" title="library">Dexter2CPMM</span></a>. <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2"><span class="id" title="module">DEX2</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.ZArith_base.html#"><span class="id" title="library">ZArith_base</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#"><span class="id" title="library">List</span></a>. <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ListNotations"><span class="id" title="module">ListNotations</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.micromega.Lia.html#"><span class="id" title="library">Lia</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab129"></a><h1 class="section">Properties</h1>

</div>
<div class="code">
<span class="id" title="keyword">Section</span> <a id="Theories" class="idref" href="#Theories"><span class="id" title="section">Theories</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Existing Instance</span> <span class="id" title="var">BaseTypes</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">N_scope</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Arguments</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.amount_to_N"><span class="id" title="definition">amount_to_N</span></a> /.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Tactics&nbsp;and&nbsp;facts&nbsp;about&nbsp;helper&nbsp;functions&nbsp;(omitted)&nbsp;*)</span><br/>

<br/>
</div>

<div class="doc">
<a id="lab130"></a><h2 class="section">Set baker correct</h2>
 <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#Dexter2.set_baker"><span class="id" title="definition">set_baker</span></a></span> only changes <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#freezeBaker"><span class="id" title="projection">freezeBaker</span></a></span> in state 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="set_baker_state_eq" class="idref" href="#set_baker_state_eq"><span class="id" title="lemma">set_baker_state_eq</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:20" class="idref" href="#prev_state:20"><span class="id" title="binder">prev_state</span></a> <a id="new_state:21" class="idref" href="#new_state:21"><span class="id" title="binder">new_state</span></a> <a id="chain:22" class="idref" href="#chain:22"><span class="id" title="binder">chain</span></a> <a id="ctx:23" class="idref" href="#ctx:23"><span class="id" title="binder">ctx</span></a> <a id="new_acts:24" class="idref" href="#new_acts:24"><span class="id" title="binder">new_acts</span></a> <a id="param:25" class="idref" href="#param:25"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:22"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:23"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:20"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#SetBaker"><span class="id" title="constructor">SetBaker</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:25"><span class="id" title="variable">param</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:21"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:24"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:20"><span class="id" title="variable">prev_state</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">&lt;|</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#freezeBaker"><span class="id" title="projection">freezeBaker</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">:=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:25"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#freezeBaker_"><span class="id" title="projection">freezeBaker_</span></a>) <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">|&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:21"><span class="id" title="variable">new_state</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="set_baker_freeze_baker_correct" class="idref" href="#set_baker_freeze_baker_correct"><span class="id" title="lemma">set_baker_freeze_baker_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:26" class="idref" href="#prev_state:26"><span class="id" title="binder">prev_state</span></a> <a id="new_state:27" class="idref" href="#new_state:27"><span class="id" title="binder">new_state</span></a> <a id="chain:28" class="idref" href="#chain:28"><span class="id" title="binder">chain</span></a> <a id="ctx:29" class="idref" href="#ctx:29"><span class="id" title="binder">ctx</span></a> <a id="new_acts:30" class="idref" href="#new_acts:30"><span class="id" title="binder">new_acts</span></a> <a id="param:31" class="idref" href="#param:31"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:28"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:29"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:26"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#SetBaker"><span class="id" title="constructor">SetBaker</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:31"><span class="id" title="variable">param</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:27"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:30"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:27"><span class="id" title="variable">new_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#freezeBaker"><span class="id" title="projection">freezeBaker</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:31"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#freezeBaker_"><span class="id" title="projection">freezeBaker_</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#set_baker_state_eq"><span class="id" title="lemma">set_baker_state_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#Dexter2.set_baker"><span class="id" title="definition">set_baker</span></a></span> produces no new_acts 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="set_baker_new_acts_correct" class="idref" href="#set_baker_new_acts_correct"><span class="id" title="lemma">set_baker_new_acts_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="chain:32" class="idref" href="#chain:32"><span class="id" title="binder">chain</span></a> <a id="ctx:33" class="idref" href="#ctx:33"><span class="id" title="binder">ctx</span></a> <a id="prev_state:34" class="idref" href="#prev_state:34"><span class="id" title="binder">prev_state</span></a> <a id="param:35" class="idref" href="#param:35"><span class="id" title="binder">param</span></a> <a id="new_state:36" class="idref" href="#new_state:36"><span class="id" title="binder">new_state</span></a> <a id="new_acts:37" class="idref" href="#new_acts:37"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:32"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:33"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:34"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#SetBaker"><span class="id" title="constructor">SetBaker</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:35"><span class="id" title="variable">param</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:36"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:37"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:37"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#NullAddressAxiom.set_delegate_call"><span class="id" title="axiom">set_delegate_call</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:35"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#baker"><span class="id" title="projection">baker</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If the requirements are met then then receive on set_baker msg must succeed and
      if receive on set_baker msg succeeds then requirements must hold 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="set_baker_is_some" class="idref" href="#set_baker_is_some"><span class="id" title="lemma">set_baker_is_some</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:38" class="idref" href="#prev_state:38"><span class="id" title="binder">prev_state</span></a> <a id="chain:39" class="idref" href="#chain:39"><span class="id" title="binder">chain</span></a> <a id="ctx:40" class="idref" href="#ctx:40"><span class="id" title="binder">ctx</span></a> <a id="param:41" class="idref" href="#param:41"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:40"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> 0)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:38"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#selfIsUpdatingTokenPool"><span class="id" title="projection">selfIsUpdatingTokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:40"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:38"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#manager"><span class="id" title="projection">manager</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:38"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#freezeBaker"><span class="id" title="projection">freezeBaker</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="new_state:42" class="idref" href="#new_state:42"><span class="id" title="binder">new_state</span></a> <a id="new_acts:43" class="idref" href="#new_acts:43"><span class="id" title="binder">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:39"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:40"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:38"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#SetBaker"><span class="id" title="constructor">SetBaker</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:41"><span class="id" title="variable">param</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:42"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:43"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_hyps</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">destruct_address_eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab131"></a><h2 class="section">Set manager correct</h2>
 <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#Dexter2.set_manager"><span class="id" title="definition">set_manager</span></a></span> only changes <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#manager"><span class="id" title="projection">manager</span></a></span> in state 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="set_manager_state_eq" class="idref" href="#set_manager_state_eq"><span class="id" title="lemma">set_manager_state_eq</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:44" class="idref" href="#prev_state:44"><span class="id" title="binder">prev_state</span></a> <a id="new_state:45" class="idref" href="#new_state:45"><span class="id" title="binder">new_state</span></a> <a id="chain:46" class="idref" href="#chain:46"><span class="id" title="binder">chain</span></a> <a id="ctx:47" class="idref" href="#ctx:47"><span class="id" title="binder">ctx</span></a> <a id="new_acts:48" class="idref" href="#new_acts:48"><span class="id" title="binder">new_acts</span></a> <a id="new_manager:49" class="idref" href="#new_manager:49"><span class="id" title="binder">new_manager</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:46"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:47"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:44"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#SetManager"><span class="id" title="constructor">SetManager</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_manager:49"><span class="id" title="variable">new_manager</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:45"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:48"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:44"><span class="id" title="variable">prev_state</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">&lt;|</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#manager"><span class="id" title="projection">manager</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">:=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_manager:49"><span class="id" title="variable">new_manager</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">|&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:45"><span class="id" title="variable">new_state</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="set_manager_manager_correct" class="idref" href="#set_manager_manager_correct"><span class="id" title="lemma">set_manager_manager_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:50" class="idref" href="#prev_state:50"><span class="id" title="binder">prev_state</span></a> <a id="new_state:51" class="idref" href="#new_state:51"><span class="id" title="binder">new_state</span></a> <a id="chain:52" class="idref" href="#chain:52"><span class="id" title="binder">chain</span></a> <a id="ctx:53" class="idref" href="#ctx:53"><span class="id" title="binder">ctx</span></a> <a id="new_acts:54" class="idref" href="#new_acts:54"><span class="id" title="binder">new_acts</span></a> <a id="new_manager:55" class="idref" href="#new_manager:55"><span class="id" title="binder">new_manager</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:52"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:53"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:50"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#SetManager"><span class="id" title="constructor">SetManager</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_manager:55"><span class="id" title="variable">new_manager</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:51"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:54"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:51"><span class="id" title="variable">new_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#manager"><span class="id" title="projection">manager</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_manager:55"><span class="id" title="variable">new_manager</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#set_manager_state_eq"><span class="id" title="lemma">set_manager_state_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#Dexter2.set_manager"><span class="id" title="definition">set_manager</span></a></span> produces no new_acts 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="set_manager_new_acts_correct" class="idref" href="#set_manager_new_acts_correct"><span class="id" title="lemma">set_manager_new_acts_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="chain:56" class="idref" href="#chain:56"><span class="id" title="binder">chain</span></a> <a id="ctx:57" class="idref" href="#ctx:57"><span class="id" title="binder">ctx</span></a> <a id="prev_state:58" class="idref" href="#prev_state:58"><span class="id" title="binder">prev_state</span></a> <a id="new_manager:59" class="idref" href="#new_manager:59"><span class="id" title="binder">new_manager</span></a> <a id="new_state:60" class="idref" href="#new_state:60"><span class="id" title="binder">new_state</span></a> <a id="new_acts:61" class="idref" href="#new_acts:61"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:56"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:57"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:58"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#SetManager"><span class="id" title="constructor">SetManager</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_manager:59"><span class="id" title="variable">new_manager</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:60"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:61"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:61"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If the requirements are met then then receive on set_manager msg must succeed and
      if receive on set_manager msg succeeds then requirements must hold 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="set_manager_is_some" class="idref" href="#set_manager_is_some"><span class="id" title="lemma">set_manager_is_some</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:62" class="idref" href="#prev_state:62"><span class="id" title="binder">prev_state</span></a> <a id="chain:63" class="idref" href="#chain:63"><span class="id" title="binder">chain</span></a> <a id="ctx:64" class="idref" href="#ctx:64"><span class="id" title="binder">ctx</span></a> <a id="new_manager:65" class="idref" href="#new_manager:65"><span class="id" title="binder">new_manager</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:64"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> 0)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:62"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#selfIsUpdatingTokenPool"><span class="id" title="projection">selfIsUpdatingTokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:64"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:62"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#manager"><span class="id" title="projection">manager</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="new_state:66" class="idref" href="#new_state:66"><span class="id" title="binder">new_state</span></a> <a id="new_acts:67" class="idref" href="#new_acts:67"><span class="id" title="binder">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:63"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:64"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:62"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#SetManager"><span class="id" title="constructor">SetManager</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_manager:65"><span class="id" title="variable">new_manager</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:66"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:67"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_hyps</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">destruct_address_eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab132"></a><h2 class="section">Set liquidity address correct</h2>
 <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#Dexter2.set_lqt_address"><span class="id" title="definition">set_lqt_address</span></a></span> only changes <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtAddress"><span class="id" title="projection">lqtAddress</span></a></span> in state 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="set_lqt_address_state_eq" class="idref" href="#set_lqt_address_state_eq"><span class="id" title="lemma">set_lqt_address_state_eq</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:68" class="idref" href="#prev_state:68"><span class="id" title="binder">prev_state</span></a> <a id="new_state:69" class="idref" href="#new_state:69"><span class="id" title="binder">new_state</span></a> <a id="chain:70" class="idref" href="#chain:70"><span class="id" title="binder">chain</span></a> <a id="ctx:71" class="idref" href="#ctx:71"><span class="id" title="binder">ctx</span></a> <a id="new_acts:72" class="idref" href="#new_acts:72"><span class="id" title="binder">new_acts</span></a> <a id="new_lqt_address:73" class="idref" href="#new_lqt_address:73"><span class="id" title="binder">new_lqt_address</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:70"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:71"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:68"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#SetLqtAddress"><span class="id" title="constructor">SetLqtAddress</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_lqt_address:73"><span class="id" title="variable">new_lqt_address</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:69"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:72"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:68"><span class="id" title="variable">prev_state</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">&lt;|</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtAddress"><span class="id" title="projection">lqtAddress</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">:=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_lqt_address:73"><span class="id" title="variable">new_lqt_address</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">|&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:69"><span class="id" title="variable">new_state</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="set_lqt_address_correct" class="idref" href="#set_lqt_address_correct"><span class="id" title="lemma">set_lqt_address_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:74" class="idref" href="#prev_state:74"><span class="id" title="binder">prev_state</span></a> <a id="new_state:75" class="idref" href="#new_state:75"><span class="id" title="binder">new_state</span></a> <a id="chain:76" class="idref" href="#chain:76"><span class="id" title="binder">chain</span></a> <a id="ctx:77" class="idref" href="#ctx:77"><span class="id" title="binder">ctx</span></a> <a id="new_acts:78" class="idref" href="#new_acts:78"><span class="id" title="binder">new_acts</span></a> <a id="new_lqt_address:79" class="idref" href="#new_lqt_address:79"><span class="id" title="binder">new_lqt_address</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:76"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:77"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:74"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#SetLqtAddress"><span class="id" title="constructor">SetLqtAddress</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_lqt_address:79"><span class="id" title="variable">new_lqt_address</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:75"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:78"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:75"><span class="id" title="variable">new_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtAddress"><span class="id" title="projection">lqtAddress</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_lqt_address:79"><span class="id" title="variable">new_lqt_address</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#set_lqt_address_state_eq"><span class="id" title="lemma">set_lqt_address_state_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#Dexter2.set_lqt_address"><span class="id" title="definition">set_lqt_address</span></a></span> produces no new_acts 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="set_lqt_address_new_acts_correct" class="idref" href="#set_lqt_address_new_acts_correct"><span class="id" title="lemma">set_lqt_address_new_acts_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="chain:80" class="idref" href="#chain:80"><span class="id" title="binder">chain</span></a> <a id="ctx:81" class="idref" href="#ctx:81"><span class="id" title="binder">ctx</span></a> <a id="prev_state:82" class="idref" href="#prev_state:82"><span class="id" title="binder">prev_state</span></a> <a id="new_lqt_address:83" class="idref" href="#new_lqt_address:83"><span class="id" title="binder">new_lqt_address</span></a> <a id="new_state:84" class="idref" href="#new_state:84"><span class="id" title="binder">new_state</span></a> <a id="new_acts:85" class="idref" href="#new_acts:85"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:80"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:81"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:82"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#SetLqtAddress"><span class="id" title="constructor">SetLqtAddress</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_lqt_address:83"><span class="id" title="variable">new_lqt_address</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:84"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:85"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:85"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If the requirements are met then then receive on set_lqt_address msg must succeed and
      if receive on set_lqt_address msg succeeds then requirements must hold 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="set_lqt_address_is_some" class="idref" href="#set_lqt_address_is_some"><span class="id" title="lemma">set_lqt_address_is_some</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:86" class="idref" href="#prev_state:86"><span class="id" title="binder">prev_state</span></a> <a id="chain:87" class="idref" href="#chain:87"><span class="id" title="binder">chain</span></a> <a id="ctx:88" class="idref" href="#ctx:88"><span class="id" title="binder">ctx</span></a> <a id="new_lqt_address:89" class="idref" href="#new_lqt_address:89"><span class="id" title="binder">new_lqt_address</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:88"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> 0)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:86"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#selfIsUpdatingTokenPool"><span class="id" title="projection">selfIsUpdatingTokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:88"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:86"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#manager"><span class="id" title="projection">manager</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:86"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtAddress"><span class="id" title="projection">lqtAddress</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#NullAddressAxiom.null_address"><span class="id" title="axiom">null_address</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="new_state:90" class="idref" href="#new_state:90"><span class="id" title="binder">new_state</span></a> <a id="new_acts:91" class="idref" href="#new_acts:91"><span class="id" title="binder">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:87"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:88"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:86"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#SetLqtAddress"><span class="id" title="constructor">SetLqtAddress</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_lqt_address:89"><span class="id" title="variable">new_lqt_address</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:90"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:91"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_hyps</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">destruct_address_eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab133"></a><h2 class="section">Default entrypoint correct</h2>
 <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#Dexter2.default_"><span class="id" title="definition">default_</span></a></span> only changes <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a></span> in state 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="default_state_eq" class="idref" href="#default_state_eq"><span class="id" title="lemma">default_state_eq</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:92" class="idref" href="#prev_state:92"><span class="id" title="binder">prev_state</span></a> <a id="new_state:93" class="idref" href="#new_state:93"><span class="id" title="binder">new_state</span></a> <a id="chain:94" class="idref" href="#chain:94"><span class="id" title="binder">chain</span></a> <a id="ctx:95" class="idref" href="#ctx:95"><span class="id" title="binder">ctx</span></a> <a id="new_acts:96" class="idref" href="#new_acts:96"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:94"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:95"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:92"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:93"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:96"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:92"><span class="id" title="variable">prev_state</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">&lt;|</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">:=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:92"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.amount_to_N"><span class="id" title="definition">amount_to_N</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:95"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a>) <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">|&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:93"><span class="id" title="variable">new_state</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="default_correct" class="idref" href="#default_correct"><span class="id" title="lemma">default_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:97" class="idref" href="#prev_state:97"><span class="id" title="binder">prev_state</span></a> <a id="new_state:98" class="idref" href="#new_state:98"><span class="id" title="binder">new_state</span></a> <a id="chain:99" class="idref" href="#chain:99"><span class="id" title="binder">chain</span></a> <a id="ctx:100" class="idref" href="#ctx:100"><span class="id" title="binder">ctx</span></a> <a id="new_acts:101" class="idref" href="#new_acts:101"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:99"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:100"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:97"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:98"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:101"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:98"><span class="id" title="variable">new_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:97"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.amount_to_N"><span class="id" title="definition">amount_to_N</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:100"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#default_state_eq"><span class="id" title="lemma">default_state_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#Dexter2.default_"><span class="id" title="definition">default_</span></a></span> produces no new_acts 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="default_new_acts_correct" class="idref" href="#default_new_acts_correct"><span class="id" title="lemma">default_new_acts_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="chain:102" class="idref" href="#chain:102"><span class="id" title="binder">chain</span></a> <a id="ctx:103" class="idref" href="#ctx:103"><span class="id" title="binder">ctx</span></a> <a id="prev_state:104" class="idref" href="#prev_state:104"><span class="id" title="binder">prev_state</span></a> <a id="new_state:105" class="idref" href="#new_state:105"><span class="id" title="binder">new_state</span></a> <a id="new_acts:106" class="idref" href="#new_acts:106"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:102"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:103"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:104"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:105"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:106"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:106"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If the requirements are met then then receive on None msg must succeed and
      if receive on None msg succeeds then requirements must hold 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="default_entrypoint_is_some" class="idref" href="#default_entrypoint_is_some"><span class="id" title="lemma">default_entrypoint_is_some</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:107" class="idref" href="#prev_state:107"><span class="id" title="binder">prev_state</span></a> <a id="chain:108" class="idref" href="#chain:108"><span class="id" title="binder">chain</span></a> <a id="ctx:109" class="idref" href="#ctx:109"><span class="id" title="binder">ctx</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:107"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#selfIsUpdatingTokenPool"><span class="id" title="projection">selfIsUpdatingTokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="new_state:110" class="idref" href="#new_state:110"><span class="id" title="binder">new_state</span></a> <a id="new_acts:111" class="idref" href="#new_acts:111"><span class="id" title="binder">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:108"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:109"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:107"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:110"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:111"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_hyps</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab134"></a><h2 class="section">Update token pool correct</h2>
 <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#Dexter2.update_token_pool"><span class="id" title="definition">update_token_pool</span></a></span> only changes <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#selfIsUpdatingTokenPool"><span class="id" title="projection">selfIsUpdatingTokenPool</span></a></span> in state 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_token_pool_state_eq" class="idref" href="#update_token_pool_state_eq"><span class="id" title="lemma">update_token_pool_state_eq</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:112" class="idref" href="#prev_state:112"><span class="id" title="binder">prev_state</span></a> <a id="new_state:113" class="idref" href="#new_state:113"><span class="id" title="binder">new_state</span></a> <a id="chain:114" class="idref" href="#chain:114"><span class="id" title="binder">chain</span></a> <a id="ctx:115" class="idref" href="#ctx:115"><span class="id" title="binder">ctx</span></a> <a id="new_acts:116" class="idref" href="#new_acts:116"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:114"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:115"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:112"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#UpdateTokenPool"><span class="id" title="constructor">UpdateTokenPool</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:113"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:116"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:112"><span class="id" title="variable">prev_state</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">&lt;|</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#selfIsUpdatingTokenPool"><span class="id" title="projection">selfIsUpdatingTokenPool</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">:=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">|&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:113"><span class="id" title="variable">new_state</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_token_pool_correct" class="idref" href="#update_token_pool_correct"><span class="id" title="lemma">update_token_pool_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:117" class="idref" href="#prev_state:117"><span class="id" title="binder">prev_state</span></a> <a id="new_state:118" class="idref" href="#new_state:118"><span class="id" title="binder">new_state</span></a> <a id="chain:119" class="idref" href="#chain:119"><span class="id" title="binder">chain</span></a> <a id="ctx:120" class="idref" href="#ctx:120"><span class="id" title="binder">ctx</span></a> <a id="new_acts:121" class="idref" href="#new_acts:121"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:119"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:120"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:117"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#UpdateTokenPool"><span class="id" title="constructor">UpdateTokenPool</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:118"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:121"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:118"><span class="id" title="variable">new_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#selfIsUpdatingTokenPool"><span class="id" title="projection">selfIsUpdatingTokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#update_token_pool_state_eq"><span class="id" title="lemma">update_token_pool_state_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#Dexter2.update_token_pool"><span class="id" title="definition">update_token_pool</span></a></span> produces an call act with amount = 0, calling
      the token contract with a balance of request 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_token_pool_new_acts_correct" class="idref" href="#update_token_pool_new_acts_correct"><span class="id" title="lemma">update_token_pool_new_acts_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="chain:122" class="idref" href="#chain:122"><span class="id" title="binder">chain</span></a> <a id="ctx:123" class="idref" href="#ctx:123"><span class="id" title="binder">ctx</span></a> <a id="prev_state:124" class="idref" href="#prev_state:124"><span class="id" title="binder">prev_state</span></a> <a id="new_state:125" class="idref" href="#new_state:125"><span class="id" title="binder">new_state</span></a> <a id="new_acts:126" class="idref" href="#new_acts:126"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:122"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:123"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:124"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#UpdateTokenPool"><span class="id" title="constructor">UpdateTokenPool</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:125"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:126"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:126"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:124"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenAddress"><span class="id" title="projection">tokenAddress</span></a>) 0%<span class="id" title="var">Z</span> (<a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#msg_balance_of"><span class="id" title="constructor">msg_balance_of</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2LegacyInterface.html#Build_balance_of_param"><span class="id" title="constructor">Build_balance_of_param</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="ConCert.Examples.FA2.FA2LegacyInterface.html#Build_balance_of_request"><span class="id" title="constructor">Build_balance_of_request</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:123"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a>) <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:124"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenId"><span class="id" title="projection">tokenId</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Examples.FA2.FA2LegacyInterface.html#Build_callback"><span class="id" title="constructor">FA2LegacyInterface.Build_callback</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:123"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a>)))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If the requirements are met then then receive on update_token_pool msg must succeed and
      if receive on update_token_pool msg succeeds then requirements must hold 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_token_pool_is_some" class="idref" href="#update_token_pool_is_some"><span class="id" title="lemma">update_token_pool_is_some</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:127" class="idref" href="#prev_state:127"><span class="id" title="binder">prev_state</span></a> <a id="chain:128" class="idref" href="#chain:128"><span class="id" title="binder">chain</span></a> <a id="ctx:129" class="idref" href="#ctx:129"><span class="id" title="binder">ctx</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:129"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> 0)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:127"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#selfIsUpdatingTokenPool"><span class="id" title="projection">selfIsUpdatingTokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:129"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:129"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_origin"><span class="id" title="projection">ctx_origin</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="new_state:130" class="idref" href="#new_state:130"><span class="id" title="binder">new_state</span></a> <a id="new_acts:131" class="idref" href="#new_acts:131"><span class="id" title="binder">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:128"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:129"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:127"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#UpdateTokenPool"><span class="id" title="constructor">UpdateTokenPool</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:130"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:131"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_hyps</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">destruct_address_eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Tactic Notation</span> "invert_responses_Some" :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <span class="id" title="keyword">match</span> ?<span class="id" title="var">rs</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> =&gt; <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">type</span> <span class="id" title="keyword">of</span> <span class="id" title="var">rs</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Examples.FA2.FA2LegacyInterface.html#balance_of_response"><span class="id" title="record">balance_of_response</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">rs</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "No match on list of balance_of_response"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab135"></a><h2 class="section">Update token pool internal correct</h2>
 <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#Dexter2.update_token_pool_internal"><span class="id" title="definition">update_token_pool_internal</span></a></span> only changes <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#selfIsUpdatingTokenPool"><span class="id" title="projection">selfIsUpdatingTokenPool</span></a></span> and <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a></span> in state 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_token_pool_internal_state_eq" class="idref" href="#update_token_pool_internal_state_eq"><span class="id" title="lemma">update_token_pool_internal_state_eq</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:132" class="idref" href="#prev_state:132"><span class="id" title="binder">prev_state</span></a> <a id="new_state:133" class="idref" href="#new_state:133"><span class="id" title="binder">new_state</span></a> <a id="chain:134" class="idref" href="#chain:134"><span class="id" title="binder">chain</span></a> <a id="ctx:135" class="idref" href="#ctx:135"><span class="id" title="binder">ctx</span></a> <a id="new_acts:136" class="idref" href="#new_acts:136"><span class="id" title="binder">new_acts</span></a> <a id="responses:137" class="idref" href="#responses:137"><span class="id" title="binder">responses</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:134"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:135"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:132"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#receive_balance_of_param"><span class="id" title="constructor">FA2Token.receive_balance_of_param</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#responses:137"><span class="id" title="variable">responses</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:133"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:136"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:132"><span class="id" title="variable">prev_state</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">&lt;|</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#selfIsUpdatingTokenPool"><span class="id" title="projection">selfIsUpdatingTokenPool</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">:=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">|&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">&lt;|</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">:=</span></a> <span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#responses:137"><span class="id" title="variable">responses</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">response</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">t</span> =&gt; <span class="id" title="var">response</span>.(<a class="idref" href="ConCert.Examples.FA2.FA2LegacyInterface.html#balance"><span class="id" title="projection">balance</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">|&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:133"><span class="id" title="variable">new_state</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">invert_responses_Some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_token_pool_internal_update_correct" class="idref" href="#update_token_pool_internal_update_correct"><span class="id" title="lemma">update_token_pool_internal_update_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:139" class="idref" href="#prev_state:139"><span class="id" title="binder">prev_state</span></a> <a id="new_state:140" class="idref" href="#new_state:140"><span class="id" title="binder">new_state</span></a> <a id="chain:141" class="idref" href="#chain:141"><span class="id" title="binder">chain</span></a> <a id="ctx:142" class="idref" href="#ctx:142"><span class="id" title="binder">ctx</span></a> <a id="new_acts:143" class="idref" href="#new_acts:143"><span class="id" title="binder">new_acts</span></a> <a id="responses:144" class="idref" href="#responses:144"><span class="id" title="binder">responses</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:141"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:142"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:139"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#receive_balance_of_param"><span class="id" title="constructor">FA2Token.receive_balance_of_param</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#responses:144"><span class="id" title="variable">responses</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:140"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:143"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:140"><span class="id" title="variable">new_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#selfIsUpdatingTokenPool"><span class="id" title="projection">selfIsUpdatingTokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#update_token_pool_internal_state_eq"><span class="id" title="lemma">update_token_pool_internal_state_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#Dexter2.update_token_pool_internal"><span class="id" title="definition">update_token_pool_internal</span></a></span> produces no new actions 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_token_pool_internal_new_acts_correct" class="idref" href="#update_token_pool_internal_new_acts_correct"><span class="id" title="lemma">update_token_pool_internal_new_acts_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="chain:145" class="idref" href="#chain:145"><span class="id" title="binder">chain</span></a> <a id="ctx:146" class="idref" href="#ctx:146"><span class="id" title="binder">ctx</span></a> <a id="prev_state:147" class="idref" href="#prev_state:147"><span class="id" title="binder">prev_state</span></a> <a id="new_state:148" class="idref" href="#new_state:148"><span class="id" title="binder">new_state</span></a> <a id="new_acts:149" class="idref" href="#new_acts:149"><span class="id" title="binder">new_acts</span></a> <a id="responses:150" class="idref" href="#responses:150"><span class="id" title="binder">responses</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:145"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:146"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:147"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#receive_balance_of_param"><span class="id" title="constructor">FA2Token.receive_balance_of_param</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#responses:150"><span class="id" title="variable">responses</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:148"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:149"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:149"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If the requirements are met then then receive on update_token_pool_internal msg must succeed and
      if receive on update_token_pool_internal msg succeeds then requirements must hold 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_token_pool_internal_is_some" class="idref" href="#update_token_pool_internal_is_some"><span class="id" title="lemma">update_token_pool_internal_is_some</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:151" class="idref" href="#prev_state:151"><span class="id" title="binder">prev_state</span></a> <a id="chain:152" class="idref" href="#chain:152"><span class="id" title="binder">chain</span></a> <a id="ctx:153" class="idref" href="#ctx:153"><span class="id" title="binder">ctx</span></a> <a id="responses:154" class="idref" href="#responses:154"><span class="id" title="binder">responses</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:153"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> 0)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:151"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#selfIsUpdatingTokenPool"><span class="id" title="projection">selfIsUpdatingTokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:153"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:151"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenAddress"><span class="id" title="projection">tokenAddress</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#responses:154"><span class="id" title="variable">responses</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="new_state:155" class="idref" href="#new_state:155"><span class="id" title="binder">new_state</span></a> <a id="new_acts:156" class="idref" href="#new_acts:156"><span class="id" title="binder">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:152"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:153"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:151"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#receive_balance_of_param"><span class="id" title="constructor">FA2Token.receive_balance_of_param</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#responses:154"><span class="id" title="variable">responses</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:155"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:156"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_hyps</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>; <span class="id" title="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">responses</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_or_hyps</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">destruct_address_eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab136"></a><h2 class="section">Add liquidity correct</h2>
 <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#Dexter2.add_liquidity"><span class="id" title="definition">add_liquidity</span></a></span> only changes <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a></span>, <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a></span> and <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a></span> in state 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="add_liquidity_state_eq" class="idref" href="#add_liquidity_state_eq"><span class="id" title="lemma">add_liquidity_state_eq</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:157" class="idref" href="#prev_state:157"><span class="id" title="binder">prev_state</span></a> <a id="new_state:158" class="idref" href="#new_state:158"><span class="id" title="binder">new_state</span></a> <a id="chain:159" class="idref" href="#chain:159"><span class="id" title="binder">chain</span></a> <a id="ctx:160" class="idref" href="#ctx:160"><span class="id" title="binder">ctx</span></a> <a id="new_acts:161" class="idref" href="#new_acts:161"><span class="id" title="binder">new_acts</span></a> <a id="param:162" class="idref" href="#param:162"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="lqt_minted:163" class="idref" href="#lqt_minted:163"><span class="id" title="binder">lqt_minted</span></a> := <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.amount_to_N"><span class="id" title="definition">amount_to_N</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:160"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:157"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">/</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:157"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="tokens_deposited:164" class="idref" href="#tokens_deposited:164"><span class="id" title="binder">tokens_deposited</span></a> := <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.ceildiv_"><span class="id" title="definition">ceildiv_</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.amount_to_N"><span class="id" title="definition">amount_to_N</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:160"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:157"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>)) <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:157"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:159"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:160"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:157"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#AddLiquidity"><span class="id" title="constructor">AddLiquidity</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:162"><span class="id" title="variable">param</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:158"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:161"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:157"><span class="id" title="variable">prev_state</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">&lt;|</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">:=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:157"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#lqt_minted:163"><span class="id" title="variable">lqt_minted</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">|&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">&lt;|</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">:=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:157"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#tokens_deposited:164"><span class="id" title="variable">tokens_deposited</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">|&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">&lt;|</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">:=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:157"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.amount_to_N"><span class="id" title="definition">amount_to_N</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:160"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a>) <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">|&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:158"><span class="id" title="variable">new_state</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">math_convert</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="add_liquidity_correct" class="idref" href="#add_liquidity_correct"><span class="id" title="lemma">add_liquidity_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:165" class="idref" href="#prev_state:165"><span class="id" title="binder">prev_state</span></a> <a id="new_state:166" class="idref" href="#new_state:166"><span class="id" title="binder">new_state</span></a> <a id="chain:167" class="idref" href="#chain:167"><span class="id" title="binder">chain</span></a> <a id="ctx:168" class="idref" href="#ctx:168"><span class="id" title="binder">ctx</span></a> <a id="new_acts:169" class="idref" href="#new_acts:169"><span class="id" title="binder">new_acts</span></a> <a id="param:170" class="idref" href="#param:170"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:167"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:168"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:165"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#AddLiquidity"><span class="id" title="constructor">AddLiquidity</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:170"><span class="id" title="variable">param</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:166"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:169"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:166"><span class="id" title="variable">new_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:165"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.amount_to_N"><span class="id" title="definition">amount_to_N</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:168"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:165"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">/</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:165"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:166"><span class="id" title="variable">new_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:165"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.ceildiv_"><span class="id" title="definition">ceildiv_</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.amount_to_N"><span class="id" title="definition">amount_to_N</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:168"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:165"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>)) <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:165"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:166"><span class="id" title="variable">new_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:165"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.amount_to_N"><span class="id" title="definition">amount_to_N</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:168"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#add_liquidity_state_eq"><span class="id" title="lemma">add_liquidity_state_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
In the informal specification it is stated that tokens should be trasnfered from owner,
      but in the implementation it is trasnfered from the sender.
      For this we assume that the implementation is correct over the informal specification since
      that is what other formalizations seem to have assumed 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="add_liquidity_new_acts_correct" class="idref" href="#add_liquidity_new_acts_correct"><span class="id" title="lemma">add_liquidity_new_acts_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="chain:171" class="idref" href="#chain:171"><span class="id" title="binder">chain</span></a> <a id="ctx:172" class="idref" href="#ctx:172"><span class="id" title="binder">ctx</span></a> <a id="prev_state:173" class="idref" href="#prev_state:173"><span class="id" title="binder">prev_state</span></a> <a id="new_state:174" class="idref" href="#new_state:174"><span class="id" title="binder">new_state</span></a> <a id="new_acts:175" class="idref" href="#new_acts:175"><span class="id" title="binder">new_acts</span></a> <a id="param:176" class="idref" href="#param:176"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="lqt_minted:177" class="idref" href="#lqt_minted:177"><span class="id" title="binder">lqt_minted</span></a> := <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.amount_to_N"><span class="id" title="definition">amount_to_N</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:172"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:173"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">/</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:173"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="tokens_deposited:178" class="idref" href="#tokens_deposited:178"><span class="id" title="binder">tokens_deposited</span></a> := <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.ceildiv_"><span class="id" title="definition">ceildiv_</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.amount_to_N"><span class="id" title="definition">amount_to_N</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:172"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:173"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>)) <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:173"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:171"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:172"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:173"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#AddLiquidity"><span class="id" title="constructor">AddLiquidity</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:176"><span class="id" title="variable">param</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:174"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:175"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:175"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:173"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenAddress"><span class="id" title="projection">tokenAddress</span></a>) 0%<span class="id" title="var">Z</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#msg_transfer"><span class="id" title="constructor">FA2Token.msg_transfer</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="ConCert.Examples.FA2.FA2LegacyInterface.html#build_transfer"><span class="id" title="constructor">build_transfer</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:172"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="ConCert.Examples.FA2.FA2LegacyInterface.html#build_transfer_destination"><span class="id" title="constructor">build_transfer_destination</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:172"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a>) <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:173"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenId"><span class="id" title="projection">tokenId</span></a>) <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#tokens_deposited:178"><span class="id" title="variable">tokens_deposited</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>))<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">);</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:173"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtAddress"><span class="id" title="projection">lqtAddress</span></a>) 0%<span class="id" title="var">Z</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#msg_mint_or_burn"><span class="id" title="constructor">Dexter2FA12.msg_mint_or_burn</span></a> {| <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#target"><span class="id" title="projection">target</span></a> := <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:176"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#owner"><span class="id" title="projection">owner</span></a>); <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#quantity"><span class="id" title="projection">quantity</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.of_N"><span class="id" title="definition">Z.of_N</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#lqt_minted:177"><span class="id" title="variable">lqt_minted</span></a>|}))<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">math_convert</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If the requirements are met then then receive on add_liquidity msg must succeed and
      if receive on add_liquidity msg succeeds then requirements must hold 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="add_liquidity_is_some" class="idref" href="#add_liquidity_is_some"><span class="id" title="lemma">add_liquidity_is_some</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:179" class="idref" href="#prev_state:179"><span class="id" title="binder">prev_state</span></a> <a id="chain:180" class="idref" href="#chain:180"><span class="id" title="binder">chain</span></a> <a id="ctx:181" class="idref" href="#ctx:181"><span class="id" title="binder">ctx</span></a> <a id="param:182" class="idref" href="#param:182"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="lqt_minted:183" class="idref" href="#lqt_minted:183"><span class="id" title="binder">lqt_minted</span></a> := <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.amount_to_N"><span class="id" title="definition">amount_to_N</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:181"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:179"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">/</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:179"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="tokens_deposited:184" class="idref" href="#tokens_deposited:184"><span class="id" title="binder">tokens_deposited</span></a> := <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.ceildiv_"><span class="id" title="definition">ceildiv_</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.amount_to_N"><span class="id" title="definition">amount_to_N</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:181"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:179"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>)) <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:179"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:179"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#selfIsUpdatingTokenPool"><span class="id" title="projection">selfIsUpdatingTokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:180"><span class="id" title="variable">chain</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:182"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#add_deadline"><span class="id" title="projection">add_deadline</span></a>))%<span class="id" title="var">nat</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#tokens_deposited:184"><span class="id" title="variable">tokens_deposited</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#2ccca3280733654024e33c2005ae2530"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:182"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#maxTokensDeposited"><span class="id" title="projection">maxTokensDeposited</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:182"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#minLqtMinted"><span class="id" title="projection">minLqtMinted</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#2ccca3280733654024e33c2005ae2530"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#lqt_minted:183"><span class="id" title="variable">lqt_minted</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:179"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:179"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtAddress"><span class="id" title="projection">lqtAddress</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#NullAddressAxiom.null_address"><span class="id" title="axiom">null_address</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="new_state:185" class="idref" href="#new_state:185"><span class="id" title="binder">new_state</span></a> <a id="new_acts:186" class="idref" href="#new_acts:186"><span class="id" title="binder">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:180"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:181"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:179"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#AddLiquidity"><span class="id" title="constructor">AddLiquidity</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:182"><span class="id" title="variable">param</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:185"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:186"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_hyps</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">math_convert</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.amount_to_N"><span class="id" title="definition">amount_to_N</span></a> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">destruct_address_eq</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab137"></a><h2 class="section">Remove liquidity correct</h2>
 <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#Dexter2.remove_liquidity"><span class="id" title="definition">remove_liquidity</span></a></span> only changes <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a></span>, <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a></span> and <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a></span> in state 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="remove_liquidity_state_eq" class="idref" href="#remove_liquidity_state_eq"><span class="id" title="lemma">remove_liquidity_state_eq</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:187" class="idref" href="#prev_state:187"><span class="id" title="binder">prev_state</span></a> <a id="new_state:188" class="idref" href="#new_state:188"><span class="id" title="binder">new_state</span></a> <a id="chain:189" class="idref" href="#chain:189"><span class="id" title="binder">chain</span></a> <a id="ctx:190" class="idref" href="#ctx:190"><span class="id" title="binder">ctx</span></a> <a id="new_acts:191" class="idref" href="#new_acts:191"><span class="id" title="binder">new_acts</span></a> <a id="param:192" class="idref" href="#param:192"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="xtz_withdrawn:193" class="idref" href="#xtz_withdrawn:193"><span class="id" title="binder">xtz_withdrawn</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:192"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtBurned"><span class="id" title="projection">lqtBurned</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:187"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">/</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:187"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="tokens_withdrawn:194" class="idref" href="#tokens_withdrawn:194"><span class="id" title="binder">tokens_withdrawn</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:192"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtBurned"><span class="id" title="projection">lqtBurned</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:187"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">/</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:187"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:189"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:190"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:187"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#RemoveLiquidity"><span class="id" title="constructor">RemoveLiquidity</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:192"><span class="id" title="variable">param</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:188"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:191"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:187"><span class="id" title="variable">prev_state</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">&lt;|</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">:=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:187"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:192"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtBurned"><span class="id" title="projection">lqtBurned</span></a>) <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">|&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">&lt;|</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">:=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:187"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#tokens_withdrawn:194"><span class="id" title="variable">tokens_withdrawn</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">|&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">&lt;|</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">:=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:187"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#xtz_withdrawn:193"><span class="id" title="variable">xtz_withdrawn</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">|&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:188"><span class="id" title="variable">new_state</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">math_convert</span>; <span class="id" title="tactic">cbv</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="remove_liquidity_correct" class="idref" href="#remove_liquidity_correct"><span class="id" title="lemma">remove_liquidity_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:195" class="idref" href="#prev_state:195"><span class="id" title="binder">prev_state</span></a> <a id="new_state:196" class="idref" href="#new_state:196"><span class="id" title="binder">new_state</span></a> <a id="chain:197" class="idref" href="#chain:197"><span class="id" title="binder">chain</span></a> <a id="ctx:198" class="idref" href="#ctx:198"><span class="id" title="binder">ctx</span></a> <a id="new_acts:199" class="idref" href="#new_acts:199"><span class="id" title="binder">new_acts</span></a> <a id="param:200" class="idref" href="#param:200"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:197"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:198"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:195"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#RemoveLiquidity"><span class="id" title="constructor">RemoveLiquidity</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:200"><span class="id" title="variable">param</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:196"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:199"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:196"><span class="id" title="variable">new_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:195"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:200"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtBurned"><span class="id" title="projection">lqtBurned</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:196"><span class="id" title="variable">new_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:195"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:200"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtBurned"><span class="id" title="projection">lqtBurned</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:195"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">/</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:195"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:196"><span class="id" title="variable">new_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:195"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:200"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtBurned"><span class="id" title="projection">lqtBurned</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:195"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">/</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:195"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#remove_liquidity_state_eq"><span class="id" title="lemma">remove_liquidity_state_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#Dexter2.remove_liquidity"><span class="id" title="definition">remove_liquidity</span></a></span> should produce three acts
<ul class="doclist">
<li> A call action to LQT contract burning <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtBurned"><span class="id" title="projection">lqtBurned</span></a></span> from <span class="inlinecode"><a class="idref" href="ConCert.Examples.Crowdfunding.CrowdfundingDataExt.html#sender"><span class="id" title="definition">sender</span></a></span>

</li>
<li> A call action to token contract transferring <span class="inlinecode"><span class="id" title="var">tokens_withdrawn</span></span> from this contract to <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#liquidity_to"><span class="id" title="projection">liquidity_to</span></a></span>

</li>
<li> A transfer action transferring <span class="inlinecode"><span class="id" title="var">xtz_withdrawn</span></span> from this contract to <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#liquidity_to"><span class="id" title="projection">liquidity_to</span></a></span>
   

</li>
</ul>
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="remove_liquidity_new_acts_correct" class="idref" href="#remove_liquidity_new_acts_correct"><span class="id" title="lemma">remove_liquidity_new_acts_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="chain:201" class="idref" href="#chain:201"><span class="id" title="binder">chain</span></a> <a id="ctx:202" class="idref" href="#ctx:202"><span class="id" title="binder">ctx</span></a> <a id="prev_state:203" class="idref" href="#prev_state:203"><span class="id" title="binder">prev_state</span></a> <a id="new_state:204" class="idref" href="#new_state:204"><span class="id" title="binder">new_state</span></a> <a id="new_acts:205" class="idref" href="#new_acts:205"><span class="id" title="binder">new_acts</span></a> <a id="param:206" class="idref" href="#param:206"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="xtz_withdrawn:207" class="idref" href="#xtz_withdrawn:207"><span class="id" title="binder">xtz_withdrawn</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:206"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtBurned"><span class="id" title="projection">lqtBurned</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:203"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">/</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:203"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="tokens_withdrawn:208" class="idref" href="#tokens_withdrawn:208"><span class="id" title="binder">tokens_withdrawn</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:206"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtBurned"><span class="id" title="projection">lqtBurned</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:203"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">/</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:203"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:201"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:202"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:203"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#RemoveLiquidity"><span class="id" title="constructor">RemoveLiquidity</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:206"><span class="id" title="variable">param</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:204"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:205"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:205"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:203"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtAddress"><span class="id" title="projection">lqtAddress</span></a>) 0%<span class="id" title="var">Z</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#msg_mint_or_burn"><span class="id" title="constructor">Dexter2FA12.msg_mint_or_burn</span></a> {| <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#target"><span class="id" title="projection">target</span></a> := <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:202"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>); <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#quantity"><span class="id" title="projection">quantity</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.of_N"><span class="id" title="definition">Z.of_N</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:206"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtBurned"><span class="id" title="projection">lqtBurned</span></a>)|}))<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">);</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:203"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenAddress"><span class="id" title="projection">tokenAddress</span></a>) 0%<span class="id" title="var">Z</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#msg_transfer"><span class="id" title="constructor">FA2Token.msg_transfer</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="ConCert.Examples.FA2.FA2LegacyInterface.html#build_transfer"><span class="id" title="constructor">build_transfer</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:202"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="ConCert.Examples.FA2.FA2LegacyInterface.html#build_transfer_destination"><span class="id" title="constructor">build_transfer_destination</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:206"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#liquidity_to"><span class="id" title="projection">liquidity_to</span></a>) <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:203"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenId"><span class="id" title="projection">tokenId</span></a>) <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#tokens_withdrawn:208"><span class="id" title="variable">tokens_withdrawn</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>))<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">);</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:206"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#liquidity_to"><span class="id" title="projection">liquidity_to</span></a>) (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.N_to_amount"><span class="id" title="definition">N_to_amount</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#xtz_withdrawn:207"><span class="id" title="variable">xtz_withdrawn</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">math_convert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.xtz_transfer"><span class="id" title="definition">xtz_transfer</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" title="var">H</span> : <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If the requirements are met then then receive on remove_liquidity msg must succeed and
      if receive on remove_liquidity msg succeeds then requirements must hold 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="remove_liquidity_is_some" class="idref" href="#remove_liquidity_is_some"><span class="id" title="lemma">remove_liquidity_is_some</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:209" class="idref" href="#prev_state:209"><span class="id" title="binder">prev_state</span></a> <a id="chain:210" class="idref" href="#chain:210"><span class="id" title="binder">chain</span></a> <a id="ctx:211" class="idref" href="#ctx:211"><span class="id" title="binder">ctx</span></a> <a id="param:212" class="idref" href="#param:212"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="xtz_withdrawn:213" class="idref" href="#xtz_withdrawn:213"><span class="id" title="binder">xtz_withdrawn</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:212"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtBurned"><span class="id" title="projection">lqtBurned</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:209"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">/</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:209"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="tokens_withdrawn:214" class="idref" href="#tokens_withdrawn:214"><span class="id" title="binder">tokens_withdrawn</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:212"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtBurned"><span class="id" title="projection">lqtBurned</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:209"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">/</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:209"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:209"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#selfIsUpdatingTokenPool"><span class="id" title="projection">selfIsUpdatingTokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:210"><span class="id" title="variable">chain</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:212"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#remove_deadline"><span class="id" title="projection">remove_deadline</span></a>))%<span class="id" title="var">nat</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:211"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> 0)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:209"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:212"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#minXtzWithdrawn"><span class="id" title="projection">minXtzWithdrawn</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#2ccca3280733654024e33c2005ae2530"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#xtz_withdrawn:213"><span class="id" title="variable">xtz_withdrawn</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:212"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#minTokensWithdrawn"><span class="id" title="projection">minTokensWithdrawn</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#2ccca3280733654024e33c2005ae2530"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#tokens_withdrawn:214"><span class="id" title="variable">tokens_withdrawn</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#tokens_withdrawn:214"><span class="id" title="variable">tokens_withdrawn</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#2ccca3280733654024e33c2005ae2530"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:209"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#xtz_withdrawn:213"><span class="id" title="variable">xtz_withdrawn</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#2ccca3280733654024e33c2005ae2530"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:209"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:212"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtBurned"><span class="id" title="projection">lqtBurned</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#2ccca3280733654024e33c2005ae2530"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:209"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:212"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#liquidity_to"><span class="id" title="projection">liquidity_to</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:209"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtAddress"><span class="id" title="projection">lqtAddress</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#NullAddressAxiom.null_address"><span class="id" title="axiom">null_address</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="new_state:215" class="idref" href="#new_state:215"><span class="id" title="binder">new_state</span></a> <a id="new_acts:216" class="idref" href="#new_acts:216"><span class="id" title="binder">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:210"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:211"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:209"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#RemoveLiquidity"><span class="id" title="constructor">RemoveLiquidity</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:212"><span class="id" title="variable">param</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:215"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:216"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_hyps</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">math_convert</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">destruct_address_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.xtz_transfer"><span class="id" title="definition">xtz_transfer</span></a> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">destruct_address_eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab138"></a><h2 class="section">XTZ to token correct</h2>
 <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#Dexter2.xtz_to_token"><span class="id" title="definition">xtz_to_token</span></a></span> only changes <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a></span> and <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a></span> in state 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="xtz_to_token_state_eq" class="idref" href="#xtz_to_token_state_eq"><span class="id" title="lemma">xtz_to_token_state_eq</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:217" class="idref" href="#prev_state:217"><span class="id" title="binder">prev_state</span></a> <a id="new_state:218" class="idref" href="#new_state:218"><span class="id" title="binder">new_state</span></a> <a id="chain:219" class="idref" href="#chain:219"><span class="id" title="binder">chain</span></a> <a id="ctx:220" class="idref" href="#ctx:220"><span class="id" title="binder">ctx</span></a> <a id="new_acts:221" class="idref" href="#new_acts:221"><span class="id" title="binder">new_acts</span></a> <a id="param:222" class="idref" href="#param:222"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="tokens_bought:223" class="idref" href="#tokens_bought:223"><span class="id" title="binder">tokens_bought</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.amount_to_N"><span class="id" title="definition">amount_to_N</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:220"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 997 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:217"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">/</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:217"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 1000 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.amount_to_N"><span class="id" title="definition">amount_to_N</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:220"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 997<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:219"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:220"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:217"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#XtzToToken"><span class="id" title="constructor">XtzToToken</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:222"><span class="id" title="variable">param</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:218"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:221"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:217"><span class="id" title="variable">prev_state</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">&lt;|</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">:=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:217"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#tokens_bought:223"><span class="id" title="variable">tokens_bought</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">|&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">&lt;|</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">:=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:217"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.amount_to_N"><span class="id" title="definition">amount_to_N</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:220"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a>) <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">|&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:218"><span class="id" title="variable">new_state</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">math_convert</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="xtz_to_token_correct" class="idref" href="#xtz_to_token_correct"><span class="id" title="lemma">xtz_to_token_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:224" class="idref" href="#prev_state:224"><span class="id" title="binder">prev_state</span></a> <a id="new_state:225" class="idref" href="#new_state:225"><span class="id" title="binder">new_state</span></a> <a id="chain:226" class="idref" href="#chain:226"><span class="id" title="binder">chain</span></a> <a id="ctx:227" class="idref" href="#ctx:227"><span class="id" title="binder">ctx</span></a> <a id="new_acts:228" class="idref" href="#new_acts:228"><span class="id" title="binder">new_acts</span></a> <a id="param:229" class="idref" href="#param:229"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:226"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:227"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:224"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#XtzToToken"><span class="id" title="constructor">XtzToToken</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:229"><span class="id" title="variable">param</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:225"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:228"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:225"><span class="id" title="variable">new_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:224"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.amount_to_N"><span class="id" title="definition">amount_to_N</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:227"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 997 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:224"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">/</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:224"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 1000 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.amount_to_N"><span class="id" title="definition">amount_to_N</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:227"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 997<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:225"><span class="id" title="variable">new_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:224"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.amount_to_N"><span class="id" title="definition">amount_to_N</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:227"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#xtz_to_token_state_eq"><span class="id" title="lemma">xtz_to_token_state_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#Dexter2.xtz_to_token"><span class="id" title="definition">xtz_to_token</span></a></span> should produce one action
<ul class="doclist">
<li> A call action to token contract transferring <span class="inlinecode"><span class="id" title="var">tokens_bought</span></span> from this contract to <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokens_to"><span class="id" title="projection">tokens_to</span></a></span>

</li>
</ul>
  
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="xtz_to_token_new_acts_correct" class="idref" href="#xtz_to_token_new_acts_correct"><span class="id" title="lemma">xtz_to_token_new_acts_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="chain:230" class="idref" href="#chain:230"><span class="id" title="binder">chain</span></a> <a id="ctx:231" class="idref" href="#ctx:231"><span class="id" title="binder">ctx</span></a> <a id="prev_state:232" class="idref" href="#prev_state:232"><span class="id" title="binder">prev_state</span></a> <a id="new_state:233" class="idref" href="#new_state:233"><span class="id" title="binder">new_state</span></a> <a id="new_acts:234" class="idref" href="#new_acts:234"><span class="id" title="binder">new_acts</span></a> <a id="param:235" class="idref" href="#param:235"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="tokens_bought:236" class="idref" href="#tokens_bought:236"><span class="id" title="binder">tokens_bought</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.amount_to_N"><span class="id" title="definition">amount_to_N</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:231"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 997 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:232"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">/</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:232"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 1000 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.amount_to_N"><span class="id" title="definition">amount_to_N</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:231"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 997<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:230"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:231"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:232"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#XtzToToken"><span class="id" title="constructor">XtzToToken</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:235"><span class="id" title="variable">param</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:233"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:234"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:234"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:232"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenAddress"><span class="id" title="projection">tokenAddress</span></a>) 0%<span class="id" title="var">Z</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#msg_transfer"><span class="id" title="constructor">FA2Token.msg_transfer</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="ConCert.Examples.FA2.FA2LegacyInterface.html#build_transfer"><span class="id" title="constructor">build_transfer</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:231"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="ConCert.Examples.FA2.FA2LegacyInterface.html#build_transfer_destination"><span class="id" title="constructor">build_transfer_destination</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:235"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokens_to"><span class="id" title="projection">tokens_to</span></a>) <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:232"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenId"><span class="id" title="projection">tokenId</span></a>) <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#tokens_bought:236"><span class="id" title="variable">tokens_bought</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>))<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">math_convert</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If the requirements are met then then receive on xtz_to_token msg must succeed and
      if receive on xtz_to_token msg succeeds then requirements must hold 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="xtz_to_token_is_some" class="idref" href="#xtz_to_token_is_some"><span class="id" title="lemma">xtz_to_token_is_some</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:237" class="idref" href="#prev_state:237"><span class="id" title="binder">prev_state</span></a> <a id="chain:238" class="idref" href="#chain:238"><span class="id" title="binder">chain</span></a> <a id="ctx:239" class="idref" href="#ctx:239"><span class="id" title="binder">ctx</span></a> <a id="param:240" class="idref" href="#param:240"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="tokens_bought:241" class="idref" href="#tokens_bought:241"><span class="id" title="binder">tokens_bought</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.amount_to_N"><span class="id" title="definition">amount_to_N</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:239"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 997 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:237"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">/</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:237"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 1000 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.amount_to_N"><span class="id" title="definition">amount_to_N</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:239"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 997<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:237"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#selfIsUpdatingTokenPool"><span class="id" title="projection">selfIsUpdatingTokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:238"><span class="id" title="variable">chain</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:240"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtt_deadline"><span class="id" title="projection">xtt_deadline</span></a>))%<span class="id" title="var">nat</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:237"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">\/</span></a> (0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:239"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a>))%<span class="id" title="var">Z</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:240"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#minTokensBought"><span class="id" title="projection">minTokensBought</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#2ccca3280733654024e33c2005ae2530"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#tokens_bought:241"><span class="id" title="variable">tokens_bought</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#tokens_bought:241"><span class="id" title="variable">tokens_bought</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#2ccca3280733654024e33c2005ae2530"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:237"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="new_state:242" class="idref" href="#new_state:242"><span class="id" title="binder">new_state</span></a> <a id="new_acts:243" class="idref" href="#new_acts:243"><span class="id" title="binder">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:238"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:239"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:237"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#XtzToToken"><span class="id" title="constructor">XtzToToken</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:240"><span class="id" title="variable">param</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:242"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:243"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_hyps</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">math_convert</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.amount_to_N"><span class="id" title="definition">amount_to_N</span></a> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">destruct_address_eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab139"></a><h2 class="section">Token to xtz correct</h2>
 <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#Dexter2.token_to_xtz"><span class="id" title="definition">token_to_xtz</span></a></span> only changes <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a></span> and <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a></span> in state 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="token_to_xtz_state_eq" class="idref" href="#token_to_xtz_state_eq"><span class="id" title="lemma">token_to_xtz_state_eq</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:244" class="idref" href="#prev_state:244"><span class="id" title="binder">prev_state</span></a> <a id="new_state:245" class="idref" href="#new_state:245"><span class="id" title="binder">new_state</span></a> <a id="chain:246" class="idref" href="#chain:246"><span class="id" title="binder">chain</span></a> <a id="ctx:247" class="idref" href="#ctx:247"><span class="id" title="binder">ctx</span></a> <a id="new_acts:248" class="idref" href="#new_acts:248"><span class="id" title="binder">new_acts</span></a> <a id="param:249" class="idref" href="#param:249"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="xtz_bought:250" class="idref" href="#xtz_bought:250"><span class="id" title="binder">xtz_bought</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:249"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokensSold"><span class="id" title="projection">tokensSold</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 997 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:244"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">/</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:244"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 1000 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:249"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokensSold"><span class="id" title="projection">tokensSold</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 997<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:246"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:247"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:244"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#TokenToXtz"><span class="id" title="constructor">TokenToXtz</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:249"><span class="id" title="variable">param</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:245"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:248"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:244"><span class="id" title="variable">prev_state</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">&lt;|</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">:=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:244"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:249"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokensSold"><span class="id" title="projection">tokensSold</span></a>) <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">|&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">&lt;|</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">:=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:244"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#xtz_bought:250"><span class="id" title="variable">xtz_bought</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">|&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:245"><span class="id" title="variable">new_state</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">math_convert</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="token_to_xtz_correct" class="idref" href="#token_to_xtz_correct"><span class="id" title="lemma">token_to_xtz_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:251" class="idref" href="#prev_state:251"><span class="id" title="binder">prev_state</span></a> <a id="new_state:252" class="idref" href="#new_state:252"><span class="id" title="binder">new_state</span></a> <a id="chain:253" class="idref" href="#chain:253"><span class="id" title="binder">chain</span></a> <a id="ctx:254" class="idref" href="#ctx:254"><span class="id" title="binder">ctx</span></a> <a id="new_acts:255" class="idref" href="#new_acts:255"><span class="id" title="binder">new_acts</span></a> <a id="param:256" class="idref" href="#param:256"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:253"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:254"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:251"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#TokenToXtz"><span class="id" title="constructor">TokenToXtz</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:256"><span class="id" title="variable">param</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:252"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:255"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:252"><span class="id" title="variable">new_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:251"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:256"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokensSold"><span class="id" title="projection">tokensSold</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:252"><span class="id" title="variable">new_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:251"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:256"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokensSold"><span class="id" title="projection">tokensSold</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 997 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:251"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">/</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:251"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 1000 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:256"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokensSold"><span class="id" title="projection">tokensSold</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 997<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#token_to_xtz_state_eq"><span class="id" title="lemma">token_to_xtz_state_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
token_to_xtz should produce two actions
<ul class="doclist">
<li> A call action to token contract transferring <span class="inlinecode"><a class="idref" href="ConCert.Examples.ExchangeBuggy.ExchangeBuggy.html#tokens_sold"><span class="id" title="projection">tokens_sold</span></a></span> from <span class="inlinecode"><a class="idref" href="ConCert.Examples.Crowdfunding.CrowdfundingDataExt.html#sender"><span class="id" title="definition">sender</span></a></span> to this contract

</li>
<li> A transfer action transferring <span class="inlinecode"><span class="id" title="var">xtz_bought</span></span> from this contract to <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtz_to"><span class="id" title="projection">xtz_to</span></a></span>
   

</li>
</ul>
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="token_to_xtz_new_acts_correct" class="idref" href="#token_to_xtz_new_acts_correct"><span class="id" title="lemma">token_to_xtz_new_acts_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="chain:257" class="idref" href="#chain:257"><span class="id" title="binder">chain</span></a> <a id="ctx:258" class="idref" href="#ctx:258"><span class="id" title="binder">ctx</span></a> <a id="prev_state:259" class="idref" href="#prev_state:259"><span class="id" title="binder">prev_state</span></a> <a id="new_state:260" class="idref" href="#new_state:260"><span class="id" title="binder">new_state</span></a> <a id="new_acts:261" class="idref" href="#new_acts:261"><span class="id" title="binder">new_acts</span></a> <a id="param:262" class="idref" href="#param:262"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="xtz_bought:263" class="idref" href="#xtz_bought:263"><span class="id" title="binder">xtz_bought</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:262"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokensSold"><span class="id" title="projection">tokensSold</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 997 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:259"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">/</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:259"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 1000 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:262"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokensSold"><span class="id" title="projection">tokensSold</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 997<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:257"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:258"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:259"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#TokenToXtz"><span class="id" title="constructor">TokenToXtz</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:262"><span class="id" title="variable">param</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:260"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:261"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:261"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:259"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenAddress"><span class="id" title="projection">tokenAddress</span></a>) 0%<span class="id" title="var">Z</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#msg_transfer"><span class="id" title="constructor">FA2Token.msg_transfer</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="ConCert.Examples.FA2.FA2LegacyInterface.html#build_transfer"><span class="id" title="constructor">build_transfer</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:258"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="ConCert.Examples.FA2.FA2LegacyInterface.html#build_transfer_destination"><span class="id" title="constructor">build_transfer_destination</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:258"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a>) <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:259"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenId"><span class="id" title="projection">tokenId</span></a>) <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:262"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokensSold"><span class="id" title="projection">tokensSold</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>))<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">);</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:262"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtz_to"><span class="id" title="projection">xtz_to</span></a>) (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.N_to_amount"><span class="id" title="definition">N_to_amount</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#xtz_bought:263"><span class="id" title="variable">xtz_bought</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">math_convert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.xtz_transfer"><span class="id" title="definition">xtz_transfer</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">H</span> : <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If the requirements are met then then receive on token_to_xtz msg must succeed and
      if receive on token_to_xtz msg succeeds then requirements must hold 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="token_to_xtz_is_some" class="idref" href="#token_to_xtz_is_some"><span class="id" title="lemma">token_to_xtz_is_some</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:264" class="idref" href="#prev_state:264"><span class="id" title="binder">prev_state</span></a> <a id="chain:265" class="idref" href="#chain:265"><span class="id" title="binder">chain</span></a> <a id="ctx:266" class="idref" href="#ctx:266"><span class="id" title="binder">ctx</span></a> <a id="param:267" class="idref" href="#param:267"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="xtz_bought:268" class="idref" href="#xtz_bought:268"><span class="id" title="binder">xtz_bought</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:267"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokensSold"><span class="id" title="projection">tokensSold</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 997 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:264"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">/</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:264"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 1000 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:267"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokensSold"><span class="id" title="projection">tokensSold</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 997<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:264"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#selfIsUpdatingTokenPool"><span class="id" title="projection">selfIsUpdatingTokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:265"><span class="id" title="variable">chain</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:267"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#ttx_deadline"><span class="id" title="projection">ttx_deadline</span></a>))%<span class="id" title="var">nat</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:266"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> 0)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:267"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#minXtzBought"><span class="id" title="projection">minXtzBought</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#2ccca3280733654024e33c2005ae2530"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#xtz_bought:268"><span class="id" title="variable">xtz_bought</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:264"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">\/</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:267"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokensSold"><span class="id" title="projection">tokensSold</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> 0<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:267"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtz_to"><span class="id" title="projection">xtz_to</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#xtz_bought:268"><span class="id" title="variable">xtz_bought</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#2ccca3280733654024e33c2005ae2530"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:264"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="new_state:269" class="idref" href="#new_state:269"><span class="id" title="binder">new_state</span></a> <a id="new_acts:270" class="idref" href="#new_acts:270"><span class="id" title="binder">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:265"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:266"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:264"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#TokenToXtz"><span class="id" title="constructor">TokenToXtz</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:267"><span class="id" title="variable">param</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:269"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:270"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_hyps</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">math_convert</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">destruct_address_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.xtz_transfer"><span class="id" title="definition">xtz_transfer</span></a> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">destruct_address_eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab140"></a><h2 class="section">Token to token correct</h2>
 <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#Dexter2.token_to_token"><span class="id" title="definition">token_to_token</span></a></span> only changes <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a></span> and <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a></span> in state 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="token_to_token_state_eq" class="idref" href="#token_to_token_state_eq"><span class="id" title="lemma">token_to_token_state_eq</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:271" class="idref" href="#prev_state:271"><span class="id" title="binder">prev_state</span></a> <a id="new_state:272" class="idref" href="#new_state:272"><span class="id" title="binder">new_state</span></a> <a id="chain:273" class="idref" href="#chain:273"><span class="id" title="binder">chain</span></a> <a id="ctx:274" class="idref" href="#ctx:274"><span class="id" title="binder">ctx</span></a> <a id="new_acts:275" class="idref" href="#new_acts:275"><span class="id" title="binder">new_acts</span></a> <a id="param:276" class="idref" href="#param:276"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="xtz_bought:277" class="idref" href="#xtz_bought:277"><span class="id" title="binder">xtz_bought</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:276"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokensSold_"><span class="id" title="projection">tokensSold_</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 997 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:271"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">/</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:271"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 1000 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:276"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokensSold_"><span class="id" title="projection">tokensSold_</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 997<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:273"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:274"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:271"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#TokenToToken"><span class="id" title="constructor">TokenToToken</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:276"><span class="id" title="variable">param</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:272"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:275"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:271"><span class="id" title="variable">prev_state</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">&lt;|</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">:=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:271"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:276"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokensSold_"><span class="id" title="projection">tokensSold_</span></a>) <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">|&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">&lt;|</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">:=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:271"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#xtz_bought:277"><span class="id" title="variable">xtz_bought</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">|&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:272"><span class="id" title="variable">new_state</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">math_convert</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="token_to_token_correct" class="idref" href="#token_to_token_correct"><span class="id" title="lemma">token_to_token_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:278" class="idref" href="#prev_state:278"><span class="id" title="binder">prev_state</span></a> <a id="new_state:279" class="idref" href="#new_state:279"><span class="id" title="binder">new_state</span></a> <a id="chain:280" class="idref" href="#chain:280"><span class="id" title="binder">chain</span></a> <a id="ctx:281" class="idref" href="#ctx:281"><span class="id" title="binder">ctx</span></a> <a id="new_acts:282" class="idref" href="#new_acts:282"><span class="id" title="binder">new_acts</span></a> <a id="param:283" class="idref" href="#param:283"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:280"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:281"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:278"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#TokenToToken"><span class="id" title="constructor">TokenToToken</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:283"><span class="id" title="variable">param</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:279"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:282"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:279"><span class="id" title="variable">new_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:278"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:283"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokensSold_"><span class="id" title="projection">tokensSold_</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:279"><span class="id" title="variable">new_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:278"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:283"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokensSold_"><span class="id" title="projection">tokensSold_</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 997 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:278"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">/</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:278"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 1000 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:283"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokensSold_"><span class="id" title="projection">tokensSold_</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 997<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#::N_scope:x_'-'_x"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#token_to_token_state_eq"><span class="id" title="lemma">token_to_token_state_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
token_to_token should produce two actions
<ul class="doclist">
<li> A call action to token contract transferring <span class="inlinecode"><a class="idref" href="ConCert.Examples.ExchangeBuggy.ExchangeBuggy.html#tokens_sold"><span class="id" title="projection">tokens_sold</span></a></span> from <span class="inlinecode"><a class="idref" href="ConCert.Examples.Crowdfunding.CrowdfundingDataExt.html#sender"><span class="id" title="definition">sender</span></a></span> to this contract

</li>
<li> A call action to <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#outputDexterContract"><span class="id" title="projection">outputDexterContract</span></a></span> <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#Dexter2.xtz_to_token"><span class="id" title="definition">xtz_to_token</span></a></span> entrypoint with <span class="inlinecode"><span class="id" title="var">xtz_bought</span></span> amount attached
   

</li>
</ul>
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="token_to_token_new_acts_correct" class="idref" href="#token_to_token_new_acts_correct"><span class="id" title="lemma">token_to_token_new_acts_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="chain:284" class="idref" href="#chain:284"><span class="id" title="binder">chain</span></a> <a id="ctx:285" class="idref" href="#ctx:285"><span class="id" title="binder">ctx</span></a> <a id="prev_state:286" class="idref" href="#prev_state:286"><span class="id" title="binder">prev_state</span></a> <a id="new_state:287" class="idref" href="#new_state:287"><span class="id" title="binder">new_state</span></a> <a id="new_acts:288" class="idref" href="#new_acts:288"><span class="id" title="binder">new_acts</span></a> <a id="param:289" class="idref" href="#param:289"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="xtz_bought:290" class="idref" href="#xtz_bought:290"><span class="id" title="binder">xtz_bought</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:289"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokensSold_"><span class="id" title="projection">tokensSold_</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 997 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:286"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">/</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:286"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 1000 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:289"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokensSold_"><span class="id" title="projection">tokensSold_</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 997<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:284"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:285"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:286"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#TokenToToken"><span class="id" title="constructor">TokenToToken</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:289"><span class="id" title="variable">param</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:287"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:288"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:288"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:286"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenAddress"><span class="id" title="projection">tokenAddress</span></a>) 0%<span class="id" title="var">Z</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#msg_transfer"><span class="id" title="constructor">FA2Token.msg_transfer</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="ConCert.Examples.FA2.FA2LegacyInterface.html#build_transfer"><span class="id" title="constructor">build_transfer</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:285"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="ConCert.Examples.FA2.FA2LegacyInterface.html#build_transfer_destination"><span class="id" title="constructor">build_transfer_destination</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:285"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a>) <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:286"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenId"><span class="id" title="projection">tokenId</span></a>) <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:289"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokensSold_"><span class="id" title="projection">tokensSold_</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>))<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">);</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:289"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#outputDexterContract"><span class="id" title="projection">outputDexterContract</span></a>) (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.N_to_amount"><span class="id" title="definition">N_to_amount</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#xtz_bought:290"><span class="id" title="variable">xtz_bought</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> ((<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#XtzToToken"><span class="id" title="constructor">XtzToToken</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{| <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokens_to"><span class="id" title="projection">tokens_to</span></a> := <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:289"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#to_"><span class="id" title="projection">to_</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#minTokensBought"><span class="id" title="projection">minTokensBought</span></a> := <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:289"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#minTokensBought_"><span class="id" title="projection">minTokensBought_</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtt_deadline"><span class="id" title="projection">xtt_deadline</span></a> := <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:289"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#ttt_deadline"><span class="id" title="projection">ttt_deadline</span></a>) |}))))<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">math_convert</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If the requirements are met then then receive on token_to_token msg must succeed and
      if receive on token_to_token msg succeeds then requirements must hold 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="token_to_token_is_some" class="idref" href="#token_to_token_is_some"><span class="id" title="lemma">token_to_token_is_some</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:291" class="idref" href="#prev_state:291"><span class="id" title="binder">prev_state</span></a> <a id="chain:292" class="idref" href="#chain:292"><span class="id" title="binder">chain</span></a> <a id="ctx:293" class="idref" href="#ctx:293"><span class="id" title="binder">ctx</span></a> <a id="param:294" class="idref" href="#param:294"><span class="id" title="binder">param</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="xtz_bought:295" class="idref" href="#xtz_bought:295"><span class="id" title="binder">xtz_bought</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:294"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokensSold_"><span class="id" title="projection">tokensSold_</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 997 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:291"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">/</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:291"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 1000 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:294"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokensSold_"><span class="id" title="projection">tokensSold_</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#fe1417cc32a1703619b26940ce957c6a"><span class="id" title="notation">*</span></a> 997<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#be3f246709fdc565d9577f86645e6da3"><span class="id" title="notation">)</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:291"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#selfIsUpdatingTokenPool"><span class="id" title="projection">selfIsUpdatingTokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:292"><span class="id" title="variable">chain</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:294"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#ttt_deadline"><span class="id" title="projection">ttt_deadline</span></a>))%<span class="id" title="var">nat</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:293"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> 0)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#xtz_bought:295"><span class="id" title="variable">xtz_bought</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#2ccca3280733654024e33c2005ae2530"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:291"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:291"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">\/</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:294"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokensSold_"><span class="id" title="projection">tokensSold_</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> 0<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="new_state:296" class="idref" href="#new_state:296"><span class="id" title="binder">new_state</span></a> <a id="new_acts:297" class="idref" href="#new_acts:297"><span class="id" title="binder">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.receive_cpmm"><span class="id" title="definition">receive_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:292"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:293"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#prev_state:291"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#TokenToToken"><span class="id" title="constructor">TokenToToken</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#param:294"><span class="id" title="variable">param</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_state:296"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#new_acts:297"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_hyps</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">math_convert</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">destruct_address_eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab141"></a><h2 class="section">Init correct</h2>

</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="init_state_eq" class="idref" href="#init_state_eq"><span class="id" title="lemma">init_state_eq</span></a> : <span class="id" title="keyword">forall</span> <a id="chain:298" class="idref" href="#chain:298"><span class="id" title="binder">chain</span></a> <a id="ctx:299" class="idref" href="#ctx:299"><span class="id" title="binder">ctx</span></a> <a id="setup:300" class="idref" href="#setup:300"><span class="id" title="binder">setup</span></a> <a id="state:301" class="idref" href="#state:301"><span class="id" title="binder">state</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.init_cpmm"><span class="id" title="definition">init_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:298"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:299"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#setup:300"><span class="id" title="variable">setup</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#state:301"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#state:301"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">{|</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a> := 0;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a> := 0;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a> := <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#setup:300"><span class="id" title="variable">setup</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal_"><span class="id" title="projection">lqtTotal_</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#selfIsUpdatingTokenPool"><span class="id" title="projection">selfIsUpdatingTokenPool</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#freezeBaker"><span class="id" title="projection">freezeBaker</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#manager"><span class="id" title="projection">manager</span></a> := <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#setup:300"><span class="id" title="variable">setup</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#manager_"><span class="id" title="projection">manager_</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenAddress"><span class="id" title="projection">tokenAddress</span></a> := <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#setup:300"><span class="id" title="variable">setup</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenAddress_"><span class="id" title="projection">tokenAddress_</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtAddress"><span class="id" title="projection">lqtAddress</span></a> := <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#NullAddressAxiom.null_address"><span class="id" title="axiom">null_address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenId"><span class="id" title="projection">tokenId</span></a> := <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#setup:300"><span class="id" title="variable">setup</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenId_"><span class="id" title="projection">tokenId_</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">|}</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">init_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="init_correct" class="idref" href="#init_correct"><span class="id" title="lemma">init_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="chain:302" class="idref" href="#chain:302"><span class="id" title="binder">chain</span></a> <a id="ctx:303" class="idref" href="#ctx:303"><span class="id" title="binder">ctx</span></a> <a id="setup:304" class="idref" href="#setup:304"><span class="id" title="binder">setup</span></a> <a id="state:305" class="idref" href="#state:305"><span class="id" title="binder">state</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.init_cpmm"><span class="id" title="definition">init_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:302"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:303"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#setup:304"><span class="id" title="variable">setup</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#state:305"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenPool"><span class="id" title="projection">tokenPool</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#state:305"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#state:305"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#state:305"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#setup:304"><span class="id" title="variable">setup</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal_"><span class="id" title="projection">lqtTotal_</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#selfIsUpdatingTokenPool"><span class="id" title="projection">selfIsUpdatingTokenPool</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#state:305"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#freezeBaker"><span class="id" title="projection">freezeBaker</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#state:305"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#manager"><span class="id" title="projection">manager</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#state:305"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#setup:304"><span class="id" title="variable">setup</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#manager_"><span class="id" title="projection">manager_</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenAddress"><span class="id" title="projection">tokenAddress</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#state:305"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#setup:304"><span class="id" title="variable">setup</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenAddress_"><span class="id" title="projection">tokenAddress_</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtAddress"><span class="id" title="projection">lqtAddress</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#state:305"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#NullAddressAxiom.null_address"><span class="id" title="axiom">null_address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenId"><span class="id" title="projection">tokenId</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#state:305"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#setup:304"><span class="id" title="variable">setup</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenId_"><span class="id" title="projection">tokenId_</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">init_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#init_state_eq"><span class="id" title="lemma">init_state_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">init_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Initialization should always succeed 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="init_is_some" class="idref" href="#init_is_some"><span class="id" title="lemma">init_is_some</span></a> : <span class="id" title="keyword">forall</span> <a id="chain:306" class="idref" href="#chain:306"><span class="id" title="binder">chain</span></a> <a id="ctx:307" class="idref" href="#ctx:307"><span class="id" title="binder">ctx</span></a> <a id="setup:308" class="idref" href="#setup:308"><span class="id" title="binder">setup</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="state:309" class="idref" href="#state:309"><span class="id" title="binder">state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.init_cpmm"><span class="id" title="definition">init_cpmm</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#chain:306"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:307"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#setup:308"><span class="id" title="variable">setup</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#state:309"><span class="id" title="variable">state</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
<a id="lab142"></a><h2 class="section">Outgoing acts facts</h2>
 If contract emits self calls then they are for the XtzToToken entrypoint or default entrypoint 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="self_calls'" class="idref" href="#self_calls'"><span class="id" title="lemma">self_calls'</span></a> <a id="bstate:310" class="idref" href="#bstate:310"><span class="id" title="binder">bstate</span></a> <a id="caddr:311" class="idref" href="#caddr:311"><span class="id" title="binder">caddr</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:310"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:310"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:311"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="cstate:312" class="idref" href="#cstate:312"><span class="id" title="binder">cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:310"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:311"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#cstate:312"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#tokenAddress"><span class="id" title="projection">tokenAddress</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#cstate:312"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:311"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <a id="act_body:313" class="idref" href="#act_body:313"><span class="id" title="binder">act_body</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#act_body:313"><span class="id" title="variable">act_body</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#to"><span class="id" title="projection">to</span></a> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#to"><span class="id" title="projection">to</span></a> <span class="id" title="var">_</span> <span class="id" title="var">msg</span> =&gt; <span class="id" title="var">to</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:311"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="p:315" class="idref" href="#p:315"><span class="id" title="binder">p</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">msg</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#XtzToToken"><span class="id" title="constructor">XtzToToken</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#p:315"><span class="id" title="variable">p</span></a>))<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">\/</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="p:316" class="idref" href="#p:316"><span class="id" title="binder">p</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">msg</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#msg_mint_or_burn"><span class="id" title="constructor">msg_mint_or_burn</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#p:316"><span class="id" title="variable">p</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>) (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:310"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:311"><span class="id" title="variable">caddr</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_induction</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.list.html#Forall_cons"><span class="id" title="lemma">list.Forall_cons</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> <span class="id" title="var">IH</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">destruct_message</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_acts_correct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_state_eq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall_app"><span class="id" title="lemma">Forall_app</span></a>; <span class="id" title="tactic">split</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>; <span class="id" title="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ?<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.list.html#Forall_cons"><span class="id" title="lemma">list.Forall_cons</span></a>, ?<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.list.html#Forall_nil"><span class="id" title="lemma">list.Forall_nil</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">destruct_message</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_acts_correct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_state_eq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall_app"><span class="id" title="lemma">Forall_app</span></a>; <span class="id" title="tactic">split</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.list.html#Forall_cons"><span class="id" title="lemma">list.Forall_cons</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> [? <span class="id" title="var">IH</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>; <span class="id" title="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ?<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.list.html#Forall_cons"><span class="id" title="lemma">list.Forall_cons</span></a>, ?<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.list.html#Forall_nil"><span class="id" title="lemma">list.Forall_nil</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">perm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">solve_facts</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">Z_scope</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="call_amount_zero" class="idref" href="#call_amount_zero"><span class="id" title="lemma">call_amount_zero</span></a> <a id="bstate:317" class="idref" href="#bstate:317"><span class="id" title="binder">bstate</span></a> <a id="caddr:318" class="idref" href="#caddr:318"><span class="id" title="binder">caddr</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:317"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:317"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:318"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <a id="act_body:319" class="idref" href="#act_body:319"><span class="id" title="binder">act_body</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#act_body:319"><span class="id" title="variable">act_body</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <span class="id" title="var">_</span> <a class="idref" href="ConCert.Examples.FA2.FA2LegacyInterface.html#amount"><span class="id" title="projection">amount</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <span class="id" title="var">_</span> <a class="idref" href="ConCert.Examples.FA2.FA2LegacyInterface.html#amount"><span class="id" title="projection">amount</span></a> <span class="id" title="var">msg</span> =&gt; <span class="id" title="var">amount</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">\/</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="p:321" class="idref" href="#p:321"><span class="id" title="binder">p</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">msg</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#XtzToToken"><span class="id" title="constructor">XtzToToken</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#p:321"><span class="id" title="variable">p</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_deploy"><span class="id" title="constructor">act_deploy</span></a> <a class="idref" href="ConCert.Examples.FA2.FA2LegacyInterface.html#amount"><span class="id" title="projection">amount</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">amount</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>) (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:317"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:318"><span class="id" title="variable">caddr</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#lift_outgoing_acts_prop"><span class="id" title="lemma">lift_outgoing_acts_prop</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.contract"><span class="id" title="definition">contract</span></a>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_message</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_acts_correct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ?<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.list.html#Forall_cons"><span class="id" title="lemma">list.Forall_cons</span></a>, <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.list.html#Forall_nil"><span class="id" title="lemma">list.Forall_nil</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="no_contract_deployment" class="idref" href="#no_contract_deployment"><span class="id" title="lemma">no_contract_deployment</span></a> <a id="bstate:322" class="idref" href="#bstate:322"><span class="id" title="binder">bstate</span></a> <a id="caddr:323" class="idref" href="#caddr:323"><span class="id" title="binder">caddr</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:322"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:322"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:323"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <a id="act_body:324" class="idref" href="#act_body:324"><span class="id" title="binder">act_body</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#act_body:324"><span class="id" title="variable">act_body</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_deploy"><span class="id" title="constructor">act_deploy</span></a> <a class="idref" href="ConCert.Examples.FA2.FA2LegacyInterface.html#amount"><span class="id" title="projection">amount</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>) (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:322"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:323"><span class="id" title="variable">caddr</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#lift_outgoing_acts_prop"><span class="id" title="lemma">lift_outgoing_acts_prop</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.contract"><span class="id" title="definition">contract</span></a>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_message</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_acts_correct</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab143"></a><h2 class="section">Contract balance facts</h2>

</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="contract_balance_correct'" class="idref" href="#contract_balance_correct'"><span class="id" title="lemma">contract_balance_correct'</span></a> : <span class="id" title="keyword">forall</span> <a id="bstate:326" class="idref" href="#bstate:326"><span class="id" title="binder">bstate</span></a> <a id="caddr:327" class="idref" href="#caddr:327"><span class="id" title="binder">caddr</span></a> (<a id="trace:328" class="idref" href="#trace:328"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:326"><span class="id" title="variable">bstate</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="effective_balance:330" class="idref" href="#effective_balance:330"><span class="id" title="binder">effective_balance</span></a> := (<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:326"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:327"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Utils.Extras.html#sumZ"><span class="id" title="definition">sumZ</span></a> (<span class="id" title="keyword">fun</span> <a id="act:329" class="idref" href="#act:329"><span class="id" title="binder">act</span></a> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#act_body_amount"><span class="id" title="definition">act_body_amount</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#act:329"><span class="id" title="variable">act</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:326"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:327"><span class="id" title="variable">caddr</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">)</span></a>)%<span class="id" title="var">Z</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:326"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:327"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="cstate:331" class="idref" href="#cstate:331"><span class="id" title="binder">cstate</span></a> <a id="deploy_info:332" class="idref" href="#deploy_info:332"><span class="id" title="binder">deploy_info</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:326"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:327"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#cstate:331"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#Setup"><span class="id" title="record">Setup</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#trace:328"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:327"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#deploy_info:332"><span class="id" title="variable">deploy_info</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#deploy_info:332"><span class="id" title="variable">deploy_info</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_amount"><span class="id" title="projection">deployment_amount</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.of_N"><span class="id" title="definition">Z.of_N</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#cstate:331"><span class="id" title="variable">cstate</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#effective_balance:330"><span class="id" title="variable">effective_balance</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">effective_balance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_induction</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#init_correct"><span class="id" title="lemma">init_correct</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">init_some</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">_</span> &amp; ? &amp; <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">instantiate</span> (<span class="id" title="var">CallFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <a id="ctx:333" class="idref" href="#ctx:333"><span class="id" title="binder">ctx</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:333"><span class="id" title="variable">ctx</span></a>)%<span class="id" title="var">Z</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">CallFacts</span> <span class="id" title="tactic">in</span> <span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_message</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_acts_correct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_state_eq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_receive_is_some</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.N_to_amount"><span class="id" title="definition">N_to_amount</span></a> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : (?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> ?<span class="id" title="var">y</span>)%<span class="id" title="var">Z</span>, <span class="id" title="var">G</span> : (?<span class="id" title="var">y</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> ?<span class="id" title="var">x</span>)%<span class="id" title="var">Z</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.le_antisymm"><span class="id" title="lemma">Z.le_antisymm</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <span class="id" title="var">CallFacts</span> <span class="id" title="tactic">in</span> <span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">head</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IH</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">action_facts</span> <span class="id" title="keyword">as</span> (? &amp; ? &amp; ?);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_message</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_acts_correct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_state_eq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_receive_is_some</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.N_to_amount"><span class="id" title="definition">N_to_amount</span></a> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : (?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> ?<span class="id" title="var">y</span>)%<span class="id" title="var">Z</span>, <span class="id" title="var">G</span> : (?<span class="id" title="var">y</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> ?<span class="id" title="var">x</span>)%<span class="id" title="var">Z</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.le_antisymm"><span class="id" title="lemma">Z.le_antisymm</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">erewrite</span> <a class="idref" href="ConCert.Utils.Extras.html#sumZ_permutation"><span class="id" title="lemma">sumZ_permutation</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IH</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">solve_facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.ge_le"><span class="id" title="lemma">Z.ge_le</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="no_transfers" class="idref" href="#no_transfers"><span class="id" title="definition">no_transfers</span></a> (<a id="queue:334" class="idref" href="#queue:334"><span class="id" title="binder">queue</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <a id="act_body:335" class="idref" href="#act_body:335"><span class="id" title="binder">act_body</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#act_body:335"><span class="id" title="variable">act_body</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#to"><span class="id" title="projection">to</span></a> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#to"><span class="id" title="projection">to</span></a> <span class="id" title="var">_</span> <span class="id" title="var">msg</span> =&gt; <span class="id" title="keyword">forall</span> <a id="p:337" class="idref" href="#p:337"><span class="id" title="binder">p</span></a>, <span class="id" title="var">msg</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#XtzToToken"><span class="id" title="constructor">XtzToToken</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#p:337"><span class="id" title="variable">p</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>) <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#queue:334"><span class="id" title="variable">queue</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="contract_balance_correct" class="idref" href="#contract_balance_correct"><span class="id" title="lemma">contract_balance_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="bstate:338" class="idref" href="#bstate:338"><span class="id" title="binder">bstate</span></a> <a id="caddr:339" class="idref" href="#caddr:339"><span class="id" title="binder">caddr</span></a> (<a id="trace:340" class="idref" href="#trace:340"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:338"><span class="id" title="variable">bstate</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:338"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:339"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="cstate:341" class="idref" href="#cstate:341"><span class="id" title="binder">cstate</span></a> <a id="deploy_info:342" class="idref" href="#deploy_info:342"><span class="id" title="binder">deploy_info</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:338"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:339"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#cstate:341"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#Setup"><span class="id" title="record">Setup</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#trace:340"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:339"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#deploy_info:342"><span class="id" title="variable">deploy_info</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#deploy_info:342"><span class="id" title="variable">deploy_info</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_amount"><span class="id" title="projection">deployment_amount</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#no_transfers"><span class="id" title="definition">no_transfers</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:338"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:339"><span class="id" title="variable">caddr</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.of_N"><span class="id" title="definition">Z.of_N</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#cstate:341"><span class="id" title="variable">cstate</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:338"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:339"><span class="id" title="variable">caddr</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#contract_balance_correct'"><span class="id" title="lemma">contract_balance_correct'</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed</span> <span class="id" title="keyword">as</span> <span class="id" title="var">balance_correct</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">balance_correct</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">cstate</span> &amp; <span class="id" title="var">deploy_info</span> &amp; <span class="id" title="var">deployed_state</span> &amp; ? &amp; <span class="id" title="var">balance_correct</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#call_amount_zero"><span class="id" title="lemma">call_amount_zero</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed</span> <span class="id" title="keyword">as</span> <span class="id" title="var">amount_zero</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">balance_correct</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">balance_correct</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rename</span> <span class="id" title="var">H1</span> <span class="id" title="var">into</span> <span class="id" title="var">no_transfer</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#no_transfers"><span class="id" title="definition">no_transfers</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">no_transfer</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">sum_zero</span> : <a class="idref" href="ConCert.Utils.Extras.html#sumZ"><span class="id" title="definition">sumZ</span></a> (<span class="id" title="keyword">fun</span> <a id="act:344" class="idref" href="#act:344"><span class="id" title="binder">act</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#act_body_amount"><span class="id" title="definition">act_body_amount</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#act:343"><span class="id" title="variable">act</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0%<span class="id" title="var">Z</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.list.html#Forall_cons"><span class="id" title="lemma">list.Forall_cons</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">no_transfer</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">no_transfer</span> &amp; <span class="id" title="var">no_transfers</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.list.html#Forall_cons"><span class="id" title="lemma">list.Forall_cons</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">amount_zero</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">amount_zero</span> &amp; <span class="id" title="var">amounts_zero</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHl</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">IHl</span> <span class="id" title="var">no_transfers</span> <span class="id" title="var">amounts_zero</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">amount_zero</span> <span class="id" title="keyword">as</span> [-&gt; | []].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="xtz_pool_bound" class="idref" href="#xtz_pool_bound"><span class="id" title="lemma">xtz_pool_bound</span></a> : <span class="id" title="keyword">forall</span> <a id="bstate:345" class="idref" href="#bstate:345"><span class="id" title="binder">bstate</span></a> <a id="caddr:346" class="idref" href="#caddr:346"><span class="id" title="binder">caddr</span></a> (<a id="trace:347" class="idref" href="#trace:347"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:345"><span class="id" title="variable">bstate</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="effective_balance:349" class="idref" href="#effective_balance:349"><span class="id" title="binder">effective_balance</span></a> := (<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:345"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:346"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Utils.Extras.html#sumZ"><span class="id" title="definition">sumZ</span></a> (<span class="id" title="keyword">fun</span> <a id="act:348" class="idref" href="#act:348"><span class="id" title="binder">act</span></a> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#act_body_amount"><span class="id" title="definition">act_body_amount</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#act:348"><span class="id" title="variable">act</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:345"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:346"><span class="id" title="variable">caddr</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">)</span></a>)%<span class="id" title="var">Z</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:345"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:346"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="cstate:350" class="idref" href="#cstate:350"><span class="id" title="binder">cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:345"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:346"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#cstate:350"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.of_N"><span class="id" title="definition">Z.of_N</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#cstate:350"><span class="id" title="variable">cstate</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#effective_balance:349"><span class="id" title="variable">effective_balance</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">effective_balance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_induction</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">instantiate</span> (<span class="id" title="var">DeployFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <a id="ctx:351" class="idref" href="#ctx:351"><span class="id" title="binder">ctx</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:351"><span class="id" title="variable">ctx</span></a>)%<span class="id" title="var">Z</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">DeployFacts</span> <span class="id" title="tactic">in</span> <span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#init_correct"><span class="id" title="lemma">init_correct</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">init_some</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">_</span> &amp; -&gt; &amp; <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">instantiate</span> (<span class="id" title="var">CallFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <a id="ctx:352" class="idref" href="#ctx:352"><span class="id" title="binder">ctx</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:352"><span class="id" title="variable">ctx</span></a>)%<span class="id" title="var">Z</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">CallFacts</span> <span class="id" title="tactic">in</span> <span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_message</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_acts_correct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_state_eq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_receive_is_some</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.N_to_amount"><span class="id" title="definition">N_to_amount</span></a> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : (?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> ?<span class="id" title="var">y</span>)%<span class="id" title="var">Z</span>, <span class="id" title="var">G</span> : (?<span class="id" title="var">y</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> ?<span class="id" title="var">x</span>)%<span class="id" title="var">Z</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.le_antisymm"><span class="id" title="lemma">Z.le_antisymm</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <span class="id" title="var">CallFacts</span> <span class="id" title="tactic">in</span> <span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">head</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IH</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">action_facts</span> <span class="id" title="keyword">as</span> (? &amp; ? &amp; ?);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_message</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_acts_correct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_state_eq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_receive_is_some</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.N_to_amount"><span class="id" title="definition">N_to_amount</span></a> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : (?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> ?<span class="id" title="var">y</span>)%<span class="id" title="var">Z</span>, <span class="id" title="var">G</span> : (?<span class="id" title="var">y</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> ?<span class="id" title="var">x</span>)%<span class="id" title="var">Z</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.le_antisymm"><span class="id" title="lemma">Z.le_antisymm</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">erewrite</span> <a class="idref" href="ConCert.Utils.Extras.html#sumZ_permutation"><span class="id" title="lemma">sumZ_permutation</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IH</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">solve_facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.ge_le"><span class="id" title="lemma">Z.ge_le</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="transfer_bound" class="idref" href="#transfer_bound"><span class="id" title="lemma">transfer_bound</span></a> <a id="bstate:353" class="idref" href="#bstate:353"><span class="id" title="binder">bstate</span></a> <a id="caddr:354" class="idref" href="#caddr:354"><span class="id" title="binder">caddr</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="transfered_balance:356" class="idref" href="#transfered_balance:356"><span class="id" title="binder">transfered_balance</span></a> := <a class="idref" href="ConCert.Utils.Extras.html#sumZ"><span class="id" title="definition">sumZ</span></a> (<span class="id" title="keyword">fun</span> <a id="act:355" class="idref" href="#act:355"><span class="id" title="binder">act</span></a> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#act_body_amount"><span class="id" title="definition">act_body_amount</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#act:355"><span class="id" title="variable">act</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:353"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:354"><span class="id" title="variable">caddr</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:353"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:353"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:354"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="cstate:357" class="idref" href="#cstate:357"><span class="id" title="binder">cstate</span></a> : <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#State"><span class="id" title="record">State</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:353"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:354"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#cstate:357"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#transfered_balance:356"><span class="id" title="variable">transfered_balance</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:353"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:354"><span class="id" title="variable">caddr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">transfered_balance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_induction</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">instantiate</span> (<span class="id" title="var">DeployFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <a id="ctx:358" class="idref" href="#ctx:358"><span class="id" title="binder">ctx</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:358"><span class="id" title="variable">ctx</span></a>)%<span class="id" title="var">Z</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">instantiate</span> (<span class="id" title="var">CallFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <a id="ctx:359" class="idref" href="#ctx:359"><span class="id" title="binder">ctx</span></a> <a id="state:360" class="idref" href="#state:360"><span class="id" title="binder">state</span></a> <a id="out_acts:361" class="idref" href="#out_acts:361"><span class="id" title="binder">out_acts</span></a> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:359"><span class="id" title="variable">ctx</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.of_N"><span class="id" title="definition">Z.of_N</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#xtzPool"><span class="id" title="projection">xtzPool</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#state:360"><span class="id" title="variable">state</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_balance"><span class="id" title="projection">ctx_contract_balance</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#ctx:359"><span class="id" title="variable">ctx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Utils.Extras.html#sumZ"><span class="id" title="definition">sumZ</span></a> (<span class="id" title="keyword">fun</span> <a id="act:362" class="idref" href="#act:362"><span class="id" title="binder">act</span></a> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#act_body_amount"><span class="id" title="definition">act_body_amount</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#act:362"><span class="id" title="variable">act</span></a>) <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#out_acts:361"><span class="id" title="variable">out_acts</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_message</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_acts_correct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_receive_is_some</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.N_to_amount"><span class="id" title="definition">N_to_amount</span></a> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : (?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> ?<span class="id" title="var">y</span>)%<span class="id" title="var">Z</span>, <span class="id" title="var">G</span> : (?<span class="id" title="var">y</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> ?<span class="id" title="var">x</span>)%<span class="id" title="var">Z</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.le_antisymm"><span class="id" title="lemma">Z.le_antisymm</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">head</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IH</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">action_facts</span> <span class="id" title="keyword">as</span> (? &amp; ? &amp; ?);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">destruct_message</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_acts_correct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_receive_is_some</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.N_to_amount"><span class="id" title="definition">N_to_amount</span></a> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : (?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> ?<span class="id" title="var">y</span>)%<span class="id" title="var">Z</span>, <span class="id" title="var">G</span> : (?<span class="id" title="var">y</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> ?<span class="id" title="var">x</span>)%<span class="id" title="var">Z</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.le_antisymm"><span class="id" title="lemma">Z.le_antisymm</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">perm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">solve_facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.ge_le"><span class="id" title="lemma">Z.ge_le</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#account_balance_nonnegative"><span class="id" title="lemma">account_balance_nonnegative</span></a> <span class="id" title="var">bstate_from</span> <span class="id" title="var">to_addr</span>) <span class="id" title="keyword">as</span> ?<span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#xtz_pool_bound"><span class="id" title="lemma">xtz_pool_bound</span></a> <span class="id" title="keyword">as</span> (? &amp; <span class="id" title="var">deployed_state'</span> &amp; ?); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed_state</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed_state</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed_state0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab144"></a><h2 class="section">Total supply correct</h2>

</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="mintedOrBurnedTokens_acts" class="idref" href="#mintedOrBurnedTokens_acts"><span class="id" title="definition">mintedOrBurnedTokens_acts</span></a> (<a id="act_body:363" class="idref" href="#act_body:363"><span class="id" title="binder">act_body</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#act_body:363"><span class="id" title="variable">act_body</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">msg_serialized</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> @<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#Msg"><span class="id" title="inductive">Dexter2FA12.Msg</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#D2LqtSInstances.msg_serializable"><span class="id" title="instance">D2LqtSInstances.msg_serializable</span></a> <span class="id" title="var">msg_serialized</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">msg</span> =&gt; <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#mintedOrBurnedTokens"><span class="id" title="definition">mintedOrBurnedTokens</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">msg</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="mintedOrBurnedTokens_tx" class="idref" href="#mintedOrBurnedTokens_tx"><span class="id" title="definition">mintedOrBurnedTokens_tx</span></a> (<a id="tx:365" class="idref" href="#tx:365"><span class="id" title="binder">tx</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Tx"><span class="id" title="record">Tx</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#tx:365"><span class="id" title="variable">tx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#tx_body"><span class="id" title="projection">tx_body</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#tx_call"><span class="id" title="constructor">tx_call</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">msg_serialized</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> @<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#Msg"><span class="id" title="inductive">Dexter2FA12.Msg</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#D2LqtSInstances.msg_serializable"><span class="id" title="instance">D2LqtSInstances.msg_serializable</span></a> <span class="id" title="var">msg_serialized</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">msg</span> =&gt; <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#mintedOrBurnedTokens"><span class="id" title="definition">mintedOrBurnedTokens</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">msg</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="deserialize_balance_of_ne_mint_or_burn" class="idref" href="#deserialize_balance_of_ne_mint_or_burn"><span class="id" title="lemma">deserialize_balance_of_ne_mint_or_burn</span></a> : <span class="id" title="keyword">forall</span> <a id="n:366" class="idref" href="#n:366"><span class="id" title="binder">n</span></a> <a id="m:367" class="idref" href="#m:367"><span class="id" title="binder">m</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;@<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#Msg"><span class="id" title="inductive">Dexter2FA12.Msg</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#D2LqtSInstances.msg_serializable"><span class="id" title="instance">D2LqtSInstances.msg_serializable</span></a> (<a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#msg_balance_of"><span class="id" title="constructor">FA2Token.msg_balance_of</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#n:366"><span class="id" title="variable">n</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#msg_mint_or_burn"><span class="id" title="constructor">Dexter2FA12.msg_mint_or_burn</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#m:367"><span class="id" title="variable">m</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Transparent</span> <a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.Znat.html#Nat2Z.id"><span class="id" title="lemma">Nat2Z.id</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.of_nat"><span class="id" title="definition">Z.of_nat</span></a> 3 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#f1746f02f141d025b1e53605943919bf"><span class="id" title="notation">&lt;?</span></a> 0); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">destruct_match</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Opaque</span> <a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="forall_filter_cons" class="idref" href="#forall_filter_cons"><span class="id" title="lemma">forall_filter_cons</span></a> : <span class="id" title="keyword">forall</span> <a id="P:368" class="idref" href="#P:368"><span class="id" title="binder">P</span></a> (<a id="Q:369" class="idref" href="#Q:369"><span class="id" title="binder">Q</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>) <a id="R:370" class="idref" href="#R:370"><span class="id" title="binder">R</span></a> <a id="x:371" class="idref" href="#x:371"><span class="id" title="binder">x</span></a> <a id="l:372" class="idref" href="#l:372"><span class="id" title="binder">l</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#P:368"><span class="id" title="variable">P</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#Q:369"><span class="id" title="variable">Q</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#R:370"><span class="id" title="variable">R</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#x:371"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#l:372"><span class="id" title="variable">l</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#P:368"><span class="id" title="variable">P</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#Q:369"><span class="id" title="variable">Q</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#R:370"><span class="id" title="variable">R</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#l:372"><span class="id" title="variable">l</span></a>)).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">forall_l</span>. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">forall_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="tactic">in</span> <span class="id" title="var">forall_l</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall_inv_tail"><span class="id" title="lemma">Forall_inv_tail</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="outgoing_acts_no_mint_before_set_lqt_addr" class="idref" href="#outgoing_acts_no_mint_before_set_lqt_addr"><span class="id" title="lemma">outgoing_acts_no_mint_before_set_lqt_addr</span></a> : <span class="id" title="keyword">forall</span> <a id="bstate:373" class="idref" href="#bstate:373"><span class="id" title="binder">bstate</span></a> <a id="caddr:374" class="idref" href="#caddr:374"><span class="id" title="binder">caddr</span></a> (<a id="trace:375" class="idref" href="#trace:375"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:373"><span class="id" title="variable">bstate</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:373"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:374"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="cstate:376" class="idref" href="#cstate:376"><span class="id" title="binder">cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:373"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:374"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#cstate:376"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#cstate:376"><span class="id" title="variable">cstate</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtAddress"><span class="id" title="projection">lqtAddress</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#NullAddressAxiom.null_address"><span class="id" title="axiom">null_address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <a id="act_body:377" class="idref" href="#act_body:377"><span class="id" title="binder">act_body</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#act_body:377"><span class="id" title="variable">act_body</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">msg</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> @<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#Msg"><span class="id" title="inductive">Dexter2FA12.Msg</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#D2LqtSInstances.msg_serializable"><span class="id" title="instance">D2LqtSInstances.msg_serializable</span></a> <span class="id" title="var">msg</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#msg_mint_or_burn"><span class="id" title="constructor">msg_mint_or_burn</span></a> <span class="id" title="var">_</span>) =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>) (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:373"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:374"><span class="id" title="variable">caddr</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">trace</span> <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">trace_induction</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;Step&nbsp;block&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">state</span> &amp; <span class="id" title="var">deployed_state</span> &amp; <span class="id" title="var">IH</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts_after_block_nil"><span class="id" title="lemma">outgoing_acts_after_block_nil</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#contract_addr_format"><span class="id" title="lemma">contract_addr_format</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;Action&nbsp;transfer&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">state</span> &amp; <span class="id" title="var">deployed_state</span> &amp; <span class="id" title="var">sum_eq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">lqtAddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">sum_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">lqtAddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">sum_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_prev</span>, <span class="id" title="var">queue_new</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#forall_filter_cons"><span class="id" title="lemma">forall_filter_cons</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">lqtAddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;Action&nbsp;deploy&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">caddr</span> <span class="id" title="var">to_addr</span>) <span class="id" title="keyword">as</span> [&lt;-|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Deploy&nbsp;this&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">deployed</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#wc_init_strong"><span class="id" title="lemma">wc_init_strong</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">init_some</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">setup'</span> &amp; <span class="id" title="var">state'</span> &amp; <span class="id" title="var">_</span> &amp; <span class="id" title="var">deployed_state'</span> &amp; <span class="id" title="var">init_some</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize_serialize"><span class="id" title="method">deserialize_serialize</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">lqtAddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts_after_deploy_nil"><span class="id" title="lemma">outgoing_acts_after_deploy_nil</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_new</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#undeployed_contract_no_out_queue"><span class="id" title="lemma">undeployed_contract_no_out_queue</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">not_deployed</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_prev</span> <span class="id" title="tactic">in</span> <span class="id" title="var">not_deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.list.html#Forall_cons"><span class="id" title="lemma">list.Forall_cons</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">not_deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Deploy&nbsp;other&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">state'</span> &amp; <span class="id" title="var">deployed_state'</span> &amp; <span class="id" title="var">sum_eq</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">lqtAddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">sum_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">lqtAddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">sum_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_prev</span>, <span class="id" title="var">queue_new</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#forall_filter_cons"><span class="id" title="lemma">forall_filter_cons</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">lqtAddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;Action&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">state</span> &amp; <span class="id" title="var">deployed_state'</span> &amp; <span class="id" title="var">sum_eq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">caddr</span> <span class="id" title="var">to_addr</span>) <span class="id" title="keyword">as</span> [&lt;-|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Call&nbsp;this&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">deployed0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#wc_receive_strong"><span class="id" title="lemma">wc_receive_strong</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span> <span class="id" title="keyword">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">prev_state'</span> &amp; <span class="id" title="var">msg'</span> &amp; <span class="id" title="var">new_state'</span> &amp; <span class="id" title="var">serialize_prev_state</span> &amp; <span class="id" title="var">_</span> &amp; <span class="id" title="var">serialize_new_state</span> &amp; <span class="id" title="var">receive_some</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">serialize_new_state</span>, <a class="idref" href="ConCert.Execution.Serializable.html#deserialize_serialize"><span class="id" title="method">deserialize_serialize</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed_state</span>, <span class="id" title="var">serialize_prev_state</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed_state'</span>. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">deployed_state'</span> <span class="id" title="var">serialize_prev_state</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">lqtAddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_message</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_acts_correct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_state_eq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">apply</span> <span class="id" title="var">sum_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">lqtAddr</span> <span class="id" title="keyword">as</span> <span class="id" title="var">lqtAddr'</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">sum_eq</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_prev</span>, <span class="id" title="var">queue_new</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#forall_filter_cons"><span class="id" title="lemma">forall_filter_cons</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">lqtAddr'</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ?<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_refl"><span class="id" title="lemma">address_eq_refl</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ?<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.list.html#Forall_cons"><span class="id" title="lemma">list.Forall_cons</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_receive_is_some</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#forall_filter_cons"><span class="id" title="lemma">forall_filter_cons</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">match_deser</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#deserialize_balance_of_ne_mint_or_burn"><span class="id" title="lemma">deserialize_balance_of_ne_mint_or_burn</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">match_deser</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Call&nbsp;other&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">lqtAddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">sum_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">lqtAddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">sum_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_prev</span>, <span class="id" title="var">queue_new</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#forall_filter_cons"><span class="id" title="lemma">forall_filter_cons</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">lqtAddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#filter_app"><span class="id" title="lemma">filter_app</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#map_app"><span class="id" title="lemma">map_app</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall_app"><span class="id" title="lemma">Forall_app</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Utils.Extras.html#filter_map"><span class="id" title="lemma">Extras.filter_map</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_ne"><span class="id" title="lemma">address_eq_ne</span></a>, <a class="idref" href="ConCert.Utils.Extras.html#filter_false"><span class="id" title="lemma">filter_false</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;Invalid&nbsp;action&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">state</span> &amp; <span class="id" title="var">deployed_state</span> &amp; <span class="id" title="var">sum_eq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">lqtAddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_prev</span>, &lt;- <span class="id" title="var">queue_new</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">sum_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">lqtAddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">sum_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#forall_filter_cons"><span class="id" title="lemma">forall_filter_cons</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">lqtAddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;Permutation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">state</span> &amp; <span class="id" title="var">deployed_state</span> &amp; <span class="id" title="var">sum_eq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">lqtAddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">sum_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">lqtAddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">sum_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Utils.Extras.html#Permutation_filter"><span class="id" title="lemma">Permutation_filter</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">perm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Sorting.Permutation.html#Permutation_map"><span class="id" title="lemma">Permutation.Permutation_map</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">perm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Utils.Extras.html#forall_respects_permutation"><span class="id" title="lemma">forall_respects_permutation</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="outgoing_acts_all_mint_same_dest" class="idref" href="#outgoing_acts_all_mint_same_dest"><span class="id" title="lemma">outgoing_acts_all_mint_same_dest</span></a> : <span class="id" title="keyword">forall</span> <a id="bstate:379" class="idref" href="#bstate:379"><span class="id" title="binder">bstate</span></a> <a id="caddr:380" class="idref" href="#caddr:380"><span class="id" title="binder">caddr</span></a> (<a id="trace:381" class="idref" href="#trace:381"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:379"><span class="id" title="variable">bstate</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:379"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:380"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="cstate:382" class="idref" href="#cstate:382"><span class="id" title="binder">cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:379"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:380"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#cstate:382"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <a id="act_body:383" class="idref" href="#act_body:383"><span class="id" title="binder">act_body</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#act_body:383"><span class="id" title="variable">act_body</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#to"><span class="id" title="projection">to</span></a> <span class="id" title="var">_</span> <span class="id" title="var">msg_serialized</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> @<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#Msg"><span class="id" title="inductive">Dexter2FA12.Msg</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#D2LqtSInstances.msg_serializable"><span class="id" title="instance">D2LqtSInstances.msg_serializable</span></a> <span class="id" title="var">msg_serialized</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#msg_mint_or_burn"><span class="id" title="constructor">msg_mint_or_burn</span></a> <span class="id" title="var">_</span>) =&gt; <span class="id" title="var">to</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtAddress"><span class="id" title="projection">lqtAddress</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#cstate:382"><span class="id" title="variable">cstate</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:379"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:380"><span class="id" title="variable">caddr</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_induction</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.list.html#Forall_cons"><span class="id" title="lemma">list.Forall_cons</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">instantiate</span> (<span class="id" title="var">CallFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a id="state:385" class="idref" href="#state:385"><span class="id" title="binder">state</span></a> <a id="out_acts:386" class="idref" href="#out_acts:386"><span class="id" title="binder">out_acts</span></a> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#state:385"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtAddress"><span class="id" title="projection">lqtAddress</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#NullAddressAxiom.null_address"><span class="id" title="axiom">null_address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <a id="act_body:387" class="idref" href="#act_body:387"><span class="id" title="binder">act_body</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#act_body:387"><span class="id" title="variable">act_body</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">msg</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> @<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#Msg"><span class="id" title="inductive">Dexter2FA12.Msg</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#D2LqtSInstances.msg_serializable"><span class="id" title="instance">D2LqtSInstances.msg_serializable</span></a> <span class="id" title="var">msg</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#msg_mint_or_burn"><span class="id" title="constructor">msg_mint_or_burn</span></a> <span class="id" title="var">_</span>) =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>) <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#out_acts:386"><span class="id" title="variable">out_acts</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">CallFacts</span> <span class="id" title="tactic">in</span> <span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_message</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_acts_correct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_state_eq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall_app"><span class="id" title="lemma">Forall_app</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ?<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.list.html#Forall_cons"><span class="id" title="lemma">list.Forall_cons</span></a>, ?<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.list.html#Forall_nil"><span class="id" title="lemma">list.Forall_nil</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize_serialize"><span class="id" title="method">deserialize_serialize</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize_serialize"><span class="id" title="method">deserialize_serialize</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">rewrite_receive_is_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">facts</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="https://metacoq.github.io/html/MetaCoq.Template.utils.All_Forall.html#In_Forall"><span class="id" title="lemma">All_Forall.In_Forall</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">act</span> <span class="id" title="var">act_in</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall_forall"><span class="id" title="lemma">Forall_forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">act</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">contradiction</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#deserialize_balance_of_ne_mint_or_burn"><span class="id" title="lemma">deserialize_balance_of_ne_mint_or_burn</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.list.html#Forall_cons"><span class="id" title="lemma">list.Forall_cons</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">CallFacts</span> <span class="id" title="tactic">in</span> <span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_message</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_acts_correct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_state_eq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall_app"><span class="id" title="lemma">Forall_app</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ?<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.list.html#Forall_cons"><span class="id" title="lemma">list.Forall_cons</span></a>, ?<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.list.html#Forall_nil"><span class="id" title="lemma">list.Forall_nil</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize_serialize"><span class="id" title="method">deserialize_serialize</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize_serialize"><span class="id" title="method">deserialize_serialize</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">rewrite_receive_is_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">facts</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall_inv_tail"><span class="id" title="lemma">Forall_inv_tail</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="https://metacoq.github.io/html/MetaCoq.Template.utils.All_Forall.html#In_Forall"><span class="id" title="lemma">All_Forall.In_Forall</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">act</span> <span class="id" title="var">act_in</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall_forall"><span class="id" title="lemma">Forall_forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H4</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">act</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">contradiction</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#deserialize_balance_of_ne_mint_or_burn"><span class="id" title="lemma">deserialize_balance_of_ne_mint_or_burn</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">perm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">solve_facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">deployed0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#outgoing_acts_no_mint_before_set_lqt_addr"><span class="id" title="lemma">outgoing_acts_no_mint_before_set_lqt_addr</span></a> <span class="id" title="keyword">as</span> (<span class="id" title="var">state</span> &amp; <span class="id" title="var">state_deployed</span> &amp; ?); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed_state0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">state_deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">state_deployed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="outgoing_acts_sum_filter_eq" class="idref" href="#outgoing_acts_sum_filter_eq"><span class="id" title="lemma">outgoing_acts_sum_filter_eq</span></a> : <span class="id" title="keyword">forall</span> <a id="bstate:389" class="idref" href="#bstate:389"><span class="id" title="binder">bstate</span></a> <a id="caddr:390" class="idref" href="#caddr:390"><span class="id" title="binder">caddr</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:389"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:389"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:390"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="cstate:391" class="idref" href="#cstate:391"><span class="id" title="binder">cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:389"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:390"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#cstate:391"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.Extras.html#sumZ"><span class="id" title="definition">sumZ</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#mintedOrBurnedTokens_acts"><span class="id" title="definition">mintedOrBurnedTokens_acts</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> (<a class="idref" href="ConCert.Execution.InterContractCommunication.html#actTo"><span class="id" title="definition">actTo</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#cstate:391"><span class="id" title="variable">cstate</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtAddress"><span class="id" title="projection">lqtAddress</span></a>)) (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:389"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:390"><span class="id" title="variable">caddr</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.Extras.html#sumZ"><span class="id" title="definition">sumZ</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#mintedOrBurnedTokens_acts"><span class="id" title="definition">mintedOrBurnedTokens_acts</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:389"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:390"><span class="id" title="variable">caddr</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * [<span class="id" title="var">trace</span>] <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#outgoing_acts_all_mint_same_dest"><span class="id" title="lemma">outgoing_acts_all_mint_same_dest</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed</span> <span class="id" title="keyword">as</span> <span class="id" title="var">mint_or_burn_to_lqt_addr</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">mint_or_burn_to_lqt_addr</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">cstate</span> &amp; <span class="id" title="var">deployed_state</span> &amp; <span class="id" title="var">mint_or_burn_to_lqt_addr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">cstate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">trace</span> <span class="id" title="var">deployed</span> <span class="id" title="var">deployed_state</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.list.html#Forall_cons"><span class="id" title="lemma">list.Forall_cons</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">mint_or_burn_to_lqt_addr</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">mint_or_burn_to_lqt_addr</span> <span class="id" title="var">IH</span>%<span class="id" title="var">IHl</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">IH</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">H</span>; <span class="id" title="var">cbn</span>; <span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">destruct_match</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="outgoing_txs_no_mint_before_set_lqt_addr" class="idref" href="#outgoing_txs_no_mint_before_set_lqt_addr"><span class="id" title="lemma">outgoing_txs_no_mint_before_set_lqt_addr</span></a> : <span class="id" title="keyword">forall</span> <a id="bstate:392" class="idref" href="#bstate:392"><span class="id" title="binder">bstate</span></a> <a id="caddr:393" class="idref" href="#caddr:393"><span class="id" title="binder">caddr</span></a> (<a id="trace:394" class="idref" href="#trace:394"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:392"><span class="id" title="variable">bstate</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:392"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:393"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="cstate:395" class="idref" href="#cstate:395"><span class="id" title="binder">cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:392"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:393"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#cstate:395"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#cstate:395"><span class="id" title="variable">cstate</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtAddress"><span class="id" title="projection">lqtAddress</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#NullAddressAxiom.null_address"><span class="id" title="axiom">null_address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <a id="tx:396" class="idref" href="#tx:396"><span class="id" title="binder">tx</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#tx:396"><span class="id" title="variable">tx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#tx_body"><span class="id" title="projection">tx_body</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#tx_call"><span class="id" title="constructor">tx_call</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">msg</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> @<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#Msg"><span class="id" title="inductive">Dexter2FA12.Msg</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#D2LqtSInstances.msg_serializable"><span class="id" title="instance">D2LqtSInstances.msg_serializable</span></a> <span class="id" title="var">msg</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#msg_mint_or_burn"><span class="id" title="constructor">msg_mint_or_burn</span></a> <span class="id" title="var">_</span>) =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>) (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#trace:394"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:393"><span class="id" title="variable">caddr</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">trace</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#deployed_contract_state_typed"><span class="id" title="lemma">deployed_contract_state_typed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed</span> <span class="id" title="keyword">as</span> <span class="id" title="var">deployed_state</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">deployed_state</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">state</span> &amp; <span class="id" title="var">deployed_state</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">state</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">reach</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <span class="id" title="var">to</span>) <span class="id" title="tactic">by</span> (<span class="id" title="tactic">constructor</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">econstructor</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_chain_step</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;Step&nbsp;block&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IHtrace</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">state'</span> &amp; <span class="id" title="var">deployed_state'</span> &amp; <span class="id" title="var">sum_eq</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed_state</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">destruct_action_eval</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="comment">(*&nbsp;Action&nbsp;transfer&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IHtrace</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">state'</span> &amp; <span class="id" title="var">deployed_state'</span> &amp; <span class="id" title="var">sum_eq</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed_state</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">lqtAddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">sum_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">lqtAddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall_cons"><span class="id" title="constructor">Forall_cons</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">lqtAddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="comment">(*&nbsp;Action&nbsp;deploy&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">lqtAddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">caddr</span> <span class="id" title="var">to_addr</span>) <span class="id" title="keyword">as</span> [&lt;-|]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="comment">(*&nbsp;Deploy&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> <a class="idref" href="ConCert.Execution.Blockchain.html#undeployed_contract_no_out_txs"><span class="id" title="lemma">undeployed_contract_no_out_txs</span></a> <span class="id" title="keyword">as</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall_cons"><span class="id" title="constructor">Forall_cons</span></a>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="comment">(*&nbsp;Deploy&nbsp;other&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IHtrace</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">state'</span> &amp; <span class="id" title="var">deployed_state'</span> &amp; <span class="id" title="var">sum_eq</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed_state</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">sum_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">lqtAddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall_cons"><span class="id" title="constructor">Forall_cons</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">lqtAddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="comment">(*&nbsp;Action&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IHtrace</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">state'</span> &amp; <span class="id" title="var">deployed_state'</span> &amp; <span class="id" title="var">sum_eq</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">lqtAddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">caddr</span> <span class="id" title="var">to_addr</span>) <span class="id" title="keyword">as</span> [&lt;-|]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="comment">(*&nbsp;Call&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#wc_receive_strong"><span class="id" title="lemma">wc_receive_strong</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span> <span class="id" title="keyword">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">prev_state'</span> &amp; <span class="id" title="var">msg'</span> &amp; <span class="id" title="var">new_state'</span> &amp; <span class="id" title="var">serialize_prev_state</span> &amp; <span class="id" title="var">msg_ser</span> &amp; <span class="id" title="var">serialize_new_state</span> &amp; <span class="id" title="var">receive_some</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">serialize_new_state</span>, <a class="idref" href="ConCert.Execution.Serializable.html#deserialize_serialize"><span class="id" title="method">deserialize_serialize</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed_state</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed_state0</span>, <span class="id" title="var">serialize_prev_state</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">deployed0</span> <span class="id" title="var">deployed_state</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">lqt_addr_preserved</span> : <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtAddress"><span class="id" title="projection">lqtAddress</span></a> <span class="id" title="var">state'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtAddress"><span class="id" title="projection">lqtAddress</span></a> <span class="id" title="var">state</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">\/</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="a:398" class="idref" href="#a:398"><span class="id" title="binder">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">msg'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#SetLqtAddress"><span class="id" title="constructor">SetLqtAddress</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#a:397"><span class="id" title="variable">a</span></a>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">destruct_message</span>; <span class="id" title="var">now</span> <span class="id" title="var">rewrite_state_eq</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">caddr</span> <span class="id" title="var">from_addr</span>) <span class="id" title="keyword">as</span> [&lt;-|]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---- <span class="comment">(*&nbsp;Self&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_refl"><span class="id" title="lemma">address_eq_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">edestruct</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#outgoing_acts_no_mint_before_set_lqt_addr"><span class="id" title="lemma">outgoing_acts_no_mint_before_set_lqt_addr</span></a> <span class="id" title="keyword">as</span> (<span class="id" title="var">cstate</span> &amp; <span class="id" title="var">deployed_state'</span> &amp; <span class="id" title="var">out_acts_forall</span>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed_state0</span>, <span class="id" title="var">serialize_prev_state</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">out_acts_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_prev</span> <span class="id" title="tactic">in</span> <span class="id" title="var">out_acts_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">out_acts_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_refl"><span class="id" title="lemma">address_eq_refl</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">out_acts_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">out_acts_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall_cons"><span class="id" title="constructor">Forall_cons</span></a>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">lqt_addr_preserved</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">lqt_addr_preserved</span> | <span class="id" title="var">lqt_addr_preserved</span>]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">lqt_addr_preserved</span> <span class="id" title="tactic">in</span> <span class="id" title="var">lqtAddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall_inv"><span class="id" title="lemma">Forall_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">out_acts_forall</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">lqt_addr_preserved</span> <span class="id" title="keyword">as</span> [? <span class="id" title="var">lqt_addr_preserved</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">lqt_addr_preserved</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_receive_is_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall_inv"><span class="id" title="lemma">Forall_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">out_acts_forall</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lqt_addr_preserved</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">lqt_addr_preserved</span> | <span class="id" title="var">lqt_addr_preserved</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">lqt_addr_preserved</span> <span class="id" title="tactic">in</span> <span class="id" title="var">lqtAddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lqt_addr_preserved</span> <span class="id" title="keyword">as</span> [? <span class="id" title="var">lqt_addr_preserved</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">lqt_addr_preserved</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">rewrite_receive_is_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---- <span class="comment">(*&nbsp;Call&nbsp;by&nbsp;other&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_ne"><span class="id" title="lemma">address_eq_ne</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lqt_addr_preserved</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">lqt_addr_preserved</span> | <span class="id" title="var">lqt_addr_preserved</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">lqt_addr_preserved</span> <span class="id" title="tactic">in</span> <span class="id" title="var">lqtAddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lqt_addr_preserved</span> <span class="id" title="keyword">as</span> [? <span class="id" title="var">lqt_addr_preserved</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">lqt_addr_preserved</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">rewrite_receive_is_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="comment">(*&nbsp;Call&nbsp;other&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed_state</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall_cons"><span class="id" title="constructor">Forall_cons</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">edestruct</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#outgoing_acts_no_mint_before_set_lqt_addr"><span class="id" title="lemma">outgoing_acts_no_mint_before_set_lqt_addr</span></a> <span class="id" title="keyword">as</span> (<span class="id" title="var">cstate</span> &amp; <span class="id" title="var">deployed_state'</span> &amp; <span class="id" title="var">out_acts_forall</span>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed_state</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">out_acts_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_prev</span> <span class="id" title="tactic">in</span> <span class="id" title="var">out_acts_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">out_acts_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_refl"><span class="id" title="lemma">address_eq_refl</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">out_acts_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">out_acts_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall_inv"><span class="id" title="lemma">Forall_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">out_acts_forall</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;Invalid&nbsp;action&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">lqtAddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IHtrace</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">state'</span> &amp; <span class="id" title="var">deployed_state'</span> &amp; <span class="id" title="var">sum_eq</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed_state</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;Permutation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">lqtAddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IHtrace</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">state'</span> &amp; <span class="id" title="var">deployed_state'</span> &amp; <span class="id" title="var">sum_eq</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">env_eq</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed_state</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="outgoing_txs_all_mint_same_dest" class="idref" href="#outgoing_txs_all_mint_same_dest"><span class="id" title="lemma">outgoing_txs_all_mint_same_dest</span></a> : <span class="id" title="keyword">forall</span> <a id="bstate:399" class="idref" href="#bstate:399"><span class="id" title="binder">bstate</span></a> <a id="caddr:400" class="idref" href="#caddr:400"><span class="id" title="binder">caddr</span></a> (<a id="trace:401" class="idref" href="#trace:401"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:399"><span class="id" title="variable">bstate</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:399"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:400"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="cstate:402" class="idref" href="#cstate:402"><span class="id" title="binder">cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:399"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:400"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#cstate:402"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <a id="tx:403" class="idref" href="#tx:403"><span class="id" title="binder">tx</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#tx:403"><span class="id" title="variable">tx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#tx_body"><span class="id" title="projection">tx_body</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#tx_call"><span class="id" title="constructor">tx_call</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">msg</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> @<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#Msg"><span class="id" title="inductive">Dexter2FA12.Msg</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#D2LqtSInstances.msg_serializable"><span class="id" title="instance">D2LqtSInstances.msg_serializable</span></a> <span class="id" title="var">msg</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#msg_mint_or_burn"><span class="id" title="constructor">msg_mint_or_burn</span></a> <span class="id" title="var">_</span>) =&gt; <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#tx:403"><span class="id" title="variable">tx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#tx_to"><span class="id" title="projection">tx_to</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtAddress"><span class="id" title="projection">lqtAddress</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#cstate:402"><span class="id" title="variable">cstate</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#trace:401"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:400"><span class="id" title="variable">caddr</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">trace</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#deployed_contract_state_typed"><span class="id" title="lemma">deployed_contract_state_typed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed</span> <span class="id" title="keyword">as</span> <span class="id" title="var">deployed_state</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">deployed_state</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">state</span> &amp; <span class="id" title="var">deployed_state</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">state</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_chain_step</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;Step&nbsp;block&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IHtrace</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">state'</span> &amp; <span class="id" title="var">deployed_state'</span> &amp; <span class="id" title="var">sum_eq</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed_state</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">destruct_action_eval</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="comment">(*&nbsp;Action&nbsp;transfer&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IHtrace</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">state'</span> &amp; <span class="id" title="var">deployed_state'</span> &amp; <span class="id" title="var">sum_eq</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed_state</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.list.html#Forall_cons"><span class="id" title="lemma">list.Forall_cons</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="comment">(*&nbsp;Action&nbsp;deploy&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">caddr</span> <span class="id" title="var">to_addr</span>) <span class="id" title="keyword">as</span> [&lt;-|]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="comment">(*&nbsp;Deploy&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#undeployed_contract_no_out_txs"><span class="id" title="lemma">undeployed_contract_no_out_txs</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">not_deployed</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">not_deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">not_deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.list.html#Forall_cons"><span class="id" title="lemma">list.Forall_cons</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="comment">(*&nbsp;Deploy&nbsp;other&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IHtrace</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">state'</span> &amp; <span class="id" title="var">deployed_state'</span> &amp; <span class="id" title="var">sum_eq</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed_state</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.list.html#Forall_cons"><span class="id" title="lemma">list.Forall_cons</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="comment">(*&nbsp;Action&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IHtrace</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">state'</span> &amp; <span class="id" title="var">deployed_state'</span> &amp; <span class="id" title="var">sum_eq</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">caddr</span> <span class="id" title="var">to_addr</span>) <span class="id" title="keyword">as</span> [&lt;-|]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="comment">(*&nbsp;Call&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*rewrite&nbsp;deployed_state0&nbsp;in&nbsp;deployed_state'.*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#wc_receive_strong"><span class="id" title="lemma">wc_receive_strong</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span> <span class="id" title="keyword">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">prev_state'</span> &amp; <span class="id" title="var">msg'</span> &amp; <span class="id" title="var">new_state'</span> &amp; <span class="id" title="var">serialize_prev_state</span> &amp; <span class="id" title="var">msg_ser</span> &amp; <span class="id" title="var">serialize_new_state</span> &amp; <span class="id" title="var">receive_some</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">serialize_new_state</span>, <a class="idref" href="ConCert.Execution.Serializable.html#deserialize_serialize"><span class="id" title="method">deserialize_serialize</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed_state</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed_state0</span>, <span class="id" title="var">serialize_prev_state</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">deployed0</span> <span class="id" title="var">deployed_state</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">lqt_addr_preserved</span> : <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtAddress"><span class="id" title="projection">lqtAddress</span></a> <span class="id" title="var">state'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtAddress"><span class="id" title="projection">lqtAddress</span></a> <span class="id" title="var">state</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">\/</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="a:405" class="idref" href="#a:405"><span class="id" title="binder">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">msg'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.FA2.FA2Token.html#other_msg"><span class="id" title="constructor">FA2Token.other_msg</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#SetLqtAddress"><span class="id" title="constructor">SetLqtAddress</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#a:404"><span class="id" title="variable">a</span></a>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">destruct_message</span>; <span class="id" title="var">now</span> <span class="id" title="var">rewrite_state_eq</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">caddr</span> <span class="id" title="var">from_addr</span>) <span class="id" title="keyword">as</span> [&lt;-|]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---- <span class="comment">(*&nbsp;Self&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_refl"><span class="id" title="lemma">address_eq_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall_cons"><span class="id" title="constructor">Forall_cons</span></a>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">lqt_addr_preserved</span> <span class="id" title="keyword">as</span> [&lt;- | <span class="id" title="var">lqt_addr_preserved</span>]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">edestruct</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#outgoing_acts_all_mint_same_dest"><span class="id" title="lemma">outgoing_acts_all_mint_same_dest</span></a> <span class="id" title="keyword">as</span> (<span class="id" title="var">cstate</span> &amp; <span class="id" title="var">deployed_state'</span> &amp; <span class="id" title="var">out_acts_forall</span>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed_state0</span>, <span class="id" title="var">serialize_prev_state</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">out_acts_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_prev</span> <span class="id" title="tactic">in</span> <span class="id" title="var">out_acts_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">out_acts_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_refl"><span class="id" title="lemma">address_eq_refl</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">out_acts_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">out_acts_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall_inv"><span class="id" title="lemma">Forall_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">out_acts_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">edestruct</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#outgoing_acts_no_mint_before_set_lqt_addr"><span class="id" title="lemma">outgoing_acts_no_mint_before_set_lqt_addr</span></a> <span class="id" title="keyword">as</span> (<span class="id" title="var">cstate</span> &amp; <span class="id" title="var">deployed_state'</span> &amp; <span class="id" title="var">out_acts_forall</span>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed_state0</span>, <span class="id" title="var">serialize_prev_state</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">out_acts_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_prev</span> <span class="id" title="tactic">in</span> <span class="id" title="var">out_acts_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">out_acts_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_refl"><span class="id" title="lemma">address_eq_refl</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">out_acts_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">out_acts_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lqt_addr_preserved</span> <span class="id" title="keyword">as</span> [? <span class="id" title="var">lqt_addr_preserved</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">lqt_addr_preserved</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_receive_is_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall_inv"><span class="id" title="lemma">Forall_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">out_acts_forall</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lqt_addr_preserved</span> <span class="id" title="keyword">as</span> [&lt;- | <span class="id" title="var">lqt_addr_preserved</span>]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lqt_addr_preserved</span> <span class="id" title="keyword">as</span> [? <span class="id" title="var">lqt_addr_preserved</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">lqt_addr_preserved</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_receive_is_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">edestruct</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#outgoing_txs_no_mint_before_set_lqt_addr"><span class="id" title="lemma">outgoing_txs_no_mint_before_set_lqt_addr</span></a> <span class="id" title="keyword">as</span> (<span class="id" title="var">cstate</span> &amp; <span class="id" title="var">deployed_state'</span> &amp; <span class="id" title="var">out_acts_forall</span>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed_state0</span>, <span class="id" title="var">serialize_prev_state</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">out_acts_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">out_acts_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="https://metacoq.github.io/html/MetaCoq.Template.utils.All_Forall.html#In_Forall"><span class="id" title="lemma">All_Forall.In_Forall</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">act</span> <span class="id" title="var">act_in</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall_forall"><span class="id" title="lemma">Forall_forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg0</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">destruct_match</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---- <span class="comment">(*&nbsp;Call&nbsp;by&nbsp;other&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_ne"><span class="id" title="lemma">address_eq_ne</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lqt_addr_preserved</span> <span class="id" title="keyword">as</span> [&lt;- | <span class="id" title="var">lqt_addr_preserved</span>]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lqt_addr_preserved</span> <span class="id" title="keyword">as</span> [? <span class="id" title="var">lqt_addr_preserved</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">lqt_addr_preserved</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_receive_is_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">edestruct</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#outgoing_txs_no_mint_before_set_lqt_addr"><span class="id" title="lemma">outgoing_txs_no_mint_before_set_lqt_addr</span></a> <span class="id" title="keyword">as</span> (<span class="id" title="var">cstate</span> &amp; <span class="id" title="var">deployed_state'</span> &amp; <span class="id" title="var">out_acts_forall</span>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed_state0</span>, <span class="id" title="var">serialize_prev_state</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">out_acts_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">out_acts_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="https://metacoq.github.io/html/MetaCoq.Template.utils.All_Forall.html#In_Forall"><span class="id" title="lemma">All_Forall.In_Forall</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">act</span> <span class="id" title="var">act_in</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall_forall"><span class="id" title="lemma">Forall_forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg0</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">destruct_match</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="comment">(*&nbsp;Call&nbsp;other&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed_state</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.list.html#Forall_cons"><span class="id" title="lemma">list.Forall_cons</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">edestruct</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#outgoing_acts_all_mint_same_dest"><span class="id" title="lemma">outgoing_acts_all_mint_same_dest</span></a> <span class="id" title="keyword">as</span> (<span class="id" title="var">cstate</span> &amp; <span class="id" title="var">deployed_state'</span> &amp; <span class="id" title="var">out_acts_forall</span>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed_state</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">out_acts_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_prev</span> <span class="id" title="tactic">in</span> <span class="id" title="var">out_acts_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">out_acts_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_refl"><span class="id" title="lemma">address_eq_refl</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">out_acts_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">out_acts_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#Forall_inv"><span class="id" title="lemma">Forall_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">out_acts_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;Invalid&nbsp;action&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IHtrace</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">state'</span> &amp; <span class="id" title="var">deployed_state'</span> &amp; <span class="id" title="var">sum_eq</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed_state</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;Permutation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IHtrace</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">state'</span> &amp; <span class="id" title="var">deployed_state'</span> &amp; <span class="id" title="var">sum_eq</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">env_eq</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed_state</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="outgoing_txs_sum_filter_eq" class="idref" href="#outgoing_txs_sum_filter_eq"><span class="id" title="lemma">outgoing_txs_sum_filter_eq</span></a> : <span class="id" title="keyword">forall</span> <a id="bstate:406" class="idref" href="#bstate:406"><span class="id" title="binder">bstate</span></a> <a id="caddr:407" class="idref" href="#caddr:407"><span class="id" title="binder">caddr</span></a> (<a id="trace:408" class="idref" href="#trace:408"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:406"><span class="id" title="variable">bstate</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:406"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:407"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="cstate:409" class="idref" href="#cstate:409"><span class="id" title="binder">cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:406"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:407"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#cstate:409"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.Extras.html#sumZ"><span class="id" title="definition">sumZ</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#mintedOrBurnedTokens_tx"><span class="id" title="definition">mintedOrBurnedTokens_tx</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> (<a class="idref" href="ConCert.Execution.InterContractCommunication.html#txCallTo"><span class="id" title="definition">txCallTo</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#cstate:409"><span class="id" title="variable">cstate</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtAddress"><span class="id" title="projection">lqtAddress</span></a>)) (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#trace:408"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:407"><span class="id" title="variable">caddr</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.Extras.html#sumZ"><span class="id" title="definition">sumZ</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#mintedOrBurnedTokens_tx"><span class="id" title="definition">mintedOrBurnedTokens_tx</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#trace:408"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:407"><span class="id" title="variable">caddr</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#outgoing_txs_all_mint_same_dest"><span class="id" title="lemma">outgoing_txs_all_mint_same_dest</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">trace</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">deployed</span> <span class="id" title="keyword">as</span> <span class="id" title="var">mint_or_burn_to_lqt_addr</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">mint_or_burn_to_lqt_addr</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">cstate</span> &amp; <span class="id" title="var">deployed_state</span> &amp; <span class="id" title="var">mint_or_burn_to_lqt_addr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">cstate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">deployed</span> <span class="id" title="var">deployed_state</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.list.html#Forall_cons"><span class="id" title="lemma">list.Forall_cons</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">mint_or_burn_to_lqt_addr</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">mint_or_burn_to_lqt_addr</span> <span class="id" title="var">IH</span>%<span class="id" title="var">IHl</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">IH</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">tx_body</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">H1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">H2</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 3 (<span class="id" title="var">destruct_match</span>; <span class="id" title="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">destruct_address_eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a></span> is equal to the initial tokens + minted tokens - burned tokens 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="lqt_total_correct'" class="idref" href="#lqt_total_correct'"><span class="id" title="lemma">lqt_total_correct'</span></a> : <span class="id" title="keyword">forall</span> <a id="bstate:410" class="idref" href="#bstate:410"><span class="id" title="binder">bstate</span></a> <a id="caddr:411" class="idref" href="#caddr:411"><span class="id" title="binder">caddr</span></a> (<a id="trace:412" class="idref" href="#trace:412"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:410"><span class="id" title="variable">bstate</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:410"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:411"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="cstate:413" class="idref" href="#cstate:413"><span class="id" title="binder">cstate</span></a> <a id="depinfo:414" class="idref" href="#depinfo:414"><span class="id" title="binder">depinfo</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:410"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:411"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#cstate:413"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#Setup"><span class="id" title="record">Setup</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#trace:412"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:411"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#depinfo:414"><span class="id" title="variable">depinfo</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="initial_tokens:415" class="idref" href="#initial_tokens:415"><span class="id" title="binder">initial_tokens</span></a> := <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal_"><span class="id" title="projection">lqtTotal_</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_setup"><span class="id" title="projection">deployment_setup</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#depinfo:414"><span class="id" title="variable">depinfo</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.of_N"><span class="id" title="definition">Z.of_N</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#cstate:413"><span class="id" title="variable">cstate</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.of_N"><span class="id" title="definition">Z.of_N</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#initial_tokens:415"><span class="id" title="variable">initial_tokens</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Utils.Extras.html#sumZ"><span class="id" title="definition">sumZ</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#mintedOrBurnedTokens_acts"><span class="id" title="definition">mintedOrBurnedTokens_acts</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:410"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:411"><span class="id" title="variable">caddr</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Utils.Extras.html#sumZ"><span class="id" title="definition">sumZ</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#mintedOrBurnedTokens_tx"><span class="id" title="definition">mintedOrBurnedTokens_tx</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#trace:412"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:411"><span class="id" title="variable">caddr</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_induction</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#init_correct"><span class="id" title="lemma">init_correct</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">init_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- 3!<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.add_assoc"><span class="id" title="lemma">Z.add_assoc</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.add_cancel_l"><span class="id" title="lemma">Z.add_cancel_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.add_shuffle3"><span class="id" title="lemma">Z.add_shuffle3</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.add_cancel_l"><span class="id" title="lemma">Z.add_cancel_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.add_cancel_r"><span class="id" title="lemma">Z.add_cancel_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#mintedOrBurnedTokens_tx"><span class="id" title="definition">mintedOrBurnedTokens_tx</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">out_act</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">tx_act_match</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> [<span class="id" title="var">_</span> [-&gt; | -&gt;]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">tx_act_match</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> [<span class="id" title="var">_</span> -&gt;]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">tx_act_match</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> -&gt;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_message</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_acts_correct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_state_eq</span>; <span class="id" title="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_receive_is_some</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize_serialize"><span class="id" title="method">deserialize_serialize</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">msg_deserialized</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">msg_deserialized</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#deserialize_balance_of_ne_mint_or_burn"><span class="id" title="lemma">deserialize_balance_of_ne_mint_or_burn</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">msg_deserialized</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">head</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IH</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">action_facts</span> <span class="id" title="keyword">as</span> (? &amp; ? &amp; ?);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_message</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_acts_correct</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_state_eq</span>; <span class="id" title="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_receive_is_some</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize_serialize"><span class="id" title="method">deserialize_serialize</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">msg_deserialized</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">msg_deserialized</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">destruct_match</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#deserialize_balance_of_ne_mint_or_burn"><span class="id" title="lemma">deserialize_balance_of_ne_mint_or_burn</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">msg_deserialized</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">msg_deserialized0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">msg_deserialized0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">perm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">solve_facts</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a></span> is equal to the initial tokens + minted tokens - burned tokens 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="lqt_total_correct" class="idref" href="#lqt_total_correct"><span class="id" title="lemma">lqt_total_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="bstate:416" class="idref" href="#bstate:416"><span class="id" title="binder">bstate</span></a> <a id="caddr:417" class="idref" href="#caddr:417"><span class="id" title="binder">caddr</span></a> (<a id="trace:418" class="idref" href="#trace:418"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:416"><span class="id" title="variable">bstate</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:416"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:417"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="cstate:419" class="idref" href="#cstate:419"><span class="id" title="binder">cstate</span></a> <a id="depinfo:420" class="idref" href="#depinfo:420"><span class="id" title="binder">depinfo</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:416"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:417"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#cstate:419"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#Setup"><span class="id" title="record">Setup</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#trace:418"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:417"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#depinfo:420"><span class="id" title="variable">depinfo</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="initial_tokens:421" class="idref" href="#initial_tokens:421"><span class="id" title="binder">initial_tokens</span></a> := <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal_"><span class="id" title="projection">lqtTotal_</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_setup"><span class="id" title="projection">deployment_setup</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#depinfo:420"><span class="id" title="variable">depinfo</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.of_N"><span class="id" title="definition">Z.of_N</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#cstate:419"><span class="id" title="variable">cstate</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.of_N"><span class="id" title="definition">Z.of_N</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#initial_tokens:421"><span class="id" title="variable">initial_tokens</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Utils.Extras.html#sumZ"><span class="id" title="definition">sumZ</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#mintedOrBurnedTokens_acts"><span class="id" title="definition">mintedOrBurnedTokens_acts</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> (<a class="idref" href="ConCert.Execution.InterContractCommunication.html#actTo"><span class="id" title="definition">actTo</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#cstate:419"><span class="id" title="variable">cstate</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtAddress"><span class="id" title="projection">lqtAddress</span></a>)) (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:416"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:417"><span class="id" title="variable">caddr</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Utils.Extras.html#sumZ"><span class="id" title="definition">sumZ</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#mintedOrBurnedTokens_tx"><span class="id" title="definition">mintedOrBurnedTokens_tx</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> (<a class="idref" href="ConCert.Execution.InterContractCommunication.html#txCallTo"><span class="id" title="definition">txCallTo</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#cstate:419"><span class="id" title="variable">cstate</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtAddress"><span class="id" title="projection">lqtAddress</span></a>)) (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#trace:418"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr:417"><span class="id" title="variable">caddr</span></a>)).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#lqt_total_correct'"><span class="id" title="lemma">lqt_total_correct'</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed</span> <span class="id" title="keyword">as</span> <span class="id" title="var">lqt_correct</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#outgoing_acts_sum_filter_eq"><span class="id" title="lemma">outgoing_acts_sum_filter_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed</span> <span class="id" title="keyword">as</span> <span class="id" title="var">act_filter_eq</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lqt_correct</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">cstate</span> &amp; <span class="id" title="var">depinfo</span> &amp; <span class="id" title="var">deployed_state</span> &amp; <span class="id" title="var">deployment_info</span> &amp; <span class="id" title="var">lqt_correct</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">act_filter_eq</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">cstate'</span> &amp; <span class="id" title="var">deployed_state'</span> &amp; <span class="id" title="var">act_filter_eq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed_state</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">deployed_state'</span>. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">act_filter_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#outgoing_txs_sum_filter_eq"><span class="id" title="lemma">outgoing_txs_sum_filter_eq</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">trace</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">deployed</span> <span class="id" title="keyword">as</span> <span class="id" title="var">tx_filter_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">tx_filter_eq</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">cstate</span> &amp; <span class="id" title="var">deployed_state'</span> &amp; <span class="id" title="var">tx_filter_eq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed_state</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">deployed_state'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">deployed_state'</span>. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">tx_filter_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">lqt_correct</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">Z_scope</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="mintedOrBurnedTokens_call_eq_tx" class="idref" href="#mintedOrBurnedTokens_call_eq_tx"><span class="id" title="lemma">mintedOrBurnedTokens_call_eq_tx</span></a> : <span class="id" title="keyword">forall</span> <a id="call_info:422" class="idref" href="#call_info:422"><span class="id" title="binder">call_info</span></a> <a id="addr:423" class="idref" href="#addr:423"><span class="id" title="binder">addr</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="callInfo:424" class="idref" href="#callInfo:424"><span class="id" title="binder">callInfo</span></a> =&gt; <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#mintedOrBurnedTokens"><span class="id" title="definition">mintedOrBurnedTokens</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#callInfo:424"><span class="id" title="variable">callInfo</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#call_msg"><span class="id" title="projection">call_msg</span></a>)) <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#call_info:422"><span class="id" title="variable">call_info</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="callInfo:425" class="idref" href="#callInfo:425"><span class="id" title="binder">callInfo</span></a> =&gt; <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#mintedOrBurnedTokens_tx"><span class="id" title="definition">mintedOrBurnedTokens_tx</span></a> (<a class="idref" href="ConCert.Execution.InterContractCommunication.html#contract_call_info_to_tx"><span class="id" title="definition">contract_call_info_to_tx</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#addr:423"><span class="id" title="variable">addr</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#callInfo:425"><span class="id" title="variable">callInfo</span></a>)) <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#call_info:422"><span class="id" title="variable">call_info</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">call_info</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">call_msg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize_serialize"><span class="id" title="method">deserialize_serialize</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="deserialize_lqt_token_msg_right_inverse" class="idref" href="#deserialize_lqt_token_msg_right_inverse"><span class="id" title="lemma">deserialize_lqt_token_msg_right_inverse</span></a> : <span class="id" title="keyword">forall</span> <a id="x:426" class="idref" href="#x:426"><span class="id" title="binder">x</span></a> (<a id="y:427" class="idref" href="#y:427"><span class="id" title="binder">y</span></a> : <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#Msg"><span class="id" title="inductive">Dexter2FA12.Msg</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <a id="x':428" class="idref" href="#x':428"><span class="id" title="binder">x'</span></a> (<a id="y':429" class="idref" href="#y':429"><span class="id" title="binder">y'</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>), <a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#x':428"><span class="id" title="variable">x'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#y':429"><span class="id" title="variable">y'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#x':428"><span class="id" title="variable">x'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#y':429"><span class="id" title="variable">y'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#x:426"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#y:427"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#x:426"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#y:427"><span class="id" title="variable">y</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">address_right_inverse</span> <span class="id" title="var">deser_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Transparent</span> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Local Hint Resolve</span> <span class="id" title="var">deserialize_nat_right_inverse</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">deserialize_N_right_inverse</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">deserialize_int_right_inverse</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">deserialize_unit_right_inverse</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">deserialize_serialized_value_right_inverse</span> : <span class="id" title="var">deser</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">try</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="keyword">match</span> <span class="id" title="var">_</span> <span class="id" title="keyword">with</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">_</span> | <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <span class="id" title="var">_</span> <span class="id" title="keyword">end</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="keyword">let</span> <span class="id" title="var">H2</span> := <span class="id" title="tactic">fresh</span> "H" <span class="id" title="tactic">in</span> <span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">H2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; [| <span class="id" title="tactic">discriminate</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="keyword">match</span> ?<span class="id" title="var">x</span> <span class="id" title="keyword">with</span> 0%<span class="id" title="var">nat</span> =&gt; <span class="id" title="var">_</span> | <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">_</span> <span class="id" title="keyword">end</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>; [| <span class="id" title="tactic">try</span> <span class="id" title="tactic">discriminate</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="keyword">let</span> (<span class="id" title="var">_</span>, <span class="id" title="var">_</span>) := ?<span class="id" title="var">p</span> <span class="id" title="tactic">in</span> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="ConCert.Execution.Serializable.html#extract_ser_value"><span class="id" title="definition">extract_ser_value</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> @<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Serializable.html#interp_type"><span class="id" title="definition">interp_type</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#ser_unit"><span class="id" title="constructor">ser_unit</span></a>) ?<span class="id" title="var">i</span> |- <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize_unit_right_inverse"><span class="id" title="lemma">deserialize_unit_right_inverse</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> -&gt;; <span class="id" title="tactic">destruct</span> <span class="id" title="var">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : @<a class="idref" href="ConCert.Execution.Serializable.html#deserialize_product"><span class="id" title="definition">deserialize_product</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize_product_right_inverse"><span class="id" title="lemma">deserialize_product_right_inverse</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> -&gt;; <span class="id" title="tactic">try</span> <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">forall</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">intros</span> * <span class="id" title="var">deser_some</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">deser</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Opaque</span> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab145"></a><h2 class="section">lqtTotal/total_supply invariant</h2>

</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Section</span> <a id="Theories.LqtPoolCorrect" class="idref" href="#Theories.LqtPoolCorrect"><span class="id" title="section">LqtPoolCorrect</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Arguments</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#lqt_contract"><span class="id" title="method">lqt_contract</span></a> {<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>} <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Arguments</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#lqt_total_supply_correct"><span class="id" title="method">lqt_total_supply_correct</span></a> {<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>} <span class="id" title="var">_</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a></span> of the main contract is equal to <span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#total_supply"><span class="id" title="projection">total_supply</span></a></span> of the liquidity token  We define the statement for the liquidity token interface contract interface.
        <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#LqtTokenInterface"><span class="id" title="record">LqtTokenInterface</span></a></span>. That is, for any contract with correct signature satisfying
        an additional correctness property, namely <span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#total_supply"><span class="id" title="projection">total_supply</span></a></span> is equal to the initial
        tokens + minted tokens - burned tokens 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="lqtTotal_total_supply_invariant" class="idref" href="#lqtTotal_total_supply_invariant"><span class="id" title="definition">lqtTotal_total_supply_invariant</span></a> (<a id="i_lqt_contract:430" class="idref" href="#i_lqt_contract:430"><span class="id" title="binder">i_lqt_contract</span></a> : <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#LqtTokenInterface"><span class="id" title="class">LqtTokenInterface</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="bstate:431" class="idref" href="#bstate:431"><span class="id" title="binder">bstate</span></a> <a id="caddr_main:432" class="idref" href="#caddr_main:432"><span class="id" title="binder">caddr_main</span></a> <a id="caddr_lqt:433" class="idref" href="#caddr_lqt:433"><span class="id" title="binder">caddr_lqt</span></a> (<a id="trace:434" class="idref" href="#trace:434"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:431"><span class="id" title="variable">bstate</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:431"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr_main:432"><span class="id" title="variable">caddr_main</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#DEX2.contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:431"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr_lqt:433"><span class="id" title="variable">caddr_lqt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#i_lqt_contract:430"><span class="id" title="variable">i_lqt_contract</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#lqt_contract"><span class="id" title="method">lqt_contract</span></a>) : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="state_main:435" class="idref" href="#state_main:435"><span class="id" title="binder">state_main</span></a> <a id="state_lqt:436" class="idref" href="#state_lqt:436"><span class="id" title="binder">state_lqt</span></a> <a id="depinfo_main:437" class="idref" href="#depinfo_main:437"><span class="id" title="binder">depinfo_main</span></a> <a id="depinfo_lqt:438" class="idref" href="#depinfo_lqt:438"><span class="id" title="binder">depinfo_lqt</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:431"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr_main:432"><span class="id" title="variable">caddr_main</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#state_main:435"><span class="id" title="variable">state_main</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:431"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr_lqt:433"><span class="id" title="variable">caddr_lqt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#state_lqt:436"><span class="id" title="variable">state_lqt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#Setup"><span class="id" title="record">Setup</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#trace:434"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr_main:432"><span class="id" title="variable">caddr_main</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#depinfo_main:437"><span class="id" title="variable">depinfo_main</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#Setup"><span class="id" title="record">Dexter2FA12.Setup</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#trace:434"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr_lqt:433"><span class="id" title="variable">caddr_lqt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#depinfo_lqt:438"><span class="id" title="variable">depinfo_lqt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="initial_tokens_main:439" class="idref" href="#initial_tokens_main:439"><span class="id" title="binder">initial_tokens_main</span></a> := <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal_"><span class="id" title="projection">lqtTotal_</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_setup"><span class="id" title="projection">deployment_setup</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#depinfo_main:437"><span class="id" title="variable">depinfo_main</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="initial_tokens_lqt:440" class="idref" href="#initial_tokens_lqt:440"><span class="id" title="binder">initial_tokens_lqt</span></a> := <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#initial_pool"><span class="id" title="projection">initial_pool</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_setup"><span class="id" title="projection">deployment_setup</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#depinfo_lqt:438"><span class="id" title="variable">depinfo_lqt</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#state_main:435"><span class="id" title="variable">state_main</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtAddress"><span class="id" title="projection">lqtAddress</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr_lqt:433"><span class="id" title="variable">caddr_lqt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#state_lqt:436"><span class="id" title="variable">state_lqt</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#admin"><span class="id" title="projection">admin</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr_main:432"><span class="id" title="variable">caddr_main</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#initial_tokens_main:439"><span class="id" title="variable">initial_tokens_main</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#initial_tokens_lqt:440"><span class="id" title="variable">initial_tokens_lqt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> (<a class="idref" href="ConCert.Execution.InterContractCommunication.html#actTo"><span class="id" title="definition">actTo</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#state_main:435"><span class="id" title="variable">state_main</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtAddress"><span class="id" title="projection">lqtAddress</span></a>)) (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#bstate:431"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#caddr_main:432"><span class="id" title="variable">caddr_main</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#state_main:435"><span class="id" title="variable">state_main</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMM.html#lqtTotal"><span class="id" title="projection">lqtTotal</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#state_lqt:436"><span class="id" title="variable">state_lqt</span></a>.(<a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#total_supply"><span class="id" title="projection">total_supply</span></a>)).<br/>

<br/>
</div>

<div class="doc">
We prove that the invariant hold for any contract satisfying the interface 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="lqt_pool_correct_interface" class="idref" href="#lqt_pool_correct_interface"><span class="id" title="lemma">lqt_pool_correct_interface</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<a id="i_lqt_contract:441" class="idref" href="#i_lqt_contract:441"><span class="id" title="binder">i_lqt_contract</span></a> : <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#LqtTokenInterface"><span class="id" title="class">LqtTokenInterface</span></a>), <span class="comment">(*&nbsp;for&nbsp;any&nbsp;correct&nbsp;liquidity&nbsp;token&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <a id="x:442" class="idref" href="#x:442"><span class="id" title="binder">x</span></a> (<a id="y:443" class="idref" href="#y:443"><span class="id" title="binder">y</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>), <a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#x:442"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#y:443"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#x:442"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#y:443"><span class="id" title="variable">y</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="comment">(*&nbsp;a&nbsp;technical&nbsp;condition&nbsp;for&nbsp;serialisation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#lqtTotal_total_supply_invariant"><span class="id" title="definition">lqtTotal_total_supply_invariant</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#i_lqt_contract:441"><span class="id" title="variable">i_lqt_contract</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? ? ? ? ? ? <span class="id" title="var">deployed_main</span> <span class="id" title="var">deployed_lqt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#lqt_total_correct"><span class="id" title="lemma">lqt_total_correct</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">trace</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_main</span> <span class="id" title="keyword">as</span> <span class="id" title="var">main_correct</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">main_correct</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">state_main</span> &amp; <span class="id" title="var">depinfo_main</span> &amp; <span class="id" title="var">deployed_state_main</span> &amp; <span class="id" title="var">deploy_info_main</span> &amp; <span class="id" title="var">main_correct</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#lqt_total_supply_correct"><span class="id" title="method">lqt_total_supply_correct</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">trace</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">deployed_lqt</span> <span class="id" title="keyword">as</span> <span class="id" title="var">lqt_correct</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lqt_correct</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">state_lqt</span> &amp; <span class="id" title="var">depinfo_lqt</span> &amp; <span class="id" title="var">inc_calls_lqt</span> &amp; <span class="id" title="var">deployed_state_lqt</span> &amp; <span class="id" title="var">deploy_info_lqt</span> &amp; <span class="id" title="var">inc_acts_lqt</span> &amp; <span class="id" title="var">lqt_correct</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#incomming_eq_outgoing"><span class="id" title="lemma">incomming_eq_outgoing</span></a> <span class="id" title="keyword">as</span> <span class="id" title="var">incoming_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">edestruct</span> <span class="id" title="var">incoming_eq</span> <span class="id" title="keyword">as</span> (? &amp; <span class="id" title="var">inc_acts_lqt'</span> &amp; <span class="id" title="var">calls_eq</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[| <span class="id" title="tactic">apply</span> <span class="id" title="var">deployed_main</span> | <span class="id" title="tactic">apply</span> <span class="id" title="var">deployed_lqt</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#deserialize_lqt_token_msg_right_inverse"><span class="id" title="lemma">deserialize_lqt_token_msg_right_inverse</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">setoid_rewrite</span> <span class="id" title="var">inc_acts_lqt</span> <span class="id" title="tactic">in</span> <span class="id" title="var">inc_acts_lqt'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">inc_acts_lqt'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">inc_acts_lqt'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 4 <span class="id" title="tactic">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">addr_main_eq</span> <span class="id" title="var">addr_lqt_eq</span> <span class="id" title="var">init_pool_eq</span> <span class="id" title="var">no_waiting_mint_acts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.Znat.html#N2Z.inj"><span class="id" title="lemma">N2Z.inj</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">main_correct</span>, <span class="id" title="var">lqt_correct</span>, <span class="id" title="var">init_pool_eq</span>, <span class="id" title="var">no_waiting_mint_acts</span>, <span class="id" title="var">addr_main_eq</span>, <span class="id" title="var">addr_lqt_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.add_0_r"><span class="id" title="lemma">Z.add_0_r</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.add_cancel_l"><span class="id" title="lemma">Z.add_cancel_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">calls_eq</span>, <a class="idref" href="ConCert.Utils.Extras.html#sumZ_map"><span class="id" title="lemma">sumZ_map</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Utils.Extras.html#sumZ_eq"><span class="id" title="lemma">sumZ_eq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#mintedOrBurnedTokens_call_eq_tx"><span class="id" title="lemma">mintedOrBurnedTokens_call_eq_tx</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#Theories.LqtPoolCorrect"><span class="id" title="section">LqtPoolCorrect</span></a>.<br/>

<br/>
</div>

<div class="doc">
Now, we prove that the concrete implemention of the liquidity token satisfies the
      inter-contract invariant 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a id="lqt_pool_correct_lqt_fa12" class="idref" href="#lqt_pool_correct_lqt_fa12"><span class="id" title="lemma">lqt_pool_correct_lqt_fa12</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <a id="x:444" class="idref" href="#x:444"><span class="id" title="binder">x</span></a> (<a id="y:445" class="idref" href="#y:445"><span class="id" title="binder">y</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>), <a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#x:444"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#y:445"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#x:444"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#y:445"><span class="id" title="variable">y</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#lqtTotal_total_supply_invariant"><span class="id" title="definition">lqtTotal_total_supply_invariant</span></a> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12Correct.html#LqtFA12Token"><span class="id" title="instance">Dexter2FA12Correct.LqtFA12Token</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#lqt_pool_correct_interface"><span class="id" title="lemma">lqt_pool_correct_interface</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Examples.Dexter2.Dexter2CPMMCorrect.html#Theories"><span class="id" title="section">Theories</span></a>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="https://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a> and <a href="https://github.com/jgallen23/toc">TOC</a>
</div>
</div>
<script>
  const elements = document.getElementsByClassName("libtitle");
  while(elements.length > 0){
        elements[0].parentNode.removeChild(elements[0]);
  }
  if (window.location.pathname.endsWith("/toc.html")) {
      const jstocDiv = document.getElementById("js-toc");
      jstocDiv.classList.remove("toc");
      jstocDiv.classList.add("jstoc-hidden");
      const jstocHeaderDiv = document.getElementById("js-toc-header");
      jstocHeaderDiv.classList.add("jstoc-hidden");
      const mainDiv = document.getElementById("main");
      mainDiv.classList.add("jstoc-hidden-main");
      const toggleDiv = document.getElementById("toggle-toc");
      toggleDiv.classList.add("jstoc-hidden");
  }
  console.log(window.location.pathname);
</script>
<script type="text/javascript" src="toc.js"></script>
</body>

</html>
