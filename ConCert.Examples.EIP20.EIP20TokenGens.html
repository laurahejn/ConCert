<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<link href="toc.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
      <span id="toggle-toc">Contents</span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="https://github.com/AU-COBRA/ConCert" target="_balnk">Project Page</a>
      <a href="index.html">Index</a>
      <a href="toc.html">Table of contents</a>
    </span>
</div>
  <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="js-toc" class="toc" data-toc="h1,h2,h3,h4" data-toc-container="doc" data-toc-offset="-40">
      <div id="js-toc-header" class="toc-header">Contents:</div>
    </div>
    <div id="main">
<h1 class="libtitle">Library ConCert.Examples.EIP20.EIP20TokenGens</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Blockchain.html#"><span class="id" title="library">Blockchain</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Containers.html#"><span class="id" title="library">Containers</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Serializable.html#"><span class="id" title="library">Serializable</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution.Test</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Test.QCTest.html#"><span class="id" title="library">QCTest</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Examples.EIP20</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#"><span class="id" title="library">EIP20Token</span></a>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#MonadNotation"><span class="id" title="module">MonadNotation</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#"><span class="id" title="library">List</span></a>. <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ListNotations"><span class="id" title="module">ListNotations</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.ZArith.html#"><span class="id" title="library">ZArith</span></a>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="keyword">Type</span> <a id="EIP20GensInfo" class="idref" href="#EIP20GensInfo"><span class="id" title="module">EIP20GensInfo</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a id="EIP20GensInfo.contract_addr" class="idref" href="#EIP20GensInfo.contract_addr"><span class="id" title="axiom">contract_addr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a id="EIP20GensInfo.gAccount" class="idref" href="#EIP20GensInfo.gAccount"><span class="id" title="axiom">gAccount</span></a> : <span class="id" title="axiom">G</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#EIP20GensInfo"><span class="id" title="module">EIP20GensInfo</span></a>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <a id="EIP20Gens" class="idref" href="#EIP20Gens"><span class="id" title="module">EIP20Gens</span></a> (<span class="id" title="var">Info</span> : <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#EIP20GensInfo"><span class="id" title="module">EIP20GensInfo</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#Info"><span class="id" title="module">Info</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Arguments</span> <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a> : <span class="id" title="tactic">clear</span> <span class="id" title="var">implicits</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Arguments</span> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> : <span class="id" title="tactic">clear</span> <span class="id" title="var">implicits</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Arguments</span> <a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> : <span class="id" title="tactic">clear</span> <span class="id" title="var">implicits</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="EIP20Gens.serializeMsg" class="idref" href="#EIP20Gens.serializeMsg"><span class="id" title="definition">serializeMsg</span></a> := @<a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#Msg"><span class="id" title="inductive">EIP20Token.Msg</span></a> <span class="id" title="var">_</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;This&nbsp;function&nbsp;tries&nbsp;to&nbsp;generate&nbsp;a&nbsp;transfer&nbsp;between&nbsp;existing&nbsp;accounts&nbsp;in&nbsp;the&nbsp;token&nbsp;contract's&nbsp;state.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Otherwise&nbsp;tries&nbsp;to&nbsp;use&nbsp;accounts&nbsp;in&nbsp;the&nbsp;Blockchain&nbsp;state.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Has&nbsp;a&nbsp;small&nbsp;chance&nbsp;to&nbsp;transfer&nbsp;between&nbsp;"fresh"&nbsp;accounts.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="EIP20Gens.gTransfer" class="idref" href="#EIP20Gens.gTransfer"><span class="id" title="definition">gTransfer</span></a> (<a id="env:3" class="idref" href="#env:3"><span class="id" title="binder">env</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="state:4" class="idref" href="#state:4"><span class="id" title="binder">state</span></a> : <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#State"><span class="id" title="record">EIP20Token.State</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="axiom">G</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#Msg"><span class="id" title="inductive">Msg</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="nr_accounts_in_state:5" class="idref" href="#nr_accounts_in_state:5"><span class="id" title="binder">nr_accounts_in_state</span></a> := <a class="idref" href="ConCert.Execution.Containers.html#FMap.size"><span class="id" title="abbreviation">FMap.size</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#state:4"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#balances"><span class="id" title="projection">balances</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="weight_1:6" class="idref" href="#weight_1:6"><span class="id" title="binder">weight_1</span></a> := 2 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#ea2ff3d561159081cea6fb2e8113cc54"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#nr_accounts_in_state:5"><span class="id" title="variable">nr_accounts_in_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> 1 <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="randomize_mk_gen:10" class="idref" href="#randomize_mk_gen:10"><span class="id" title="binder">randomize_mk_gen</span></a> <a id="g:7" class="idref" href="#g:7"><span class="id" title="binder">g</span></a> := <span class="comment">(*&nbsp;the&nbsp;probability&nbsp;of&nbsp;sampling&nbsp;fresh&nbsp;accounts&nbsp;grows&nbsp;smaller&nbsp;over&nbsp;time&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">freq</span> <span class="id" title="notation">[</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#weight_1:6"><span class="id" title="variable">weight_1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="axiom">returnGen</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#g:7"><span class="id" title="variable">g</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>0<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a id="from_addr:8" class="idref" href="#from_addr:8"><span class="id" title="binder">from_addr</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">&lt;-</span></a> <span class="id" title="method">arbitrary</span> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="to_addr:9" class="idref" href="#to_addr:9"><span class="id" title="binder">to_addr</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">&lt;-</span></a> <span class="id" title="method">arbitrary</span> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="axiom">returnGen</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#from_addr:8"><span class="id" title="variable">from_addr</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#transfer"><span class="id" title="constructor">transfer</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#to_addr:9"><span class="id" title="variable">to_addr</span></a> 0%<span class="id" title="var">N</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">))</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">]</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="sample:11" class="idref" href="#sample:11"><span class="id" title="binder">sample</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#sampleFMapOpt"><span class="id" title="definition">sampleFMapOpt</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#state:4"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#balances"><span class="id" title="projection">balances</span></a>) <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#sample:11"><span class="id" title="variable">sample</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">addr</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">balance</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="transfer_amount:13" class="idref" href="#transfer_amount:13"><span class="id" title="binder">transfer_amount</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">&lt;-</span></a> <span class="id" title="axiom">choose</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>0%<span class="id" title="var">N</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">balance</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="account:14" class="idref" href="#account:14"><span class="id" title="binder">account</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#Info.gAccount"><span class="id" title="axiom">gAccount</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#randomize_mk_gen:10"><span class="id" title="variable">randomize_mk_gen</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">addr</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#transfer"><span class="id" title="constructor">transfer</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#account:14"><span class="id" title="variable">account</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#transfer_amount:13"><span class="id" title="variable">transfer_amount</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;if&nbsp;the&nbsp;contract&nbsp;state&nbsp;contains&nbsp;no&nbsp;accounts,&nbsp;just&nbsp;transfer&nbsp;0&nbsp;tokens&nbsp;between&nbsp;two&nbsp;arbitrary&nbsp;accounts&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a id="from_addr:15" class="idref" href="#from_addr:15"><span class="id" title="binder">from_addr</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">&lt;-</span></a> <span class="id" title="method">arbitrary</span> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="to_addr:16" class="idref" href="#to_addr:16"><span class="id" title="binder">to_addr</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">&lt;-</span></a> <span class="id" title="method">arbitrary</span> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="axiom">returnGen</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#from_addr:15"><span class="id" title="variable">from_addr</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#transfer"><span class="id" title="constructor">transfer</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#to_addr:16"><span class="id" title="variable">to_addr</span></a> 0%<span class="id" title="var">N</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">N_scope</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Note:&nbsp;not&nbsp;optimal&nbsp;implementation.&nbsp;Should&nbsp;filter&nbsp;on&nbsp;balances&nbsp;map&nbsp;instead&nbsp;of&nbsp;first&nbsp;sampling&nbsp;and&nbsp;then&nbsp;filtering&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="EIP20Gens.gApprove" class="idref" href="#EIP20Gens.gApprove"><span class="id" title="definition">gApprove</span></a> (<a id="state:17" class="idref" href="#state:17"><span class="id" title="binder">state</span></a> : <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#State"><span class="id" title="record">EIP20Token.State</span></a>) : <span class="id" title="definition">GOpt</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#Msg"><span class="id" title="inductive">Msg</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="axiom">bindGenOpt</span> (<a class="idref" href="ConCert.Execution.Test.TestUtils.html#sample2UniqueFMapOpt"><span class="id" title="definition">sample2UniqueFMapOpt</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#state:17"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#balances"><span class="id" title="projection">balances</span></a>)) (<span class="id" title="keyword">fun</span> <a id="p:18" class="idref" href="#p:18"><span class="id" title="binder">p</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="addr1:19" class="idref" href="#addr1:19"><span class="id" title="binder">addr1</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#p:18"><span class="id" title="variable">p</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="balance1:20" class="idref" href="#balance1:20"><span class="id" title="binder">balance1</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#p:18"><span class="id" title="variable">p</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="addr2:21" class="idref" href="#addr2:21"><span class="id" title="binder">addr2</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#p:18"><span class="id" title="variable">p</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="balance2:22" class="idref" href="#balance2:22"><span class="id" title="binder">balance2</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#p:18"><span class="id" title="variable">p</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#b39870dee55afcd85c6b795fb34de165"><span class="id" title="notation">&lt;?</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#balance1:20"><span class="id" title="variable">balance1</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <a id="amount:24" class="idref" href="#amount:24"><span class="id" title="binder">amount</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">&lt;-</span></a> <span class="id" title="axiom">choose</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>0<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#balance1:20"><span class="id" title="variable">balance1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">;;</span></a> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#returnGenSome"><span class="id" title="definition">returnGenSome</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#addr1:19"><span class="id" title="variable">addr1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#approve"><span class="id" title="constructor">approve</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#addr2:21"><span class="id" title="variable">addr2</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#amount:24"><span class="id" title="variable">amount</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="keyword">if</span> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#b39870dee55afcd85c6b795fb34de165"><span class="id" title="notation">&lt;?</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#balance2:22"><span class="id" title="variable">balance2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <a id="amount:23" class="idref" href="#amount:23"><span class="id" title="binder">amount</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">&lt;-</span></a> <span class="id" title="axiom">choose</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>0<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#balance2:22"><span class="id" title="variable">balance2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">;;</span></a> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#returnGenSome"><span class="id" title="definition">returnGenSome</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#addr2:21"><span class="id" title="variable">addr2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#approve"><span class="id" title="constructor">approve</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#addr1:19"><span class="id" title="variable">addr1</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#amount:23"><span class="id" title="variable">amount</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="axiom">returnGen</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="EIP20Gens.gTransfer_from" class="idref" href="#EIP20Gens.gTransfer_from"><span class="id" title="definition">gTransfer_from</span></a> (<a id="state:25" class="idref" href="#state:25"><span class="id" title="binder">state</span></a> : <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#State"><span class="id" title="record">EIP20Token.State</span></a>) : <span class="id" title="definition">GOpt</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#Msg"><span class="id" title="inductive">Msg</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="axiom">bindGenOpt</span> (<a class="idref" href="ConCert.Execution.Test.TestUtils.html#sampleFMapOpt"><span class="id" title="definition">sampleFMapOpt</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#state:25"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#allowances"><span class="id" title="projection">allowances</span></a>)) (<span class="id" title="keyword">fun</span> '<a id="pat:28" class="idref" href="#pat:28"><span class="id" title="binder">(</span></a><a id="pat:28" class="idref" href="#pat:28"><span class="id" title="binder">allower</span></a><a id="pat:28" class="idref" href="#pat:28"><span class="id" title="binder">,</span></a> <a id="pat:28" class="idref" href="#pat:28"><span class="id" title="binder">allowance_map</span></a><a id="pat:28" class="idref" href="#pat:28"><span class="id" title="binder">)</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="axiom">bindGenOpt</span> (<a class="idref" href="ConCert.Execution.Test.TestUtils.html#sampleFMapOpt"><span class="id" title="definition">sampleFMapOpt</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#allowance_map:26"><span class="id" title="variable">allowance_map</span></a>) (<span class="id" title="keyword">fun</span> '<a id="pat:31" class="idref" href="#pat:31"><span class="id" title="binder">(</span></a><a id="pat:31" class="idref" href="#pat:31"><span class="id" title="binder">delegate</span></a><a id="pat:31" class="idref" href="#pat:31"><span class="id" title="binder">,</span></a> <a id="pat:31" class="idref" href="#pat:31"><span class="id" title="binder">allowance</span></a><a id="pat:31" class="idref" href="#pat:31"><span class="id" title="binder">)</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="axiom">bindGenOpt</span> (<a class="idref" href="ConCert.Execution.Test.TestUtils.html#sampleFMapOpt"><span class="id" title="definition">sampleFMapOpt</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#state:25"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#balances"><span class="id" title="projection">balances</span></a>)) (<span class="id" title="keyword">fun</span> '<a id="pat:33" class="idref" href="#pat:33"><span class="id" title="binder">(</span></a><a id="pat:33" class="idref" href="#pat:33"><span class="id" title="binder">receiver</span></a><a id="pat:33" class="idref" href="#pat:33"><span class="id" title="binder">,</span></a> <a id="pat:33" class="idref" href="#pat:33"><span class="id" title="binder">_</span></a><a id="pat:33" class="idref" href="#pat:33"><span class="id" title="binder">)</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="allower_balance:34" class="idref" href="#allower_balance:34"><span class="id" title="binder">allower_balance</span></a> := (<a class="idref" href="ConCert.Execution.Test.TestUtils.html#FMap_find_"><span class="id" title="definition">FMap_find_</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#allower:27"><span class="id" title="variable">allower</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#state:25"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#balances"><span class="id" title="projection">balances</span></a>) 0) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="amount:35" class="idref" href="#amount:35"><span class="id" title="binder">amount</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">(</span></a><span class="id" title="keyword">if</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#allower_balance:34"><span class="id" title="variable">allower_balance</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#59a5ff4a6cbb127625aba1a377a243d1"><span class="id" title="notation">=?</span></a> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <span class="id" title="axiom">returnGen</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="axiom">choose</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>0<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.min"><span class="id" title="definition">N.min</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#allowance:29"><span class="id" title="variable">allowance</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#allower_balance:34"><span class="id" title="variable">allower_balance</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">)</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Test.TestUtils.html#returnGenSome"><span class="id" title="definition">returnGenSome</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#delegate:30"><span class="id" title="variable">delegate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#transfer_from"><span class="id" title="constructor">transfer_from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#allower:27"><span class="id" title="variable">allower</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#receiver:32"><span class="id" title="variable">receiver</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#amount:35"><span class="id" title="variable">amount</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;)).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">N_scope</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Main&nbsp;generator.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="EIP20Gens.gEIP20TokenAction" class="idref" href="#EIP20Gens.gEIP20TokenAction"><span class="id" title="definition">gEIP20TokenAction</span></a> (<a id="env:36" class="idref" href="#env:36"><span class="id" title="binder">env</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>) : <span class="id" title="definition">GOpt</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="call:40" class="idref" href="#call:40"><span class="id" title="binder">call</span></a> <a id="contract_addr:37" class="idref" href="#contract_addr:37"><span class="id" title="binder">contract_addr</span></a> <a id="caller_addr:38" class="idref" href="#caller_addr:38"><span class="id" title="binder">caller_addr</span></a> <a id="msg:39" class="idref" href="#msg:39"><span class="id" title="binder">msg</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Test.TestUtils.html#returnGenSome"><span class="id" title="definition">returnGenSome</span></a> {|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#act_origin"><span class="id" title="projection">act_origin</span></a> := <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#caller_addr:38"><span class="id" title="variable">caller_addr</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#act_from"><span class="id" title="projection">act_from</span></a> := <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#caller_addr:38"><span class="id" title="variable">caller_addr</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#act_body"><span class="id" title="projection">act_body</span></a> := <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#contract_addr:37"><span class="id" title="variable">contract_addr</span></a> 0%<span class="id" title="var">Z</span> (<a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#EIP20Gens.serializeMsg"><span class="id" title="definition">serializeMsg</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#msg:39"><span class="id" title="variable">msg</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|} <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="state:41" class="idref" href="#state:41"><span class="id" title="binder">state</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">&lt;-</span></a> <span class="id" title="axiom">returnGen</span> (<a class="idref" href="ConCert.Execution.Test.TestUtils.html#get_contract_state"><span class="id" title="definition">get_contract_state</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#State"><span class="id" title="record">EIP20Token.State</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#env:36"><span class="id" title="variable">env</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#Info.contract_addr"><span class="id" title="axiom">contract_addr</span></a>) <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#b6e01f6dc1271ceaf89c61d9a4b57ac8"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="axiom">backtrack</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;transfer&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>2<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#9d6c3e66ed5a7d11a2cd0c5e68ec6163"><span class="id" title="notation">'</span></a><a id="pat:44" class="idref" href="#pat:44"><span class="id" title="binder">(</span></a><a id="pat:44" class="idref" href="#pat:44"><span class="id" title="binder">caller</span></a><a id="pat:44" class="idref" href="#pat:44"><span class="id" title="binder">,</span></a> <a id="pat:44" class="idref" href="#pat:44"><span class="id" title="binder">msg</span></a><a id="pat:44" class="idref" href="#pat:44"><span class="id" title="binder">)</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#9d6c3e66ed5a7d11a2cd0c5e68ec6163"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#EIP20Gens.gTransfer"><span class="id" title="definition">gTransfer</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#env:36"><span class="id" title="variable">env</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#state:41"><span class="id" title="variable">state</span></a> <a class="idref" href="https://coq-community.org/coq-ext-lib/v0.11.7/ExtLib.Structures.Monad.html#9d6c3e66ed5a7d11a2cd0c5e68ec6163"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#call:40"><span class="id" title="variable">call</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#Info.contract_addr"><span class="id" title="axiom">contract_addr</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#caller:43"><span class="id" title="variable">caller</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#msg:42"><span class="id" title="variable">msg</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;transfer_from&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>3<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="axiom">bindGenOpt</span> (<a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#EIP20Gens.gTransfer_from"><span class="id" title="definition">gTransfer_from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#state:41"><span class="id" title="variable">state</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> '<a id="pat:47" class="idref" href="#pat:47"><span class="id" title="binder">(</span></a><a id="pat:47" class="idref" href="#pat:47"><span class="id" title="binder">caller</span></a><a id="pat:47" class="idref" href="#pat:47"><span class="id" title="binder">,</span></a> <a id="pat:47" class="idref" href="#pat:47"><span class="id" title="binder">msg</span></a><a id="pat:47" class="idref" href="#pat:47"><span class="id" title="binder">)</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#call:40"><span class="id" title="variable">call</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#Info.contract_addr"><span class="id" title="axiom">contract_addr</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#caller:46"><span class="id" title="variable">caller</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#msg:45"><span class="id" title="variable">msg</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;approve&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>2<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="axiom">bindGenOpt</span> (<a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#EIP20Gens.gApprove"><span class="id" title="definition">gApprove</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#state:41"><span class="id" title="variable">state</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> '<a id="pat:50" class="idref" href="#pat:50"><span class="id" title="binder">(</span></a><a id="pat:50" class="idref" href="#pat:50"><span class="id" title="binder">caller</span></a><a id="pat:50" class="idref" href="#pat:50"><span class="id" title="binder">,</span></a> <a id="pat:50" class="idref" href="#pat:50"><span class="id" title="binder">msg</span></a><a id="pat:50" class="idref" href="#pat:50"><span class="id" title="binder">)</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#call:40"><span class="id" title="variable">call</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#Info.contract_addr"><span class="id" title="axiom">contract_addr</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#caller:49"><span class="id" title="variable">caller</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#msg:48"><span class="id" title="variable">msg</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenGens.html#EIP20Gens"><span class="id" title="module">EIP20Gens</span></a>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="https://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a> and <a href="https://github.com/jgallen23/toc">TOC</a>
</div>
</div>
<script>
  const elements = document.getElementsByClassName("libtitle");
  while(elements.length > 0){
        elements[0].parentNode.removeChild(elements[0]);
  }
  if (window.location.pathname.endsWith("/toc.html")) {
      const jstocDiv = document.getElementById("js-toc");
      jstocDiv.classList.remove("toc");
      jstocDiv.classList.add("jstoc-hidden");
      const jstocHeaderDiv = document.getElementById("js-toc-header");
      jstocHeaderDiv.classList.add("jstoc-hidden");
      const mainDiv = document.getElementById("main");
      mainDiv.classList.add("jstoc-hidden-main");
      const toggleDiv = document.getElementById("toggle-toc");
      toggleDiv.classList.add("jstoc-hidden");
  }
  console.log(window.location.pathname);
</script>
<script type="text/javascript" src="toc.js"></script>
</body>

</html>
