<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<link href="toc.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
      <span id="toggle-toc">Contents</span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="https://github.com/AU-COBRA/ConCert" target="_balnk">Project Page</a>
      <a href="index.html">Index</a>
      <a href="toc.html">Table of contents</a>
    </span>
</div>
  <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="js-toc" class="toc" data-toc="h1,h2,h3,h4" data-toc-container="doc" data-toc-offset="-40">
      <div id="js-toc-header" class="toc-header">Contents:</div>
    </div>
    <div id="main">
<h1 class="libtitle">Library ConCert.Examples.EIP20.EIP20TokenCorrect</h1>

<div class="code">
</div>

<div class="doc">
<a id="lab270"></a><h1 class="section">EIP20 Token Implementation</h1>

<div class="paragraph"> </div>

  This file contains an correctness proofs of the EIP20 token implementation.

</div>
<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.ZArith_base.html#"><span class="id" title="library">ZArith_base</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#"><span class="id" title="library">List</span></a>. <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ListNotations"><span class="id" title="module">ListNotations</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.micromega.Lia.html#"><span class="id" title="library">Lia</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Blockchain.html#"><span class="id" title="library">Blockchain</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Containers.html#"><span class="id" title="library">Containers</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Monad.html#"><span class="id" title="library">Monad</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.ResultMonad.html#"><span class="id" title="library">ResultMonad</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.ContractCommon.html#"><span class="id" title="library">ContractCommon</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Utils.Automation.html#"><span class="id" title="library">Automation</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Utils.Extras.html#"><span class="id" title="library">Extras</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Examples.EIP20</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#"><span class="id" title="library">EIP20Token</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab271"></a><h1 class="section">Properties</h1>

</div>
<div class="code">
<span class="id" title="keyword">Section</span> <a id="Theories" class="idref" href="#Theories"><span class="id" title="section">Theories</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<a id="BaseTypes:1" class="idref" href="#BaseTypes:1"><span class="id" title="binder">BaseTypes</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainBase"><span class="id" title="class">ChainBase</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">N_scope</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">bool</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab272"></a><h2 class="section">EIP20 functions not payable</h2>

<div class="paragraph"> </div>

 <span class="inlinecode"><a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">receive</span></a></span> only returns Some if the sender amount is zero 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="EIP20_not_payable" class="idref" href="#EIP20_not_payable"><span class="id" title="lemma">EIP20_not_payable</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:2" class="idref" href="#prev_state:2"><span class="id" title="binder">prev_state</span></a> <a id="new_state:3" class="idref" href="#new_state:3"><span class="id" title="binder">new_state</span></a> <a id="chain:4" class="idref" href="#chain:4"><span class="id" title="binder">chain</span></a> <a id="ctx:5" class="idref" href="#ctx:5"><span class="id" title="binder">ctx</span></a> <a id="msg:6" class="idref" href="#msg:6"><span class="id" title="binder">msg</span></a> <a id="new_acts:7" class="idref" href="#new_acts:7"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#chain:4"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:5"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:2"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#msg:6"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:3"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_acts:7"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:5"><span class="id" title="variable">ctx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> 0)%<span class="id" title="var">Z</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#receive"><span class="id" title="definition">receive</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">amount</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;case:&nbsp;ctx_amount&nbsp;&gt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;case:&nbsp;ctx_amount&nbsp;&lt;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.gtb_ltb"><span class="id" title="lemma">Z.gtb_ltb</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.ltb_ge"><span class="id" title="lemma">Z.ltb_ge</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">amount</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Lemma for simplifying the <span class="inlinecode"><a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">receive</span></a></span> function by eliminating the case
      where sender amount is larger than zero 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="receive_not_payable" class="idref" href="#receive_not_payable"><span class="id" title="lemma">receive_not_payable</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:8" class="idref" href="#prev_state:8"><span class="id" title="binder">prev_state</span></a> <a id="new_state:9" class="idref" href="#new_state:9"><span class="id" title="binder">new_state</span></a> <a id="chain:10" class="idref" href="#chain:10"><span class="id" title="binder">chain</span></a> <a id="ctx:11" class="idref" href="#ctx:11"><span class="id" title="binder">ctx</span></a> <a id="msg:12" class="idref" href="#msg:12"><span class="id" title="binder">msg</span></a> <a id="new_acts:13" class="idref" href="#new_acts:13"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#chain:10"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:11"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:8"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#msg:12"><span class="id" title="variable">msg</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:9"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_acts:13"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#msg:12"><span class="id" title="variable">msg</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#transfer"><span class="id" title="constructor">transfer</span></a> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> =&gt; <a class="idref" href="ConCert.Execution.Monad.html#f1146025ce6377896c1a30f88a02c8cb"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#try_transfer"><span class="id" title="definition">try_transfer</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:11"><span class="id" title="variable">ctx</span></a>) <span class="id" title="var">to</span> <span class="id" title="var">amount</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:8"><span class="id" title="variable">prev_state</span></a><a class="idref" href="ConCert.Execution.Monad.html#f1146025ce6377896c1a30f88a02c8cb"><span class="id" title="notation">)</span></a> <a class="idref" href="ConCert.Execution.Monad.html#f1146025ce6377896c1a30f88a02c8cb"><span class="id" title="notation">&gt;&gt;=</span></a> <a class="idref" href="ConCert.Execution.Monad.html#f1146025ce6377896c1a30f88a02c8cb"><span class="id" title="notation">(</span></a><span class="id" title="keyword">fun</span> <a id="new_state:15" class="idref" href="#new_state:15"><span class="id" title="binder">new_state</span></a> : <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#State"><span class="id" title="record">State</span></a> =&gt; <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:15"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="ConCert.Execution.Monad.html#f1146025ce6377896c1a30f88a02c8cb"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#transfer_from"><span class="id" title="constructor">transfer_from</span></a> <span class="id" title="var">from</span> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monad.html#f1146025ce6377896c1a30f88a02c8cb"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#try_transfer_from"><span class="id" title="definition">try_transfer_from</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:11"><span class="id" title="variable">ctx</span></a>) <span class="id" title="var">from</span> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:8"><span class="id" title="variable">prev_state</span></a><a class="idref" href="ConCert.Execution.Monad.html#f1146025ce6377896c1a30f88a02c8cb"><span class="id" title="notation">)</span></a> <a class="idref" href="ConCert.Execution.Monad.html#f1146025ce6377896c1a30f88a02c8cb"><span class="id" title="notation">&gt;&gt;=</span></a> <a class="idref" href="ConCert.Execution.Monad.html#f1146025ce6377896c1a30f88a02c8cb"><span class="id" title="notation">(</span></a><span class="id" title="keyword">fun</span> <a id="new_state:16" class="idref" href="#new_state:16"><span class="id" title="binder">new_state</span></a> : <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#State"><span class="id" title="record">State</span></a> =&gt; <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:16"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="ConCert.Execution.Monad.html#f1146025ce6377896c1a30f88a02c8cb"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#approve"><span class="id" title="constructor">approve</span></a> <span class="id" title="var">delegate</span> <span class="id" title="var">amount</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monad.html#f1146025ce6377896c1a30f88a02c8cb"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#try_approve"><span class="id" title="definition">try_approve</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:11"><span class="id" title="variable">ctx</span></a>) <span class="id" title="var">delegate</span> <span class="id" title="var">amount</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:8"><span class="id" title="variable">prev_state</span></a><a class="idref" href="ConCert.Execution.Monad.html#f1146025ce6377896c1a30f88a02c8cb"><span class="id" title="notation">)</span></a> <a class="idref" href="ConCert.Execution.Monad.html#f1146025ce6377896c1a30f88a02c8cb"><span class="id" title="notation">&gt;&gt;=</span></a> <a class="idref" href="ConCert.Execution.Monad.html#f1146025ce6377896c1a30f88a02c8cb"><span class="id" title="notation">(</span></a><span class="id" title="keyword">fun</span> <a id="new_state:17" class="idref" href="#new_state:17"><span class="id" title="binder">new_state</span></a> : <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#State"><span class="id" title="record">State</span></a> =&gt; <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:17"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="ConCert.Execution.Monad.html#f1146025ce6377896c1a30f88a02c8cb"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:9"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_acts:13"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#EIP20_not_payable"><span class="id" title="lemma">EIP20_not_payable</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span> <span class="id" title="keyword">as</span> <span class="id" title="var">amount_zero</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#receive"><span class="id" title="definition">receive</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.ltb_ge"><span class="id" title="lemma">Z.ltb_ge</span></a>, &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#Z.gtb_ltb"><span class="id" title="lemma">Z.gtb_ltb</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">amount_zero</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">amount_zero</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab273"></a><h2 class="section">EIP20 functions produce no acts</h2>

<div class="paragraph"> </div>

 <span class="inlinecode"><a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">receive</span></a></span> never produces any <span class="inlinecode"><span class="id" title="var">new_acts</span></span> 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="EIP20_no_acts" class="idref" href="#EIP20_no_acts"><span class="id" title="lemma">EIP20_no_acts</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:18" class="idref" href="#prev_state:18"><span class="id" title="binder">prev_state</span></a> <a id="new_state:19" class="idref" href="#new_state:19"><span class="id" title="binder">new_state</span></a> <a id="chain:20" class="idref" href="#chain:20"><span class="id" title="binder">chain</span></a> <a id="ctx:21" class="idref" href="#ctx:21"><span class="id" title="binder">ctx</span></a> <a id="msg:22" class="idref" href="#msg:22"><span class="id" title="binder">msg</span></a> <a id="new_acts:23" class="idref" href="#new_acts:23"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#chain:20"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:21"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:18"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#msg:22"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:19"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_acts:23"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_acts:23"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#receive"><span class="id" title="definition">receive</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#option_map"><span class="id" title="definition">option_map</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="var">destruct_match</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *); <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="receive_no_acts" class="idref" href="#receive_no_acts"><span class="id" title="lemma">receive_no_acts</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:24" class="idref" href="#prev_state:24"><span class="id" title="binder">prev_state</span></a> <a id="new_state:25" class="idref" href="#new_state:25"><span class="id" title="binder">new_state</span></a> <a id="chain:26" class="idref" href="#chain:26"><span class="id" title="binder">chain</span></a> <a id="ctx:27" class="idref" href="#ctx:27"><span class="id" title="binder">ctx</span></a> <a id="msg:28" class="idref" href="#msg:28"><span class="id" title="binder">msg</span></a> <a id="new_acts:29" class="idref" href="#new_acts:29"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#chain:26"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:27"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:24"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#msg:28"><span class="id" title="variable">msg</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:25"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_acts:29"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#chain:26"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:27"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:24"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#msg:28"><span class="id" title="variable">msg</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:25"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">erewrite</span> &lt;- <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#EIP20_no_acts"><span class="id" title="lemma">EIP20_no_acts</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Default entrypoint always fail 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="default_none" class="idref" href="#default_none"><span class="id" title="lemma">default_none</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:30" class="idref" href="#prev_state:30"><span class="id" title="binder">prev_state</span></a> <a id="chain:31" class="idref" href="#chain:31"><span class="id" title="binder">chain</span></a> <a id="ctx:32" class="idref" href="#ctx:32"><span class="id" title="binder">ctx</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#chain:31"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:32"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:30"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Err"><span class="id" title="constructor">Err</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#default_error"><span class="id" title="definition">default_error</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#receive"><span class="id" title="definition">receive</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">destruct_match</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
<a id="lab274"></a><h2 class="section">Expected behvaiour of EIP20 functions</h2>

</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="transfer_balance_update_correct" class="idref" href="#transfer_balance_update_correct"><span class="id" title="definition">transfer_balance_update_correct</span></a> <a id="old_state:51" class="idref" href="#old_state:51"><span class="id" title="binder">old_state</span></a> <a id="new_state:52" class="idref" href="#new_state:52"><span class="id" title="binder">new_state</span></a> <a id="from:53" class="idref" href="#from:53"><span class="id" title="binder">from</span></a> <a id="to:54" class="idref" href="#to:54"><span class="id" title="binder">to</span></a> <a id="tokens:55" class="idref" href="#tokens:55"><span class="id" title="binder">tokens</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="get_balance:58" class="idref" href="#get_balance:58"><span class="id" title="binder">get_balance</span></a> <a id="addr:56" class="idref" href="#addr:56"><span class="id" title="binder">addr</span></a> <a id="state:57" class="idref" href="#state:57"><span class="id" title="binder">state</span></a> := <a class="idref" href="ConCert.Utils.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#addr:56"><span class="id" title="variable">addr</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#state:57"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#balances"><span class="id" title="projection">balances</span></a>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="from_balance_before:59" class="idref" href="#from_balance_before:59"><span class="id" title="binder">from_balance_before</span></a> := <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#get_balance:58"><span class="id" title="variable">get_balance</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#from:53"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#old_state:51"><span class="id" title="variable">old_state</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="to_balance_before:60" class="idref" href="#to_balance_before:60"><span class="id" title="binder">to_balance_before</span></a> := <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#get_balance:58"><span class="id" title="variable">get_balance</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#to:54"><span class="id" title="variable">to</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#old_state:51"><span class="id" title="variable">old_state</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="from_balance_after:61" class="idref" href="#from_balance_after:61"><span class="id" title="binder">from_balance_after</span></a> := <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#get_balance:58"><span class="id" title="variable">get_balance</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#from:53"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:52"><span class="id" title="variable">new_state</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="to_balance_after:62" class="idref" href="#to_balance_after:62"><span class="id" title="binder">to_balance_after</span></a> := <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#get_balance:58"><span class="id" title="variable">get_balance</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#to:54"><span class="id" title="variable">to</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:52"><span class="id" title="variable">new_state</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;</div>

<div class="doc">
if the transfer is a self-transfer, balances should remain unchained 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#from:53"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#to:54"><span class="id" title="variable">to</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#from_balance_before:59"><span class="id" title="variable">from_balance_before</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#59a5ff4a6cbb127625aba1a377a243d1"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#from_balance_after:61"><span class="id" title="variable">from_balance_after</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#to_balance_before:60"><span class="id" title="variable">to_balance_before</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#59a5ff4a6cbb127625aba1a377a243d1"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#to_balance_after:62"><span class="id" title="variable">to_balance_after</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#from_balance_before:59"><span class="id" title="variable">from_balance_before</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#59a5ff4a6cbb127625aba1a377a243d1"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#from_balance_after:61"><span class="id" title="variable">from_balance_after</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#tokens:55"><span class="id" title="variable">tokens</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#to_balance_before:60"><span class="id" title="variable">to_balance_before</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#tokens:55"><span class="id" title="variable">tokens</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#59a5ff4a6cbb127625aba1a377a243d1"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#to_balance_after:62"><span class="id" title="variable">to_balance_after</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">)</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="transfer_from_allowances_update_correct" class="idref" href="#transfer_from_allowances_update_correct"><span class="id" title="definition">transfer_from_allowances_update_correct</span></a> (<a id="old_state:63" class="idref" href="#old_state:63"><span class="id" title="binder">old_state</span></a> <a id="new_state:64" class="idref" href="#new_state:64"><span class="id" title="binder">new_state</span></a> : <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#State"><span class="id" title="record">State</span></a>) (<a id="from:65" class="idref" href="#from:65"><span class="id" title="binder">from</span></a> <a id="delegate:66" class="idref" href="#delegate:66"><span class="id" title="binder">delegate</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<a id="tokens:67" class="idref" href="#tokens:67"><span class="id" title="binder">tokens</span></a> : <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#TokenValue"><span class="id" title="definition">TokenValue</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="delegate_allowance_before:68" class="idref" href="#delegate_allowance_before:68"><span class="id" title="binder">delegate_allowance_before</span></a> := <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#get_allowance"><span class="id" title="definition">get_allowance</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#old_state:63"><span class="id" title="variable">old_state</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#from:65"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#delegate:66"><span class="id" title="variable">delegate</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="delegate_allowance_after:69" class="idref" href="#delegate_allowance_after:69"><span class="id" title="binder">delegate_allowance_after</span></a> := <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#get_allowance"><span class="id" title="definition">get_allowance</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:64"><span class="id" title="variable">new_state</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#from:65"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#delegate:66"><span class="id" title="variable">delegate</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#delegate_allowance_before:68"><span class="id" title="variable">delegate_allowance_before</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#59a5ff4a6cbb127625aba1a377a243d1"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#delegate_allowance_after:69"><span class="id" title="variable">delegate_allowance_after</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#tokens:67"><span class="id" title="variable">tokens</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="approve_allowance_update_correct" class="idref" href="#approve_allowance_update_correct"><span class="id" title="definition">approve_allowance_update_correct</span></a> (<a id="new_state:70" class="idref" href="#new_state:70"><span class="id" title="binder">new_state</span></a> : <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#State"><span class="id" title="record">State</span></a>) (<a id="from:71" class="idref" href="#from:71"><span class="id" title="binder">from</span></a> <a id="delegate:72" class="idref" href="#delegate:72"><span class="id" title="binder">delegate</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<a id="tokens:73" class="idref" href="#tokens:73"><span class="id" title="binder">tokens</span></a> : <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#TokenValue"><span class="id" title="definition">TokenValue</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="delegate_allowance_after:74" class="idref" href="#delegate_allowance_after:74"><span class="id" title="binder">delegate_allowance_after</span></a> := <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#get_allowance"><span class="id" title="definition">get_allowance</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:70"><span class="id" title="variable">new_state</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#from:71"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#delegate:72"><span class="id" title="variable">delegate</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#delegate_allowance_after:74"><span class="id" title="variable">delegate_allowance_after</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#59a5ff4a6cbb127625aba1a377a243d1"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#tokens:73"><span class="id" title="variable">tokens</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab275"></a><h2 class="section">Transfer correct</h2>

<div class="paragraph"> </div>

 <span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#try_transfer"><span class="id" title="definition">try_transfer</span></a></span> correctly moves <span class="inlinecode"><a class="idref" href="ConCert.Examples.FA2.FA2Interface.html#amount"><span class="id" title="projection">amount</span></a></span> from <span class="inlinecode"><a class="idref" href="ConCert.Examples.Crowdfunding.CrowdfundingDataExt.html#sender"><span class="id" title="definition">sender</span></a></span> to <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#to"><span class="id" title="projection">to</span></a></span> 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_transfer_balance_correct" class="idref" href="#try_transfer_balance_correct"><span class="id" title="lemma">try_transfer_balance_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:75" class="idref" href="#prev_state:75"><span class="id" title="binder">prev_state</span></a> <a id="new_state:76" class="idref" href="#new_state:76"><span class="id" title="binder">new_state</span></a> <a id="chain:77" class="idref" href="#chain:77"><span class="id" title="binder">chain</span></a> <a id="ctx:78" class="idref" href="#ctx:78"><span class="id" title="binder">ctx</span></a> <a id="to:79" class="idref" href="#to:79"><span class="id" title="binder">to</span></a> <a id="amount:80" class="idref" href="#amount:80"><span class="id" title="binder">amount</span></a> <a id="new_acts:81" class="idref" href="#new_acts:81"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#chain:77"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:78"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:75"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#transfer"><span class="id" title="constructor">transfer</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#to:79"><span class="id" title="variable">to</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#amount:80"><span class="id" title="variable">amount</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:76"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_acts:81"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#transfer_balance_update_correct"><span class="id" title="definition">transfer_balance_update_correct</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:75"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:76"><span class="id" title="variable">new_state</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:78"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>) <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#to:79"><span class="id" title="variable">to</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#amount:80"><span class="id" title="variable">amount</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#transfer_balance_update_correct"><span class="id" title="definition">transfer_balance_update_correct</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rename</span> <span class="id" title="var">H0</span> <span class="id" title="var">into</span> <span class="id" title="var">sender_enough_balance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.ltb_ge"><span class="id" title="lemma">N.ltb_ge</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">sender_enough_balance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <span class="id" title="var">ctx</span>) (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#balances"><span class="id" title="projection">balances</span></a> <span class="id" title="var">prev_state</span>)) <span class="id" title="var">eqn</span>:<span class="id" title="var">from_prev</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">try</span> (<span class="id" title="tactic">rewrite</span> <span class="id" title="var">from_prev</span> || <span class="id" title="tactic">setoid_rewrite</span> <span class="id" title="var">from_prev</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">from_prev</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">chain</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;case:&nbsp;from&nbsp;=&nbsp;to&nbsp;&amp;&amp;&nbsp;find&nbsp;from&nbsp;=&nbsp;Some&nbsp;n&nbsp;&amp;&amp;&nbsp;amount&nbsp;&lt;=&nbsp;n&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">FMap_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.sub_add"><span class="id" title="lemma">N.sub_add</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.eqb_refl"><span class="id" title="lemma">N.eqb_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;case:&nbsp;from&nbsp;=&nbsp;to&nbsp;&amp;&amp;&nbsp;find&nbsp;from&nbsp;=&nbsp;None&nbsp;&amp;&amp;&nbsp;amount&nbsp;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.lt_eq_cases"><span class="id" title="lemma">N.lt_eq_cases</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">sender_enough_balance</span> <span class="id" title="keyword">as</span> []; [<span class="id" title="var">lia</span> | <span class="id" title="tactic">subst</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">FMap_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;case:&nbsp;from&nbsp;&lt;&gt;&nbsp;to&nbsp;&amp;&amp;&nbsp;find&nbsp;from&nbsp;=&nbsp;Some&nbsp;n&nbsp;&amp;&amp;&nbsp;amount&nbsp;&lt;=&nbsp;n&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">FMap_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.sub_add"><span class="id" title="lemma">N.sub_add</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.eqb_refl"><span class="id" title="lemma">N.eqb_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;case:&nbsp;from&nbsp;&lt;&gt;&nbsp;to&nbsp;&amp;&amp;&nbsp;find&nbsp;from&nbsp;=&nbsp;None&nbsp;&amp;&amp;&nbsp;amount&nbsp;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.lt_eq_cases"><span class="id" title="lemma">N.lt_eq_cases</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">sender_enough_balance</span> <span class="id" title="keyword">as</span> []; [<span class="id" title="var">lia</span> | <span class="id" title="tactic">subst</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">FMap_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.eqb_refl"><span class="id" title="lemma">N.eqb_refl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#try_transfer"><span class="id" title="definition">try_transfer</span></a></span> does not change the total supply of tokens 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_transfer_preserves_total_supply" class="idref" href="#try_transfer_preserves_total_supply"><span class="id" title="lemma">try_transfer_preserves_total_supply</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:82" class="idref" href="#prev_state:82"><span class="id" title="binder">prev_state</span></a> <a id="new_state:83" class="idref" href="#new_state:83"><span class="id" title="binder">new_state</span></a> <a id="chain:84" class="idref" href="#chain:84"><span class="id" title="binder">chain</span></a> <a id="ctx:85" class="idref" href="#ctx:85"><span class="id" title="binder">ctx</span></a> <a id="to:86" class="idref" href="#to:86"><span class="id" title="binder">to</span></a> <a id="amount:87" class="idref" href="#amount:87"><span class="id" title="binder">amount</span></a> <a id="new_acts:88" class="idref" href="#new_acts:88"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#chain:84"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:85"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:82"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#transfer"><span class="id" title="constructor">transfer</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#to:86"><span class="id" title="variable">to</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#amount:87"><span class="id" title="variable">amount</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:83"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_acts:88"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#total_supply"><span class="id" title="projection">total_supply</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:82"><span class="id" title="variable">prev_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#total_supply"><span class="id" title="projection">total_supply</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:83"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#try_transfer"><span class="id" title="definition">try_transfer</span></a></span> does not change allowances 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_transfer_preserves_allowances" class="idref" href="#try_transfer_preserves_allowances"><span class="id" title="lemma">try_transfer_preserves_allowances</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:89" class="idref" href="#prev_state:89"><span class="id" title="binder">prev_state</span></a> <a id="new_state:90" class="idref" href="#new_state:90"><span class="id" title="binder">new_state</span></a> <a id="chain:91" class="idref" href="#chain:91"><span class="id" title="binder">chain</span></a> <a id="ctx:92" class="idref" href="#ctx:92"><span class="id" title="binder">ctx</span></a> <a id="to:93" class="idref" href="#to:93"><span class="id" title="binder">to</span></a> <a id="amount:94" class="idref" href="#amount:94"><span class="id" title="binder">amount</span></a> <a id="new_acts:95" class="idref" href="#new_acts:95"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#chain:91"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:92"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:89"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#transfer"><span class="id" title="constructor">transfer</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#to:93"><span class="id" title="variable">to</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#amount:94"><span class="id" title="variable">amount</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:90"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_acts:95"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:89"><span class="id" title="variable">prev_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:90"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#try_transfer"><span class="id" title="definition">try_transfer</span></a></span> only modifies the <span class="inlinecode"><a class="idref" href="ConCert.Examples.Crowdfunding.CrowdfundingDataExt.html#sender"><span class="id" title="definition">sender</span></a></span> and <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#to"><span class="id" title="projection">to</span></a></span> balances 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_transfer_preserves_other_balances" class="idref" href="#try_transfer_preserves_other_balances"><span class="id" title="lemma">try_transfer_preserves_other_balances</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:96" class="idref" href="#prev_state:96"><span class="id" title="binder">prev_state</span></a> <a id="new_state:97" class="idref" href="#new_state:97"><span class="id" title="binder">new_state</span></a> <a id="chain:98" class="idref" href="#chain:98"><span class="id" title="binder">chain</span></a> <a id="ctx:99" class="idref" href="#ctx:99"><span class="id" title="binder">ctx</span></a> <a id="to:100" class="idref" href="#to:100"><span class="id" title="binder">to</span></a> <a id="amount:101" class="idref" href="#amount:101"><span class="id" title="binder">amount</span></a> <a id="new_acts:102" class="idref" href="#new_acts:102"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#chain:98"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:99"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:96"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#transfer"><span class="id" title="constructor">transfer</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#to:100"><span class="id" title="variable">to</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#amount:101"><span class="id" title="variable">amount</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:97"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_acts:102"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="account:103" class="idref" href="#account:103"><span class="id" title="binder">account</span></a>, <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#account:103"><span class="id" title="variable">account</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:99"><span class="id" title="variable">ctx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#account:103"><span class="id" title="variable">account</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#to:100"><span class="id" title="variable">to</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#account:103"><span class="id" title="variable">account</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#balances"><span class="id" title="projection">balances</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:96"><span class="id" title="variable">prev_state</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#account:103"><span class="id" title="variable">account</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#balances"><span class="id" title="projection">balances</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:97"><span class="id" title="variable">new_state</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span> <span class="id" title="var">account</span> <span class="id" title="var">account_not_sender</span> <span class="id" title="var">account_not_receiver</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">FMap_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If the requirements are met then then receive on transfer msg must succeed and
      if receive on transfer msg succeeds then requirements must hold 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_transfer_is_some" class="idref" href="#try_transfer_is_some"><span class="id" title="lemma">try_transfer_is_some</span></a> : <span class="id" title="keyword">forall</span> <a id="state:104" class="idref" href="#state:104"><span class="id" title="binder">state</span></a> <a id="chain:105" class="idref" href="#chain:105"><span class="id" title="binder">chain</span></a> <a id="ctx:106" class="idref" href="#ctx:106"><span class="id" title="binder">ctx</span></a> <a id="to:107" class="idref" href="#to:107"><span class="id" title="binder">to</span></a> <a id="amount:108" class="idref" href="#amount:108"><span class="id" title="binder">amount</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:106"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> 0)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#amount:108"><span class="id" title="variable">amount</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#2ccca3280733654024e33c2005ae2530"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Utils.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:106"><span class="id" title="variable">ctx</span></a>) (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#balances"><span class="id" title="projection">balances</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#state:104"><span class="id" title="variable">state</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#isOk"><span class="id" title="definition">isOk</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#chain:105"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:106"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#state:104"><span class="id" title="variable">state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#transfer"><span class="id" title="constructor">transfer</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#to:107"><span class="id" title="variable">to</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#amount:108"><span class="id" title="variable">amount</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> (<span class="id" title="var">amount_positive</span> &amp; <span class="id" title="var">sender_enough_balance</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>; <span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">amount_from</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.ltb_ge"><span class="id" title="lemma">N.ltb_ge</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">sender_enough_balance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">setoid_rewrite</span> <span class="id" title="var">sender_enough_balance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">amount_positive</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">amount_from</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">amount_from_</span> <span class="id" title="tactic">in</span> <span class="id" title="var">amount_from</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab276"></a><h2 class="section">Transfer_from correct</h2>

<div class="paragraph"> </div>

 <span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#try_transfer_from"><span class="id" title="definition">try_transfer_from</span></a></span> correctly updates balance and allowance 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_transfer_from_balance_correct" class="idref" href="#try_transfer_from_balance_correct"><span class="id" title="lemma">try_transfer_from_balance_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:109" class="idref" href="#prev_state:109"><span class="id" title="binder">prev_state</span></a> <a id="new_state:110" class="idref" href="#new_state:110"><span class="id" title="binder">new_state</span></a> <a id="chain:111" class="idref" href="#chain:111"><span class="id" title="binder">chain</span></a> <a id="ctx:112" class="idref" href="#ctx:112"><span class="id" title="binder">ctx</span></a> <a id="from:113" class="idref" href="#from:113"><span class="id" title="binder">from</span></a> <a id="to:114" class="idref" href="#to:114"><span class="id" title="binder">to</span></a> <a id="amount:115" class="idref" href="#amount:115"><span class="id" title="binder">amount</span></a> <a id="new_acts:116" class="idref" href="#new_acts:116"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#chain:111"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:112"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:109"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#transfer_from"><span class="id" title="constructor">transfer_from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#from:113"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#to:114"><span class="id" title="variable">to</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#amount:115"><span class="id" title="variable">amount</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:110"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_acts:116"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#transfer_balance_update_correct"><span class="id" title="definition">transfer_balance_update_correct</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:109"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:110"><span class="id" title="variable">new_state</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#from:113"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#to:114"><span class="id" title="variable">to</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#amount:115"><span class="id" title="variable">amount</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#transfer_from_allowances_update_correct"><span class="id" title="definition">transfer_from_allowances_update_correct</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:109"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:110"><span class="id" title="variable">new_state</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#from:113"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:112"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>) <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#amount:115"><span class="id" title="variable">amount</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#transfer_balance_update_correct"><span class="id" title="definition">transfer_balance_update_correct</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#transfer_from_allowances_update_correct"><span class="id" title="definition">transfer_from_allowances_update_correct</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#get_allowance"><span class="id" title="definition">get_allowance</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rename</span> <span class="id" title="var">H0</span> <span class="id" title="var">into</span> <span class="id" title="var">from_allowances</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rename</span> <span class="id" title="var">H1</span> <span class="id" title="var">into</span> <span class="id" title="var">sender_allowance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.ResultMonad.html#result_of_option_eq_some"><span class="id" title="lemma">result_of_option_eq_some</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">from_allowances</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.ResultMonad.html#result_of_option_eq_some"><span class="id" title="lemma">result_of_option_eq_some</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">sender_allowance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">sender_enough_allowance</span> &amp; <span class="id" title="var">from_enough_balance</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;proof&nbsp;of&nbsp;balance&nbsp;updated&nbsp;correct&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <span class="id" title="var">from</span> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#balances"><span class="id" title="projection">balances</span></a> <span class="id" title="var">prev_state</span>)) <span class="id" title="var">eqn</span>:<span class="id" title="var">from_bal_prev</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>; <span class="id" title="tactic">try</span> (<span class="id" title="tactic">rewrite</span> <span class="id" title="var">from_bal_prev</span> || <span class="id" title="tactic">setoid_rewrite</span> <span class="id" title="var">from_bal_prev</span>); <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;case:&nbsp;from&nbsp;=&nbsp;to&nbsp;&amp;&amp;&nbsp;find&nbsp;from&nbsp;=&nbsp;Some&nbsp;n&nbsp;&amp;&amp;&nbsp;amount&nbsp;&lt;=&nbsp;n&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">FMap_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.sub_add"><span class="id" title="lemma">N.sub_add</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.eqb_refl"><span class="id" title="lemma">N.eqb_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;case:&nbsp;from&nbsp;=&nbsp;to&nbsp;&amp;&amp;&nbsp;find&nbsp;from&nbsp;=&nbsp;None&nbsp;&amp;&amp;&nbsp;amount&nbsp;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.lt_eq_cases"><span class="id" title="lemma">N.lt_eq_cases</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">from_enough_balance</span> <span class="id" title="keyword">as</span> []; [<span class="id" title="var">lia</span> | <span class="id" title="tactic">subst</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">FMap_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;case:&nbsp;from&nbsp;&lt;&gt;&nbsp;to&nbsp;&amp;&amp;&nbsp;find&nbsp;from&nbsp;=&nbsp;Some&nbsp;n&nbsp;&amp;&amp;&nbsp;amount&nbsp;&lt;=&nbsp;n&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">FMap_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.sub_add"><span class="id" title="lemma">N.sub_add</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> ?<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.eqb_refl"><span class="id" title="lemma">N.eqb_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;case:&nbsp;from&nbsp;&lt;&gt;&nbsp;to&nbsp;&amp;&amp;&nbsp;find&nbsp;from&nbsp;=&nbsp;None&nbsp;&amp;&amp;&nbsp;amount&nbsp;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.lt_eq_cases"><span class="id" title="lemma">N.lt_eq_cases</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">from_enough_balance</span> <span class="id" title="keyword">as</span> []; [<span class="id" title="var">lia</span> | <span class="id" title="tactic">subst</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">FMap_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.eqb_refl"><span class="id" title="lemma">N.eqb_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;proof&nbsp;of&nbsp;allowances&nbsp;updated&nbsp;correct&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">from_allowances</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <span class="id" title="var">sender_allowance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">FMap_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.sub_add"><span class="id" title="lemma">N.sub_add</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#try_transfer_from"><span class="id" title="definition">try_transfer_from</span></a></span> does not change total supply of tokens 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_transfer_from_preserves_total_supply" class="idref" href="#try_transfer_from_preserves_total_supply"><span class="id" title="lemma">try_transfer_from_preserves_total_supply</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:117" class="idref" href="#prev_state:117"><span class="id" title="binder">prev_state</span></a> <a id="new_state:118" class="idref" href="#new_state:118"><span class="id" title="binder">new_state</span></a> <a id="chain:119" class="idref" href="#chain:119"><span class="id" title="binder">chain</span></a> <a id="ctx:120" class="idref" href="#ctx:120"><span class="id" title="binder">ctx</span></a> <a id="from:121" class="idref" href="#from:121"><span class="id" title="binder">from</span></a> <a id="to:122" class="idref" href="#to:122"><span class="id" title="binder">to</span></a> <a id="amount:123" class="idref" href="#amount:123"><span class="id" title="binder">amount</span></a> <a id="new_acts:124" class="idref" href="#new_acts:124"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#chain:119"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:120"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:117"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#transfer_from"><span class="id" title="constructor">transfer_from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#from:121"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#to:122"><span class="id" title="variable">to</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#amount:123"><span class="id" title="variable">amount</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:118"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_acts:124"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#total_supply"><span class="id" title="projection">total_supply</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:117"><span class="id" title="variable">prev_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#total_supply"><span class="id" title="projection">total_supply</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:118"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#try_transfer_from"><span class="id" title="definition">try_transfer_from</span></a></span> only changes <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a></span> and <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#to"><span class="id" title="projection">to</span></a></span> balances 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_transfer_from_preserves_other_balances" class="idref" href="#try_transfer_from_preserves_other_balances"><span class="id" title="lemma">try_transfer_from_preserves_other_balances</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:125" class="idref" href="#prev_state:125"><span class="id" title="binder">prev_state</span></a> <a id="new_state:126" class="idref" href="#new_state:126"><span class="id" title="binder">new_state</span></a> <a id="chain:127" class="idref" href="#chain:127"><span class="id" title="binder">chain</span></a> <a id="ctx:128" class="idref" href="#ctx:128"><span class="id" title="binder">ctx</span></a> <a id="from:129" class="idref" href="#from:129"><span class="id" title="binder">from</span></a> <a id="to:130" class="idref" href="#to:130"><span class="id" title="binder">to</span></a> <a id="amount:131" class="idref" href="#amount:131"><span class="id" title="binder">amount</span></a> <a id="new_acts:132" class="idref" href="#new_acts:132"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#chain:127"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:128"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:125"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#transfer_from"><span class="id" title="constructor">transfer_from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#from:129"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#to:130"><span class="id" title="variable">to</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#amount:131"><span class="id" title="variable">amount</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:126"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_acts:132"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="account:133" class="idref" href="#account:133"><span class="id" title="binder">account</span></a>, <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#account:133"><span class="id" title="variable">account</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#from:129"><span class="id" title="variable">from</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#account:133"><span class="id" title="variable">account</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#to:130"><span class="id" title="variable">to</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#account:133"><span class="id" title="variable">account</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#balances"><span class="id" title="projection">balances</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:125"><span class="id" title="variable">prev_state</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#account:133"><span class="id" title="variable">account</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#balances"><span class="id" title="projection">balances</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:126"><span class="id" title="variable">new_state</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span> <span class="id" title="var">account</span> <span class="id" title="var">account_not_from</span> <span class="id" title="var">account_not_to</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">FMap_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#try_transfer_from"><span class="id" title="definition">try_transfer_from</span></a></span> only changes allowance map of <span class="inlinecode"><a class="idref" href="ConCert.Examples.Dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a></span> 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_transfer_from_preserves_other_allowances" class="idref" href="#try_transfer_from_preserves_other_allowances"><span class="id" title="lemma">try_transfer_from_preserves_other_allowances</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:134" class="idref" href="#prev_state:134"><span class="id" title="binder">prev_state</span></a> <a id="new_state:135" class="idref" href="#new_state:135"><span class="id" title="binder">new_state</span></a> <a id="chain:136" class="idref" href="#chain:136"><span class="id" title="binder">chain</span></a> <a id="ctx:137" class="idref" href="#ctx:137"><span class="id" title="binder">ctx</span></a> <a id="from:138" class="idref" href="#from:138"><span class="id" title="binder">from</span></a> <a id="to:139" class="idref" href="#to:139"><span class="id" title="binder">to</span></a> <a id="amount:140" class="idref" href="#amount:140"><span class="id" title="binder">amount</span></a> <a id="new_acts:141" class="idref" href="#new_acts:141"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#chain:136"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:137"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:134"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#transfer_from"><span class="id" title="constructor">transfer_from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#from:138"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#to:139"><span class="id" title="variable">to</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#amount:140"><span class="id" title="variable">amount</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:135"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_acts:141"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="account:142" class="idref" href="#account:142"><span class="id" title="binder">account</span></a>, <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#account:142"><span class="id" title="variable">account</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#from:138"><span class="id" title="variable">from</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#account:142"><span class="id" title="variable">account</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:134"><span class="id" title="variable">prev_state</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#account:142"><span class="id" title="variable">account</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:135"><span class="id" title="variable">new_state</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span> <span class="id" title="var">account</span> <span class="id" title="var">account_not_from</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">FMap_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#try_transfer_from"><span class="id" title="definition">try_transfer_from</span></a></span> only changes allowance of <span class="inlinecode"><a class="idref" href="ConCert.Examples.Crowdfunding.CrowdfundingDataExt.html#sender"><span class="id" title="definition">sender</span></a></span> 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_transfer_from_preserves_other_allowance" class="idref" href="#try_transfer_from_preserves_other_allowance"><span class="id" title="lemma">try_transfer_from_preserves_other_allowance</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:143" class="idref" href="#prev_state:143"><span class="id" title="binder">prev_state</span></a> <a id="new_state:144" class="idref" href="#new_state:144"><span class="id" title="binder">new_state</span></a> <a id="chain:145" class="idref" href="#chain:145"><span class="id" title="binder">chain</span></a> <a id="ctx:146" class="idref" href="#ctx:146"><span class="id" title="binder">ctx</span></a> <a id="from:147" class="idref" href="#from:147"><span class="id" title="binder">from</span></a> <a id="to:148" class="idref" href="#to:148"><span class="id" title="binder">to</span></a> <a id="amount:149" class="idref" href="#amount:149"><span class="id" title="binder">amount</span></a> <a id="new_acts:150" class="idref" href="#new_acts:150"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#chain:145"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:146"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:143"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#transfer_from"><span class="id" title="constructor">transfer_from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#from:147"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#to:148"><span class="id" title="variable">to</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#amount:149"><span class="id" title="variable">amount</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:144"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_acts:150"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="account:151" class="idref" href="#account:151"><span class="id" title="binder">account</span></a>, <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#account:151"><span class="id" title="variable">account</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:146"><span class="id" title="variable">ctx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#get_allowance"><span class="id" title="definition">get_allowance</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:143"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#from:147"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#account:151"><span class="id" title="variable">account</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#get_allowance"><span class="id" title="definition">get_allowance</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:144"><span class="id" title="variable">new_state</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#from:147"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#account:151"><span class="id" title="variable">account</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span> <span class="id" title="var">account</span> <span class="id" title="var">account_not_sender</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#get_allowance"><span class="id" title="definition">get_allowance</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.ResultMonad.html#result_of_option_eq_some"><span class="id" title="lemma">result_of_option_eq_some</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.ResultMonad.html#result_of_option_eq_some"><span class="id" title="lemma">result_of_option_eq_some</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">FMap_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Set</span> <span class="id" title="var">Keyed</span> <span class="id" title="var">Unification</span>.<br/>

<br/>
</div>

<div class="doc">
If the requirements are met then then receive on transfer_from msg must succeed and
      if receive on transfer_from msg succeeds then requirements must hold 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_transfer_from_is_some" class="idref" href="#try_transfer_from_is_some"><span class="id" title="lemma">try_transfer_from_is_some</span></a> : <span class="id" title="keyword">forall</span> <a id="state:152" class="idref" href="#state:152"><span class="id" title="binder">state</span></a> <a id="chain:153" class="idref" href="#chain:153"><span class="id" title="binder">chain</span></a> <a id="ctx:154" class="idref" href="#ctx:154"><span class="id" title="binder">ctx</span></a> <a id="from:155" class="idref" href="#from:155"><span class="id" title="binder">from</span></a> <a id="to:156" class="idref" href="#to:156"><span class="id" title="binder">to</span></a> <a id="amount:157" class="idref" href="#amount:157"><span class="id" title="binder">amount</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="get_allowance_:159" class="idref" href="#get_allowance_:159"><span class="id" title="binder">get_allowance_</span></a> <a id="account:158" class="idref" href="#account:158"><span class="id" title="binder">account</span></a> := <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#account:158"><span class="id" title="variable">account</span></a> (<a class="idref" href="ConCert.Utils.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> (@<a class="idref" href="ConCert.Execution.Containers.html#FMap.empty"><span class="id" title="abbreviation">FMap.empty</span></a> (<a class="idref" href="ConCert.Execution.Containers.html#FMap"><span class="id" title="abbreviation">FMap</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#TokenValue"><span class="id" title="definition">TokenValue</span></a>) <span class="id" title="var">_</span>) (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#from:155"><span class="id" title="variable">from</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#state:152"><span class="id" title="variable">state</span></a>))) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:154"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#0f6d3b46a03d1336a5ac68936077dc02"><span class="id" title="notation">&gt;?</span></a> 0)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.Extras.html#isSome"><span class="id" title="definition">isSome</span></a> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#from:155"><span class="id" title="variable">from</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#state:152"><span class="id" title="variable">state</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="ConCert.Utils.Extras.html#isSome"><span class="id" title="definition">isSome</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#get_allowance_:159"><span class="id" title="variable">get_allowance_</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:154"><span class="id" title="variable">ctx</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#amount:157"><span class="id" title="variable">amount</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#2ccca3280733654024e33c2005ae2530"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Utils.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#from:155"><span class="id" title="variable">from</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#balances"><span class="id" title="projection">balances</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#state:152"><span class="id" title="variable">state</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#amount:157"><span class="id" title="variable">amount</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#2ccca3280733654024e33c2005ae2530"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Utils.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#get_allowance_:159"><span class="id" title="variable">get_allowance_</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:154"><span class="id" title="variable">ctx</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#isOk"><span class="id" title="definition">isOk</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#chain:153"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:154"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#state:152"><span class="id" title="variable">state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#transfer_from"><span class="id" title="constructor">transfer_from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#from:155"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#to:156"><span class="id" title="variable">to</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#amount:157"><span class="id" title="variable">amount</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">sender_amount_zero</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="var">contract_simpl</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">sender_amount_zero</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">get_allowance_</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">get_allowance_</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> (<span class="id" title="var">from_allowances_some</span> &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">sender_allowance</span> &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">from_enough_balance</span>%<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.ltb_ge"><span class="id" title="lemma">N.ltb_ge</span></a> &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">sender_enough_allowance</span>%<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.ltb_ge"><span class="id" title="lemma">N.ltb_ge</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">receive_some</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">allowances_ctx</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.ResultMonad.html#result_of_option_eq_none"><span class="id" title="lemma">result_of_option_eq_none</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">allowances_ctx</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">allowances_ctx</span> <span class="id" title="tactic">in</span> <span class="id" title="var">from_allowances_some</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.ResultMonad.html#result_of_option_eq_some"><span class="id" title="lemma">result_of_option_eq_some</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">allowances_ctx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">allowances_ctx</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">from_allowances_some</span> <span class="id" title="var">allowances_ctx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">allowance_ctx</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.ResultMonad.html#result_of_option_eq_none"><span class="id" title="lemma">result_of_option_eq_none</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">allowance_ctx</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">allowance_ctx</span> <span class="id" title="tactic">in</span> <span class="id" title="var">sender_allowance</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.ResultMonad.html#result_of_option_eq_some"><span class="id" title="lemma">result_of_option_eq_some</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">allowance_ctx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">allowance_ctx</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">allowance_ctx</span> <span class="id" title="var">sender_allowance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">amount_from</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">from_enough_balance</span> <span class="id" title="tactic">in</span> <span class="id" title="var">amount_from</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">sender_enough_allowance</span> <span class="id" title="tactic">in</span> <span class="id" title="var">amount_from</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">H</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">allowances_ctx</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">allowance_ctx</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">amount_from</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.ResultMonad.html#result_of_option_eq_some"><span class="id" title="lemma">result_of_option_eq_some</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">allowances_ctx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.ResultMonad.html#result_of_option_eq_some"><span class="id" title="lemma">result_of_option_eq_some</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">allowance_ctx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">allowances_ctx</span>, <span class="id" title="var">allowance_ctx</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab277"></a><h2 class="section">Approve correct</h2>

<div class="paragraph"> </div>

 <span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#try_approve"><span class="id" title="definition">try_approve</span></a></span> correctly replaces allowance 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_approve_allowance_correct" class="idref" href="#try_approve_allowance_correct"><span class="id" title="lemma">try_approve_allowance_correct</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:160" class="idref" href="#prev_state:160"><span class="id" title="binder">prev_state</span></a> <a id="new_state:161" class="idref" href="#new_state:161"><span class="id" title="binder">new_state</span></a> <a id="chain:162" class="idref" href="#chain:162"><span class="id" title="binder">chain</span></a> <a id="ctx:163" class="idref" href="#ctx:163"><span class="id" title="binder">ctx</span></a> <a id="delegate:164" class="idref" href="#delegate:164"><span class="id" title="binder">delegate</span></a> <a id="amount:165" class="idref" href="#amount:165"><span class="id" title="binder">amount</span></a> <a id="new_acts:166" class="idref" href="#new_acts:166"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#chain:162"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:163"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:160"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#approve"><span class="id" title="constructor">approve</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#delegate:164"><span class="id" title="variable">delegate</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#amount:165"><span class="id" title="variable">amount</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:161"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_acts:166"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#approve_allowance_update_correct"><span class="id" title="definition">approve_allowance_update_correct</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:161"><span class="id" title="variable">new_state</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:163"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>) <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#delegate:164"><span class="id" title="variable">delegate</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#amount:165"><span class="id" title="variable">amount</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#approve_allowance_update_correct"><span class="id" title="definition">approve_allowance_update_correct</span></a>, <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#get_allowance"><span class="id" title="definition">get_allowance</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">from_allowance</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>; <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">FMap_simpl</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.NArith.BinNat.html#N.eqb_refl"><span class="id" title="lemma">N.eqb_refl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#try_approve"><span class="id" title="definition">try_approve</span></a></span> does not change total supply of tokens 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_approve_preserves_total_supply" class="idref" href="#try_approve_preserves_total_supply"><span class="id" title="lemma">try_approve_preserves_total_supply</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:167" class="idref" href="#prev_state:167"><span class="id" title="binder">prev_state</span></a> <a id="new_state:168" class="idref" href="#new_state:168"><span class="id" title="binder">new_state</span></a> <a id="chain:169" class="idref" href="#chain:169"><span class="id" title="binder">chain</span></a> <a id="ctx:170" class="idref" href="#ctx:170"><span class="id" title="binder">ctx</span></a> <a id="delegate:171" class="idref" href="#delegate:171"><span class="id" title="binder">delegate</span></a> <a id="amount:172" class="idref" href="#amount:172"><span class="id" title="binder">amount</span></a> <a id="new_acts:173" class="idref" href="#new_acts:173"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#chain:169"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:170"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:167"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#approve"><span class="id" title="constructor">approve</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#delegate:171"><span class="id" title="variable">delegate</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#amount:172"><span class="id" title="variable">amount</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:168"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_acts:173"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#total_supply"><span class="id" title="projection">total_supply</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:167"><span class="id" title="variable">prev_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#total_supply"><span class="id" title="projection">total_supply</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:168"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#try_approve"><span class="id" title="definition">try_approve</span></a></span> does not change balances 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_approve_preserves_balances" class="idref" href="#try_approve_preserves_balances"><span class="id" title="lemma">try_approve_preserves_balances</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:174" class="idref" href="#prev_state:174"><span class="id" title="binder">prev_state</span></a> <a id="new_state:175" class="idref" href="#new_state:175"><span class="id" title="binder">new_state</span></a> <a id="chain:176" class="idref" href="#chain:176"><span class="id" title="binder">chain</span></a> <a id="ctx:177" class="idref" href="#ctx:177"><span class="id" title="binder">ctx</span></a> <a id="delegate:178" class="idref" href="#delegate:178"><span class="id" title="binder">delegate</span></a> <a id="amount:179" class="idref" href="#amount:179"><span class="id" title="binder">amount</span></a> <a id="new_acts:180" class="idref" href="#new_acts:180"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#chain:176"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:177"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:174"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#approve"><span class="id" title="constructor">approve</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#delegate:178"><span class="id" title="variable">delegate</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#amount:179"><span class="id" title="variable">amount</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:175"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_acts:180"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#balances"><span class="id" title="projection">balances</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:174"><span class="id" title="variable">prev_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#balances"><span class="id" title="projection">balances</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:175"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#try_approve"><span class="id" title="definition">try_approve</span></a></span> does not change allowances map of other addresses 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_approve_preserves_other_allowances" class="idref" href="#try_approve_preserves_other_allowances"><span class="id" title="lemma">try_approve_preserves_other_allowances</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:181" class="idref" href="#prev_state:181"><span class="id" title="binder">prev_state</span></a> <a id="new_state:182" class="idref" href="#new_state:182"><span class="id" title="binder">new_state</span></a> <a id="chain:183" class="idref" href="#chain:183"><span class="id" title="binder">chain</span></a> <a id="ctx:184" class="idref" href="#ctx:184"><span class="id" title="binder">ctx</span></a> <a id="delegate:185" class="idref" href="#delegate:185"><span class="id" title="binder">delegate</span></a> <a id="amount:186" class="idref" href="#amount:186"><span class="id" title="binder">amount</span></a> <a id="new_acts:187" class="idref" href="#new_acts:187"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#chain:183"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:184"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:181"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#approve"><span class="id" title="constructor">approve</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#delegate:185"><span class="id" title="variable">delegate</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#amount:186"><span class="id" title="variable">amount</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:182"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_acts:187"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="account:188" class="idref" href="#account:188"><span class="id" title="binder">account</span></a>, <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#account:188"><span class="id" title="variable">account</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:184"><span class="id" title="variable">ctx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#account:188"><span class="id" title="variable">account</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:181"><span class="id" title="variable">prev_state</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#account:188"><span class="id" title="variable">account</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:182"><span class="id" title="variable">new_state</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span> <span class="id" title="var">account</span> <span class="id" title="var">account_not_sender</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>; <span class="id" title="var">FMap_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#try_approve"><span class="id" title="definition">try_approve</span></a></span> does not change allowance of other addresses 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_approve_preserves_other_allowance" class="idref" href="#try_approve_preserves_other_allowance"><span class="id" title="lemma">try_approve_preserves_other_allowance</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:189" class="idref" href="#prev_state:189"><span class="id" title="binder">prev_state</span></a> <a id="new_state:190" class="idref" href="#new_state:190"><span class="id" title="binder">new_state</span></a> <a id="chain:191" class="idref" href="#chain:191"><span class="id" title="binder">chain</span></a> <a id="ctx:192" class="idref" href="#ctx:192"><span class="id" title="binder">ctx</span></a> <a id="delegate:193" class="idref" href="#delegate:193"><span class="id" title="binder">delegate</span></a> <a id="amount:194" class="idref" href="#amount:194"><span class="id" title="binder">amount</span></a> <a id="new_acts:195" class="idref" href="#new_acts:195"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#chain:191"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:192"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:189"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#approve"><span class="id" title="constructor">approve</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#delegate:193"><span class="id" title="variable">delegate</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#amount:194"><span class="id" title="variable">amount</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:190"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_acts:195"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="account:196" class="idref" href="#account:196"><span class="id" title="binder">account</span></a>, <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#account:196"><span class="id" title="variable">account</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#delegate:193"><span class="id" title="variable">delegate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#get_allowance"><span class="id" title="definition">get_allowance</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:189"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:192"><span class="id" title="variable">ctx</span></a>) <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#account:196"><span class="id" title="variable">account</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#get_allowance"><span class="id" title="definition">get_allowance</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:190"><span class="id" title="variable">new_state</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:192"><span class="id" title="variable">ctx</span></a>) <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#account:196"><span class="id" title="variable">account</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span> <span class="id" title="var">account</span> <span class="id" title="var">account_not_delegate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#get_allowance"><span class="id" title="definition">get_allowance</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">allowances_from</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>; <span class="id" title="var">FMap_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If the requirements are met then then receive on approve msg must succeed and
      if receive on approve msg succeeds then requirements must hold 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_approve_is_some" class="idref" href="#try_approve_is_some"><span class="id" title="lemma">try_approve_is_some</span></a> : <span class="id" title="keyword">forall</span> <a id="state:197" class="idref" href="#state:197"><span class="id" title="binder">state</span></a> <a id="chain:198" class="idref" href="#chain:198"><span class="id" title="binder">chain</span></a> <a id="ctx:199" class="idref" href="#ctx:199"><span class="id" title="binder">ctx</span></a> <a id="delegate:200" class="idref" href="#delegate:200"><span class="id" title="binder">delegate</span></a> <a id="amount:201" class="idref" href="#amount:201"><span class="id" title="binder">amount</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:199"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.ZArith.BinInt.html#0f6d3b46a03d1336a5ac68936077dc02"><span class="id" title="notation">&gt;?</span></a> 0)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#isOk"><span class="id" title="definition">isOk</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#chain:198"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:199"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#state:197"><span class="id" title="variable">state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#approve"><span class="id" title="constructor">approve</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#delegate:200"><span class="id" title="variable">delegate</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#amount:201"><span class="id" title="variable">amount</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">sender_amount_zero</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">sender_amount_zero</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">H</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">destruct_match</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab278"></a><h2 class="section">EIP20 functions preserve sum of balances</h2>

<div class="paragraph"> </div>

 Sum of all balances remain the same after proccessing transfer msg 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_transfer_preserves_balances_sum" class="idref" href="#try_transfer_preserves_balances_sum"><span class="id" title="lemma">try_transfer_preserves_balances_sum</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:202" class="idref" href="#prev_state:202"><span class="id" title="binder">prev_state</span></a> <a id="new_state:203" class="idref" href="#new_state:203"><span class="id" title="binder">new_state</span></a> <a id="chain:204" class="idref" href="#chain:204"><span class="id" title="binder">chain</span></a> <a id="ctx:205" class="idref" href="#ctx:205"><span class="id" title="binder">ctx</span></a> <a id="to:206" class="idref" href="#to:206"><span class="id" title="binder">to</span></a> <a id="amount:207" class="idref" href="#amount:207"><span class="id" title="binder">amount</span></a> <a id="new_acts:208" class="idref" href="#new_acts:208"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#chain:204"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:205"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:202"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#transfer"><span class="id" title="constructor">transfer</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#to:206"><span class="id" title="variable">to</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#amount:207"><span class="id" title="variable">amount</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:203"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_acts:208"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#sum_balances"><span class="id" title="definition">sum_balances</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:202"><span class="id" title="variable">prev_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#sum_balances"><span class="id" title="definition">sum_balances</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:203"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#sum_balances"><span class="id" title="definition">sum_balances</span></a>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#sumN_FMap_add_sub"><span class="id" title="lemma">sumN_FMap_add_sub</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Sum of all balances remain the same after proccessing transfer_from msg 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_transfer_from_preserves_balances_sum" class="idref" href="#try_transfer_from_preserves_balances_sum"><span class="id" title="lemma">try_transfer_from_preserves_balances_sum</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:209" class="idref" href="#prev_state:209"><span class="id" title="binder">prev_state</span></a> <a id="new_state:210" class="idref" href="#new_state:210"><span class="id" title="binder">new_state</span></a> <a id="chain:211" class="idref" href="#chain:211"><span class="id" title="binder">chain</span></a> <a id="ctx:212" class="idref" href="#ctx:212"><span class="id" title="binder">ctx</span></a> <a id="from:213" class="idref" href="#from:213"><span class="id" title="binder">from</span></a> <a id="to:214" class="idref" href="#to:214"><span class="id" title="binder">to</span></a> <a id="amount:215" class="idref" href="#amount:215"><span class="id" title="binder">amount</span></a> <a id="new_acts:216" class="idref" href="#new_acts:216"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#chain:211"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:212"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:209"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#transfer_from"><span class="id" title="constructor">transfer_from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#from:213"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#to:214"><span class="id" title="variable">to</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#amount:215"><span class="id" title="variable">amount</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:210"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_acts:216"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#sum_balances"><span class="id" title="definition">sum_balances</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:209"><span class="id" title="variable">prev_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#sum_balances"><span class="id" title="definition">sum_balances</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:210"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#sum_balances"><span class="id" title="definition">sum_balances</span></a>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#sumN_FMap_add_sub"><span class="id" title="lemma">sumN_FMap_add_sub</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Sum of all balances remain the same after approve transfer msg 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="try_approve_preserves_balances_sum" class="idref" href="#try_approve_preserves_balances_sum"><span class="id" title="lemma">try_approve_preserves_balances_sum</span></a> : <span class="id" title="keyword">forall</span> <a id="prev_state:217" class="idref" href="#prev_state:217"><span class="id" title="binder">prev_state</span></a> <a id="new_state:218" class="idref" href="#new_state:218"><span class="id" title="binder">new_state</span></a> <a id="chain:219" class="idref" href="#chain:219"><span class="id" title="binder">chain</span></a> <a id="ctx:220" class="idref" href="#ctx:220"><span class="id" title="binder">ctx</span></a> <a id="delegate:221" class="idref" href="#delegate:221"><span class="id" title="binder">delegate</span></a> <a id="amount:222" class="idref" href="#amount:222"><span class="id" title="binder">amount</span></a> <a id="new_acts:223" class="idref" href="#new_acts:223"><span class="id" title="binder">new_acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#chain:219"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#ctx:220"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:217"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#approve"><span class="id" title="constructor">approve</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#delegate:221"><span class="id" title="variable">delegate</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#amount:222"><span class="id" title="variable">amount</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:218"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_acts:223"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#sum_balances"><span class="id" title="definition">sum_balances</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#prev_state:217"><span class="id" title="variable">prev_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#sum_balances"><span class="id" title="definition">sum_balances</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#new_state:218"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab279"></a><h2 class="section">Contract never produces any actions</h2>

</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="outgoing_acts_nil" class="idref" href="#outgoing_acts_nil"><span class="id" title="lemma">outgoing_acts_nil</span></a> : <span class="id" title="keyword">forall</span> (<a id="bstate:224" class="idref" href="#bstate:224"><span class="id" title="binder">bstate</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) (<a id="caddr:225" class="idref" href="#caddr:225"><span class="id" title="binder">caddr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#bstate:224"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#bstate:224"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#caddr:225"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#bstate:224"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#caddr:225"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">reach</span> <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#lift_outgoing_acts_nil"><span class="id" title="lemma">lift_outgoing_acts_nil</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#contract"><span class="id" title="definition">contract</span></a>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">Blockchain.receive</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#EIP20_no_acts"><span class="id" title="lemma">EIP20_no_acts</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab280"></a><h2 class="section">Total supply always equals inial supply</h2>

</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="total_supply_eq_init_supply" class="idref" href="#total_supply_eq_init_supply"><span class="id" title="lemma">total_supply_eq_init_supply</span></a> <a id="bstate:226" class="idref" href="#bstate:226"><span class="id" title="binder">bstate</span></a> <a id="caddr:227" class="idref" href="#caddr:227"><span class="id" title="binder">caddr</span></a> (<a id="trace:228" class="idref" href="#trace:228"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#bstate:226"><span class="id" title="variable">bstate</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#bstate:226"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#caddr:227"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="deploy_info:229" class="idref" href="#deploy_info:229"><span class="id" title="binder">deploy_info</span></a> <a id="cstate:230" class="idref" href="#cstate:230"><span class="id" title="binder">cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <span class="id" title="var">_</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#trace:228"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#caddr:227"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#deploy_info:229"><span class="id" title="variable">deploy_info</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#bstate:226"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#caddr:227"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#cstate:230"><span class="id" title="variable">cstate</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <span class="id" title="keyword">let</span> <a id="init_supply:231" class="idref" href="#init_supply:231"><span class="id" title="binder">init_supply</span></a> := <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#init_amount"><span class="id" title="projection">init_amount</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#deploy_info:229"><span class="id" title="variable">deploy_info</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_setup"><span class="id" title="projection">deployment_setup</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#init_supply:231"><span class="id" title="variable">init_supply</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#total_supply"><span class="id" title="projection">total_supply</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#cstate:230"><span class="id" title="variable">cstate</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#lift_dep_info_contract_state_prop"><span class="id" title="lemma">lift_dep_info_contract_state_prop</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#contract"><span class="id" title="definition">contract</span></a>); <span class="id" title="tactic">intros</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">init_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">init_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">IH</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_message</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#try_transfer_preserves_total_supply"><span class="id" title="lemma">try_transfer_preserves_total_supply</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#try_transfer_from_preserves_total_supply"><span class="id" title="lemma">try_transfer_from_preserves_total_supply</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#try_approve_preserves_total_supply"><span class="id" title="lemma">try_approve_preserves_total_supply</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab281"></a><h2 class="section">Sum of balances always equals total supply</h2>

</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="sum_balances_eq_total_supply" class="idref" href="#sum_balances_eq_total_supply"><span class="id" title="lemma">sum_balances_eq_total_supply</span></a> <a id="bstate:232" class="idref" href="#bstate:232"><span class="id" title="binder">bstate</span></a> <a id="caddr:233" class="idref" href="#caddr:233"><span class="id" title="binder">caddr</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#bstate:232"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#bstate:232"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#caddr:233"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="cstate:234" class="idref" href="#cstate:234"><span class="id" title="binder">cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#bstate:232"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#caddr:233"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#cstate:234"><span class="id" title="variable">cstate</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#total_supply"><span class="id" title="projection">total_supply</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#cstate:234"><span class="id" title="variable">cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#sum_balances"><span class="id" title="definition">sum_balances</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#cstate:234"><span class="id" title="variable">cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#lift_contract_state_prop"><span class="id" title="lemma">lift_contract_state_prop</span></a> <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#contract"><span class="id" title="definition">contract</span></a>); <span class="id" title="tactic">eauto</span>; <span class="id" title="tactic">intros</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">init_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">init_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20Token.html#sum_balances"><span class="id" title="definition">sum_balances</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.elements_add"><span class="id" title="lemma">FMap.elements_add</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.elements_empty"><span class="id" title="lemma">FMap.elements_empty</span></a>. <span class="id" title="var">cbn</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">IH</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">Blockchain.receive</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_message</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">erewrite</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#try_transfer_preserves_balances_sum"><span class="id" title="lemma">try_transfer_preserves_balances_sum</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#try_transfer_preserves_total_supply"><span class="id" title="lemma">try_transfer_preserves_total_supply</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">erewrite</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#try_transfer_from_preserves_balances_sum"><span class="id" title="lemma">try_transfer_from_preserves_balances_sum</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#try_transfer_from_preserves_total_supply"><span class="id" title="lemma">try_transfer_from_preserves_total_supply</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">erewrite</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#try_approve_preserves_balances_sum"><span class="id" title="lemma">try_approve_preserves_balances_sum</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#try_approve_preserves_total_supply"><span class="id" title="lemma">try_approve_preserves_total_supply</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Examples.EIP20.EIP20TokenCorrect.html#Theories"><span class="id" title="section">Theories</span></a>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="https://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a> and <a href="https://github.com/jgallen23/toc">TOC</a>
</div>
</div>
<script>
  const elements = document.getElementsByClassName("libtitle");
  while(elements.length > 0){
        elements[0].parentNode.removeChild(elements[0]);
  }
  if (window.location.pathname.endsWith("/toc.html")) {
      const jstocDiv = document.getElementById("js-toc");
      jstocDiv.classList.remove("toc");
      jstocDiv.classList.add("jstoc-hidden");
      const jstocHeaderDiv = document.getElementById("js-toc-header");
      jstocHeaderDiv.classList.add("jstoc-hidden");
      const mainDiv = document.getElementById("main");
      mainDiv.classList.add("jstoc-hidden-main");
      const toggleDiv = document.getElementById("toggle-toc");
      toggleDiv.classList.add("jstoc-hidden");
  }
  console.log(window.location.pathname);
</script>
<script type="text/javascript" src="toc.js"></script>
</body>

</html>
